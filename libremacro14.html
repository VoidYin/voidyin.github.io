<ol start="14" type="1">
    <li>
        <p>
            Writer Documents
        </p>
    </li>
</ol>
<blockquote>
    <p>
        Writer documents primarily deal with text content arranged in paragraphs. This chapter introduces appropriate
        methods to manipulate, traverse, search, format, and modify the content contained in an OpenOffice.org Writer
        document. First, a bit of review that is applicable to most document types.
    </p>
    <p>
        Conceptually, all document types have two components: the data they contain and the controller that determines
        how the data is displayed. Writer documents primarily contain simple formatted text. In addition to simple text,
        Writer documents may contain other content such as tables, frames, graphics, text fields, bookmarks, footnotes,
        endnotes, text sections, index entries, tracked document changes (called redlining), objects for styling, and
        objects for numbering. OOo uses the same methods and interfaces to interact with most of these capabilities.
        Consequently, learning to manipulate a few types of content will give you a solid basis for dealing with all of
        them.
    </p>
    <p>
        <strong>TIP</strong> In OOo, the data contained in a document is called the “model.” The base model interface is
        com.sun.star.frame.XModel.
    </p>
    <p>
        In OpenOffice.org, the data contained in a document is called the model. Each model has a controller that is
        responsible for the visual presentation of the data. The controller knows the location of the visible text
        cursor, the current page, and what is currently selected.
    </p>
    <p>
        <strong>TIP</strong> While trying to determine which portion of the OOo API to use to solve a specific problem,
        first ask if the problem is display-centric or data-centric. For example, a paragraph boundary is specified in
        the data, but a new line is usually determined by the controller when the data is formatted.
    </p>
    <p>
        Every text document supports the com.sun.star.text.TextDocument service. When I write a macro that must be user
        friendly and requires a text document, I verify that the document is the correct type by using the object method
        supportsService (see Listing 331).
    </p>
    <p>
        <em><strong>Listing 331.</strong> Text documents support the com.sun.star.text.TextDocument service.</em>
    </p>
    <p>
        REM If it really matters, you should check the document type REM to avoid a run-time error.
    </p>
    <p>
        If NOT ThisComponent.supportsService("com.sun.star.text.TextDocument") Then MsgBox "The current document is not
        a Writer text document", 48, "Error" Exit Sub
    </p>
    <p>
        End If
    </p>
    <p>
        An interface defines a series of methods. If an object implements an interface, it also implements every method
        defined by that interface. A service defines an object by specifying the interfaces that it implements, the
        properties that it contains, and the other services that it exports. A service indirectly specifies the
        implemented methods by specifying interfaces. The interfaces supported by the TextDocument service provide a
        good overview of the provided functionality (see Table 122).
    </p>
    <p>
        <em><strong>Table 122.</strong> Interfaces supported by text documents.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 50%" />
        <col style="width: 49%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Service</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                com.sun.star.text.XTextDocument
            </td>
            <td>
                Main text document interface.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XBookmarksSupplier
            </td>
            <td>
                Access the bookmarks.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XChapterNumberingSupplier
            </td>
            <td>
                Numbering rules for chapters.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XDocumentIndexesSupplier
            </td>
            <td>
                Access the collection of indexes.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XTextEmbeddedObjectsSupplier
            </td>
            <td>
                Access embedded objects.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XEndnotesSupplier
            </td>
            <td>
                Access endnote content.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XFootnotesSupplier
            </td>
            <td>
                Access footnote content.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XLineNumberingSupplier
            </td>
            <td>
                Numbering rules for line numbers.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XPagePrintable
            </td>
            <td>
                Print multiple pages on one page.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XReferenceMarksSupplier
            </td>
            <td>
                Access the document reference marks, which are used to refer to text positions in a text document.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XTextFieldsSupplier
            </td>
            <td>
                Access contained fields.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XTextFramesSupplier
            </td>
            <td>
                Access contained text frames.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XTextGraphicObjectsSupplier
            </td>
            <td>
                Access embedded and linked graphics.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XTextSectionsSupplier
            </td>
            <td>
                Access contained text sections.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XTextTablesSupplier
            </td>
            <td>
                Access contained tables.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.style.XStyleFamiliesSupplier
            </td>
            <td>
                Access contained styles by type.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.util.XNumberFormatsSupplier
            </td>
            <td>
                Access contained number formats.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.util.XRefreshable
            </td>
            <td>
                Refresh data that can be refreshed from a database.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.util.XReplaceable
            </td>
            <td>
                Replace text found with a search descriptor.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.util.XSearchable
            </td>
            <td>
                Search a text range for a specific string pattern.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.beans.XPropertySet
            </td>
            <td>
                Access document properties by name.
            </td>
        </tr>
    </tbody>
</table>
<h2 id="basic-building-blocks">
    <em>Basic building blocks</em>
</h2>
<blockquote>
    <p>
        While dealing with Writer documents, you’ll see that a few simple interfaces and concepts recur. These basic
        building blocks are interrelated in that their respective interfaces are circularly defined (they refer to each
        other). Fortunately, the concepts are intuitive and therefore easy to grasp, even with a brief introduction.
        This section briefly introduces these basic building blocks, laying the groundwork for detailed coverage later.
    </p>
</blockquote>
<h1 id="primary-text-content-the-xtext-interface">
    Primary text content: the XText interface
</h1>
<blockquote>
    <p>
        Text content is contained in an object that implements the XText interface. The primary purpose of a text object
        is to contain text content, create text cursors to move through text, insert text, and remove text (see
        <strong>Table 123</strong>).
    </p>
    <p>
        <em><strong>Table 123.</strong> Methods defined by the com.sun.text.XText interface.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 42%" />
        <col style="width: 57%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                createTextCursor()
            </td>
            <td>
                Return a TextCursor service used to traverse the text object.
            </td>
        </tr>
        <tr class="even">
            <td>
                createTextCursorByRange(XTextRange)
            </td>
            <td>
                Return a TextCursor that is located at the specified TextRange.
            </td>
        </tr>
        <tr class="odd">
            <td>
                insertString(XTextRange, String, boolean)
            </td>
            <td>
                Insert a string of characters into the text at the specified text range. Each CR (ASCII 13) inserts a
                new paragraph and each LF (ASCII 10) inserts a new line. If the Boolean value is True, the text in the
                range is overwritten; otherwise, the text characters are inserted after the text range.
            </td>
        </tr>
        <tr class="even">
            <td>
                insertControlCharacter(XTextRange, Short, boolean)
            </td>
            <td>
                <p>
                    Insert a control character (such as a paragraph break or a hard space) into the text. The short
                    integer is a value from the constant group com.sun.star.text.ControlCharacter:
                </p>
                <ul>
                    <li>
                        <p>
                            PARAGRAPH_BREAK = 0 – Start a new paragraph.
                        </p>
                    </li>
                    <li>
                        <p>
                            LINE_BREAK = 1 – Start a new line in a paragraph.
                        </p>
                    </li>
                    <li>
                        <p>
                            HARD_HYPHEN = 2 – Insert a dash that will not hyphenate.
                        </p>
                    </li>
                    <li>
                        <p>
                            SOFT_HYPHEN = 3 – Define a preferred hyphenation point if the word must be split at the end
                            of a line.
                        </p>
                    </li>
                    <li>
                        <p>
                            HARD_SPACE = 4 – Insert a space that prevents two words from splitting at a line break.
                        </p>
                    </li>
                    <li>
                        <p>
                            APPEND_PARAGRAPH = 5 – Append a new paragraph. If the Boolean value is True, the text in the
                            text range is overwritten; otherwise, the control character is inserted after the text
                            range.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                insertTextContent(XTextRange, XTextContent, boolean)
            </td>
            <td>
                Insert text content such as a text table, text frame, or text field. In general, the text content should
                be created by the text object. If the Boolean value is True, the text in the text range is overwritten;
                otherwise, the text content is inserted after the text range.
            </td>
        </tr>
        <tr class="even">
            <td>
                removeTextContent(XTextContent)
            </td>
            <td>
                Remove the specified text content from the text object.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Because the XText interface is derived from the XTextRange interface, all objects that implement the XText
        interface also support the object methods defined by the XTextRange interface (see Table 124).
    </p>
</blockquote>
<h1 id="text-ranges-the-xtextrange-interface">
    Text ranges: the XTextRange interface
</h1>
<blockquote>
    <p>
        A text range is one of the most important concepts in a text document because so many interfaces derive from the
        XTextRange interface. The primary purpose of a text range is to define a start and end position in the text (see
        Table 124). It is possible that the start position and the end position in a text range are the same. When the
        start and end positions are the same, the text range identifies a position in the text—for example, the cursor
        in a text document when no text is selected. If the start and end positions of a text range are not the same,
        they represent a section of text.
    </p>
    <p>
        <em><strong>Table 124.</strong> Methods defined by the com.sun.text.XTextRange interface.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 23%" />
        <col style="width: 76%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                getText()
            </td>
            <td>
                Return the XText interface that contains the text range.
            </td>
        </tr>
        <tr class="even">
            <td>
                getStart()
            </td>
            <td>
                A text range has a start and end position. The getStart() method returns a text range that contains only
                the start position of this text range.
            </td>
        </tr>
        <tr class="odd">
            <td>
                getEnd()
            </td>
            <td>
                A text range has a start and end position. The getStart() method returns a text range that contains only
                the end position of this text range.
            </td>
        </tr>
        <tr class="even">
            <td>
                setString(String)
            </td>
            <td>
                A text range has a start and end position. The setString() method replaces all of the text between the
                start and end positions with the argument string. All styles are removed and all text in this text range
                is replaced.
            </td>
        </tr>
        <tr class="odd">
            <td>
                getString()
            </td>
            <td>
                Return a string that represents the text in this text range. Strings in OOo Basic are limited to 64KB in
                size, but text ranges and text objects are not; use this with care.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Every XTextRange object is associated with a text object. It can be said that an XTextRange object is contained
        in an object that implements the XText interface. The XText interface is itself derived from the XTextRange
        interface. Use the getText() object method to obtain the text object that is associated with the text range.
    </p>
    <p>
        <strong>TIP</strong> Common tasks include obtaining a bookmark, obtaining the bookmark’s anchor position (a text
        range), and then inserting text content at the bookmark’s anchor position. Although the setString() method is
        the quickest way to add text at the anchor position, inserting text content requires an object that supports the
        XText interface. The getText() method returns an object that can insert text content using the text range.
    </p>
    <p>
        Writer documents primarily contain formatted text. To access the formatted text, either call the document’s
        object method getText() or directly access the document’s Text property. I usually directly access the Text
        property because it requires less typing.
    </p>
    <p>
        ThisComponent.Text 'Current document's text object ThisComponent.getText() 'Current document's text object
    </p>
    <p>
        The document’s text object implements the XTextRange interface. The simplest method to obtain all of the text
        characters contained in a text document is to call the getString() object method (see Table 124). The
        getString() method returns a single string containing a text version of the document. Each cell in a text table
        is returned as a single paragraph, and all formatting is lost. The object method setString() can be used to set
        the entire document’s text in one call—when setString() is used, all of the existing text is lost! See Listing
        332<strong>.</strong>
    </p>
    <p>
        <em><strong>Listing 332.</strong> Get and set the entire document text with no formatting.</em>
    </p>
    <p>
        MsgBox ThisComponent.Text.getString(), 0, "Document Text String" ThisComponent.Text.setString("This is text to
        set")
    </p>
    <p>
        <strong>TIP</strong> Use getString() only on small text documents. I wrote a macro that computed word-usage
        statistics by first calling the getString() object method. Because OOo Basic strings are limited to 64KB
        characters, the macro failed on large documents.
    </p>
    <p>
        The getString() and setString() object methods are limited, because OOo Basic strings are limited to 64KB in
        size and they contain no formatting information. Due to these limitations, other methods are usually used to get
        and set the document text. Generally, large or complex documents are best handled with the getText() method and
        related methods, because they support arbitrary size and modular management of complex documents.
    </p>
</blockquote>
<h1 id="inserting-simple-text">
    Inserting simple text
</h1>
<blockquote>
    <p>
        With the limited information already presented, you can already insert simple text content at the beginning and
        the end of a document. The getStart() and getEnd() object methods both return a text range that can be used to
        insert text into a text object (see Table 123 and Table 124). The code in Listing 333 inserts simple text at the
        start of the document and a new paragraph at the end of the document.
    </p>
    <p>
        <em><strong>Listing 333.</strong> Insert simple text at the start and end of the document.</em>
    </p>
    <p>
        Sub InsertSimpleText Dim oText As Object
    </p>
    <p>
        oText = ThisComponent.Text
    </p>
    <p>
        REM Insert some simple text at the start oText.insertString(oText.getStart(), "Text object start." &amp;
        CHR$(13), False) REM Append a new paragraph at the end oText.InsertControlCharacter(oText.getEnd(),_
    </p>
    <p>
        com.sun.star.text.ControlCharacter.APPEND_PARAGRAPH, False)
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h1 id="text-content-the-textcontent-service">
    Text content: the TextContent service
</h1>
<blockquote>
    <p>
        The primary purpose of the TextContent service is to anchor an object (text content) to its surrounding text.
        Conceptually there are two types of text content: content that is part of the surrounding text (a text field,
        for example), and content that is more like a floating field (a graphic image, for example).
    </p>
    <p>
        To determine where text content is anchored in the text, call the getAnchor() object method. This returns a text
        range that defines the anchor location. For floating text content objects, the text needs to know how to flow
        around the object and how the object is anchored to the text (see Table 125). The behavior of text content
        inserted as a character should be well understood. The content acts just like a character would act: The text
        content is moved along between two other characters. When text content is anchored at a paragraph, however, the
        text content is not required to move as the characters before and after it are moved. It is only required that
        the object stay attached to a paragraph, and the object is not inserted into a paragraph. I usually anchor an
        object to a paragraph when I want text to flow around the object; for example, a graphic on the right and text
        on the left.
    </p>
    <p>
        <em><strong>Table 125.</strong> Properties supported by the com.sun.star.text.TextContent service.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 19%" />
        <col style="width: 80%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                AnchorType
            </td>
            <td>
                <p>
                    Enumeration of type com.sun.star.text.TextContentAnchorType that defines how this text content is
                    attached to the surrounding text.
                </p>
                <ul>
                    <li>
                        <p>
                            AT_PARAGRAPH – The anchor is set at the top left position of the paragraph. The object moves
                            if the paragraph moves.
                        </p>
                    </li>
                    <li>
                        <p>
                            AS_CHARACTER – The text content object is anchored as a character. The size of the object
                            influences the height of the text line and the object can move as a character if the
                            surrounding text moves.
                        </p>
                    </li>
                    <li>
                        <p>
                            AT_PAGE – The text content object is anchored to the page. The object does not move even if
                            the text content around it changes.
                        </p>
                    </li>
                    <li>
                        <p>
                            AT_FRAME – The text content object is anchored to a text frame.
                        </p>
                    </li>
                    <li>
                        <p>
                            AT_CHARACTER – The text content object is anchored to a character. The object moves if the
                            character moves.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                AnchorTypes
            </td>
            <td>
                <blockquote>
                    <p>
                        Array of TextContentAnchorType that contains the anchor types of the text content.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                TextWrap
            </td>
            <td>
                <blockquote>
                    <p>
                        Enumeration of type com.sun.star.text.WrapTextMode that defines how the surrounding text wraps
                        around this text content object.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE – Text does not flow around the object.
                        </p>
                    </li>
                    <li>
                        <p>
                            THROUGHT – Text flow ignores the object. (Yes, it is THROUGHT.) This can be thought of as
                            THROUGH iT, as in, “the text flows through the object.”
                        </p>
                    </li>
                    <li>
                        <p>
                            PARALLEL – Text flows to the left and right of the object.
                        </p>
                    </li>
                    <li>
                        <p>
                            DYNAMIC – The text formatting decides the best wrapping method.
                        </p>
                    </li>
                    <li>
                        <p>
                            LEFT – Text flows to the left of the object.
                        </p>
                    </li>
                    <li>
                        <p>
                            RIGHT – Text flows to the right of the object.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        The text object contains methods to insert TextContent objects at specified locations (see Table 123). In
        general, the TextContent type must be created by the document before it is inserted (see Listing 334).
    </p>
    <p>
        <em><strong>Listing 334.</strong> Insert text content (a text table) at the end of the current document.</em>
    </p>
    <p>
        Sub InsertSimpleTableAtEnd
    </p>
    <p>
        Dim oTable 'Newly created table to insert
    </p>
    <p>
        REM Let the document create the text table.
    </p>
    <p>
        oTable = ThisComponent.createInstance( "com.sun.star.text.TextTable") oTable.initialize(3, 2) 'Three rows, two
        columns
    </p>
    <p>
        REM Now insert the text table at the end of the document. ThisComponent.Text.insertTextContent(_
    </p>
    <p>
        ThisComponent.Text.getEnd(), oTable, False)
    </p>
    <p>
        End Sub
    </p>
    <p>
        <strong>TIP</strong> In general, the TextContent type must be created by the document before it is inserted.
    </p>
    <p>
        Call the removeTextContent(XTextContent) object method (see Table 123) to remove text content. Another method of
        removing text content is to write new text content in its place. A simple example of this is to call the
        setString() method on a text range that includes the text content (see Listing 335).
    </p>
    <p>
        <em><strong>Listing 335.</strong> Clear the entire document of all text content.</em>
    </p>
    <p>
        ThisComponent.Text.setString("") 'Clear an entire document!
    </p>
</blockquote>
<h2 id="enumerating-paragraphs">
    <em>Enumerating paragraphs</em>
</h2>
<blockquote>
    <p>
        Writer documents primarily contain formatted text that is arranged into paragraphs. Writer methods can operate
        on words, sentences, paragraphs, and entire text objects. Paragraphs are the most basic organizational unit for
        formatted text, and methods on paragraphs are often the most reliable, meaning they contain fewer bugs. The
        paragraphs can be enumerated sequentially using the XEnumerationAccess interface defined in the document’s text
        object. OOo treats tables as a special type of paragraph, and they are returned while enumerating paragraphs
        (see Listing 336).
    </p>
    <p>
        <em><strong>Listing 336.</strong> Count paragraphs and text tables.</em>
    </p>
    <p>
        Sub enumerateParagraphs
    </p>
    <p>
        Dim oEnum 'com.sun.star.container.XEnumerationAccess
    </p>
    <p>
        Dim oPar 'Paragraph of some sort Dim nPars As Integer 'Number of paragraphs Dim nTables As Integer 'Number of
        tables
    </p>
    <p>
        REM ThisComponent refers to the current OOo document
    </p>
    <p>
        REM Text is a property of ThisComponent for a text document REM The getText() object method returns the same
        thing.
    </p>
    <p>
        REM createEnumeration() is an object method. oEnum = ThisComponent.Text.createEnumeration() Do While
        oEnum.hasMoreElements()
    </p>
    <p>
        oPar = oEnum.nextElement()
    </p>
    <p>
        REM The returned paragraph will be a paragraph or a text table If
        oPar.supportsService("com.sun.star.text.Paragraph") Then
    </p>
    <p>
        nPars = nPars + 1
    </p>
    <p>
        ElseIf oPar.supportsService("com.sun.star.text.TextTable") Then nTables = nTables + 1
    </p>
    <p>
        End If Loop
    </p>
    <p>
        MsgBox CStr(nPars) &amp; " Paragraph(s)" &amp; CHR$(13) &amp;_ CStr(nTables) &amp; " Table(s)" &amp; CHR$(13),
        0,_ "Paragraph Types In Document"
    </p>
    <p>
        End Sub
    </p>
    <p>
        <strong>TIP</strong> Visual Basic for Applications (VBA) supports accessing paragraphs using an index; OOo does
        not.
    </p>
    <p>
        While enumerating the paragraphs in a Writer document, both paragraphs and tables are returned. The object
        method supportsService() is used to determine if a paragraph or a table is returned. Paragraph objects support
        both the XTextRange interface and the XTextContent interface. TextTable objects, however, support only the
        XTextContent interface.
    </p>
    <p>
        The macro in Listing 336 enumerates paragraphs in the high level text object. Many objects contains their own
        text object; fore example, each cell in a text table and each frame.
    </p>
</blockquote>
<h1 id="paragraph-properties">
    Paragraph properties
</h1>
<blockquote>
    <p>
        Paragraphs contain numerous paragraph-related properties encapsulated in services. The properties that are
        primarily related to the entire paragraph are encapsulated in the ParagraphProperties service (see Table 126).
    </p>
    <p>
        <strong>TIP</strong> The Paragraph service is not the only service that supports the ParagraphProperties
        service. Other services, especially those that are also a text range, also support paragraph properties.
        Techniques used to modify paragraph properties in paragraphs apply to these services as well.
    </p>
    <p>
        <em><strong>Table 126.</strong> Properties supported by the com.sun.style.ParagraphProperties service.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 31%" />
        <col style="width: 68%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                ParaAdjust
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify how the paragraph is aligned (or justified). Five values are supported from the
                        com.sun.star.style.ParagraphAdjust enumeration:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            LEFT – Left-align the paragraph.
                        </p>
                    </li>
                    <li>
                        <p>
                            RIGHT – Right-align the paragraph.
                        </p>
                    </li>
                    <li>
                        <p>
                            CENTER – Center-align the paragraph.
                        </p>
                    </li>
                    <li>
                        <p>
                            BLOCK – Fill-justify every line except for the last line.
                        </p>
                    </li>
                    <li>
                        <p>
                            STRETCH – Fill-justify every line including the last line.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaLastLineAdjust
            </td>
            <td>
                <blockquote>
                    <p>
                        Adjust the last line if the ParaAdjust is set to BLOCK.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaLineSpacing
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the paragraph line spacing. The property is a structure of type
                        com.sun.star.style.LineSpacing, which contains two properties of type Short. The Height property
                        specifies the height and the Mode property specifies how to use the Height property. The Mode
                        property supports values defined in the com.sun.star.style.LineSpacingMode constants group.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            PROP = 0 – The height is proportional.
                        </p>
                    </li>
                    <li>
                        <p>
                            MINIMUM = 1 – The height is the minimum line height.
                        </p>
                    </li>
                    <li>
                        <p>
                            LEADING = 2 – The height is the distance to the previous line.
                        </p>
                    </li>
                    <li>
                        <p>
                            FIX = 3 – The height is fixed.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaBackColor
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the paragraph background color as a Long Integer.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaBackTransparent
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, set the paragraph background color to transparent.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaBackGraphicURL
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the URL of the paragraph background graphic.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaBackGraphicFilter
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the graphic filter for the paragraph background graphic.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaBackGraphicLocation
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the position of the background graphic using the enumeration
                        sun.star.style.GraphicLocation:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE – A location is not yet assigned.
                        </p>
                    </li>
                    <li>
                        <p>
                            LEFT_TOP – The graphic is in the top left corner.
                        </p>
                    </li>
                    <li>
                        <p>
                            MIDDLE_TOP – The graphic is in the middle of the top edge.
                        </p>
                    </li>
                    <li>
                        <p>
                            RIGHT_TOP – The graphic is in the top right corner.
                        </p>
                    </li>
                    <li>
                        <p>
                            LEFT_MIDDLE – The graphic is in the middle of the left edge.
                        </p>
                    </li>
                    <li>
                        <p>
                            MIDDLE_MIDDLE – The graphic is in the center of the surrounding object.
                        </p>
                    </li>
                    <li>
                        <p>
                            RIGHT_MIDDLE – The graphic is in the middle of the right edge.
                        </p>
                    </li>
                    <li>
                        <p>
                            LEFT_BOTTOM – The graphic is in the bottom left corner.
                        </p>
                    </li>
                    <li>
                        <p>
                            MIDDLE_BOTTOM – The graphic is in the middle of the bottom edge.
                        </p>
                    </li>
                    <li>
                        <p>
                            RIGHT_BOTTOM – The graphic is in the bottom right corner.
                        </p>
                    </li>
                    <li>
                        <p>
                            AREA – The graphic is scaled to fill the whole surrounding area.
                        </p>
                    </li>
                    <li>
                        <p>
                            TILED – The graphic is repeated over the surrounding object like tiles.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaExpandSingleWord
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, single words may be stretched.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaLeftMargin
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the left paragraph margin in 0.01 mm as a Long Integer.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 31%" />
        <col style="width: 68%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                ParaRightMargin
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the right paragraph margin in 0.01 mm as a Long Integer.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaTopMargin
            </td>
            <td>
                Specify the top paragraph margin in 0.01 mm as a Long Integer. The distance between two paragraphs is
                the maximum of the bottom margin of the previous paragraph and the top margin of the next paragraph.
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaBottomMargin
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the bottom paragraph margin in 0.01 mm as a Long Integer. The distance between two
                        paragraphs is the maximum of the bottom margin of the previous paragraph and the top margin of
                        the next paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaLineNumberCount
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, this paragraph is included in line numbering.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaLineNumberStartValue
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the start value for line numbering as a Long Integer.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                PageDescName
            </td>
            <td>
                Setting this string causes a page break to occur before the paragraph. The new page uses the specified
                page style name.
            </td>
        </tr>
        <tr class="odd">
            <td>
                PageNumberOffset
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify a new page number if a page break occurs.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaRegisterModeActive
            </td>
            <td>
                If True, and if the paragraph's page style also has the register mode set to True, the register mode is
                active for this paragraph. If register mode is active, each line has the same height.
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaTabStops
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the tab stops for this paragraph. This is an array of structures of type
                        com.sun.star.style.TabStop. Each structure contains the following properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Position – Long integer position relative to the left border.
                        </p>
                    </li>
                    <li>
                        <p>
                            Alignment – Alignment of the text range before the tab. This is an enumeration of type
                            com.sun.star.style.TabAlign. Valid values include LEFT, RIGHT, CENTER, DECIMAL, and DEFAULT.
                        </p>
                    </li>
                    <li>
                        <p>
                            DecimalChar – Specifies which character is the decimal.
                        </p>
                    </li>
                    <li>
                        <p>
                            FillChar – Character used to fill space between the text.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaStyleName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the current paragraph style.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                DropCapFormat
            </td>
            <td>
                <p>
                    Structure that determines if the first characters of the paragraph use dropped capital letters. The
                    com.sun.star.style.DropCapFormat contains the following properties:
                </p>
                <ul>
                    <li>
                        <p>
                            Lines – Number of lines used for a drop cap.
                        </p>
                    </li>
                    <li>
                        <p>
                            Count – Number of characters in the drop cap.
                        </p>
                    </li>
                    <li>
                        <p>
                            Distance – Distance between the drop cap and the following text.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                DropCapWholeWord
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the DropCapFormat is applied to the entire first word.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaKeepTogether
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, prevents a page or column break after this paragraph—for example, to prevent a title
                        from being the last line on a page or column.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaSplit
            </td>
            <td>
                <blockquote>
                    <p>
                        If False, prevents the paragraph from splitting into two pages or columns.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                NumberingLevel
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the numbering level of the paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                NumberingRules
            </td>
            <td>
                Specify the numbering rules applied to this paragraph. This object implements the
                com.sun.star.container.XIndexReplace interface.
            </td>
        </tr>
        <tr class="odd">
            <td>
                NumberingStartValue
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the start value for numbering if ParaIsNumberingRestart is True.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaIsNumberingRestart
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify if numbering restarts at the current paragraph (see NumberingStartValue).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                NumberingStyleName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the style for numbering (see ParaLineNumberCount).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaOrphans
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the minimum number of lines at the bottom of a page if the paragraph spans more than one
                        page.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaWidows
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the minimum number of lines at the top of a page if the paragraph spans more than one
                        page.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaShadowFormat
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the paragraph shadow format as a com.sun.star.table.ShadowFormat:
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 31%" />
        <col style="width: 68%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
            </td>
            <td>
                <ul>
                    <li>
                        <p>
                            Location – Specify the shadow location as an enumeration of type
                            com.sun.star.table.ShadowLocation. Valid values include NONE, TOP_LEFT, TOP_RIGHT,
                            BOTTOM_LEFT, and BOTTOM_RIGHT.
                        </p>
                    </li>
                    <li>
                        <p>
                            ShadowWidth – Specify the size of the shadow as an Integer.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsTransparent – If True, the shadow is transparent.
                        </p>
                    </li>
                    <li>
                        <p>
                            Color – Specify the color of the shadow as a Long Integer.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                LeftBorder
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the left border as a com.sun.star.table.BorderLine (see Table 163).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                RightBorder
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the right border (see Table 163).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                TopBorder
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the top border (see Table 163).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                BottomBorder
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the bottom border (see Table 163).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                BorderDistance
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the distance from the border to the object (in 0.01 mm).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                LeftBorderDistance
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the distance from the left border to the object (in 0.01 mm).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                RightBorderDistance
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the distance from the right border to the object (in 0.01 mm).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                TopBorderDistance
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the distance from the top border to the object (in 0.01 mm).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                BottomBorderDistance
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the distance from the bottom border to the object (in 0.01 mm).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                BreakType
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the type of break that is applied at the start of the paragraph. This is an enumeration
                        of type com.sun.star.style.BreakType with the following values:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE – No column or page break is applied.
                        </p>
                    </li>
                    <li>
                        <p>
                            COLUMN_BEFORE – A column break is applied before the current paragraph. The current
                            paragraph, therefore, is the first in the column.
                        </p>
                    </li>
                    <li>
                        <p>
                            COLUMN_AFTER – A column break is applied after the current paragraph. The current paragraph,
                            therefore, is the last in the column.
                        </p>
                    </li>
                    <li>
                        <p>
                            COLUMN_BOTH – A column break is applied before and after the current paragraph. The current
                            paragraph, therefore, is the only paragraph in the column.
                        </p>
                    </li>
                    <li>
                        <p>
                            PAGE_BEFORE – A page break is applied before the current paragraph. The current paragraph,
                            therefore, is the first on the page.
                        </p>
                    </li>
                    <li>
                        <p>
                            PAGE_AFTER – A page break is applied after the current paragraph. The current paragraph,
                            therefore, is the last on the page.
                        </p>
                    </li>
                    <li>
                        <p>
                            PAGE_BOTH – A page break is applied before and after the current paragraph. The current
                            paragraph, therefore, is the only paragraph on the page.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                DropCapCharStyleName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the character style for drop caps.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaFirstLineIndent
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the indent for the first line in a paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaIsAutoFirstLineIndent
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the first line is indented automatically.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaIsHyphenation
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, automatic hyphenation is applied.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaHyphenationMaxHyphens
            </td>
            <td>
                Specify the maximum number of consecutive hyphens for each word contained in the current paragraph.
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaHyphenationMaxLeadingChars
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the maximum number of characters to remain before a hyphen character.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaHyphenationMaxTrailingChars
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the maximum number of characters to remain after a hyphen character.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaVertAlignment
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the vertical alignment of the paragraph. This is a constant group of type
                        com.sun.star.text.ParagraphVertAlign with valid values:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            AUTOMATIC = 0 – In automatic mode, horizontal text is aligned to the baseline. The same
                            applies to text that is rotated 90 degrees. Text that is rotated 270 degrees is aligned to
                            the center.
                        </p>
                    </li>
                    <li>
                        <p>
                            BASELINE = 1 – The text is aligned to the baseline.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 31%" />
        <col style="width: 68%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
            </td>
            <td>
                <ul>
                    <li>
                        <p>
                            TOP = 2 – The text is aligned to the top.
                        </p>
                    </li>
                    <li>
                        <p>
                            CENTER = 3 – The text is aligned to the center.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOTTOM = 4 – The text is aligned to bottom.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaUserDefinedAttributes
            </td>
            <td>
                <blockquote>
                    <p>
                        Stores XML attributes that are saved and restored from the automatic styles inside XML files.
                        The object implements the com.sun.star.container.XNameContainer interface.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                NumberingIsNumber
            </td>
            <td>
                If True, the numbering of a paragraph is a number but has no symbol. This is void if the paragraph is
                not part of a paragraph numbering sequence.
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaIsConnectBorder
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, paragraph borders are merged with the previous paragraph if the borders are identical.
                        This property may be void.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <strong>TIP</strong> Paragraph properties are usually set using paragraph styles—at least they should be.
    </p>
    <p>
        Many of the properties in Table 126 are structures; they require special care if you want to modify them,
        because a structure is copied by value rather than by reference. For example, the ParaLineSpacing property is a
        structure. Although the code in Listing 337 looks correct, it fails; this usage is a very common error committed
        by OOo Basic programmers.
    </p>
    <p>
        <em><strong>Listing 337.</strong> This code fails because ParaLineSpacing is a structure.</em>
    </p>
    <p>
        oPar.ParaLineSpacing.Mode = com.sun.star.style.LineSpacing.LEADING
    </p>
    <p>
        The code in Listing 337 fails because the code “oPar.ParaLineSpacing” made a copy of the structure. The Mode is
        set, but it is set only on the copy, leaving the original intact. The code in Listing 338 demonstrates the
        proper way to modify the value of a structure when it is used as a property. A copy of the structure is stored
        in the variable v, which is then modified and copied back.
    </p>
    <p>
        <em><strong>Listing 338.</strong> This works because it makes a copy and then copies it back.</em>
    </p>
    <p>
        v = oPar.ParaLineSpacing
    </p>
    <p>
        v.Mode = com.sun.star.style.LineSpacing.LEADING oPar.ParaLineSpacing = v
    </p>
</blockquote>
<h3 class="unnumbered" id="insert-a-page-break">
    <em>Insert a page break</em>
</h3>
<blockquote>
    <p>
        To insert a page break, set the PageDescName property to the name of the page style to use after the page break.
        This style may be the same as the current page style; it is the act of setting the PageDescName property—not
        changing it to a new value—that causes a page break to occur. The page style name must exist in the document or
        a page break is not inserted. When you insert a page break, you can also set a new page number by setting the
        PageNumberOffset property to the new page number. See Listing 339.
    </p>
    <p>
        <strong>TIP</strong> It is rare to insert a page break while enumerating paragraphs. It is more common to insert
        a page break using a text cursor or a text range. You can use any service that supports paragraph properties to
        insert a page break.
    </p>
    <p>
        <em><strong>Listing 339.</strong> Insert a page break after the last paragraph.</em>
    </p>
    <p>
        Sub SetPageBreakAtEndFromEnumeration
    </p>
    <p>
        Dim oEnum 'com.sun.star.container.XEnumerationAccess Dim oParTest 'Paragraph of some sort
    </p>
    <p>
        Dim oPar 'Last Paragraph object
    </p>
    <p>
        REM Find the last paragraph
    </p>
    <p>
        oEnum = ThisComponent.Text.createEnumeration() Do While oEnum.hasMoreElements()
    </p>
    <p>
        oParTest = oEnum.nextElement()
    </p>
    <p>
        If oParTest.supportsService("com.sun.star.text.Paragraph") Then oPar = oParTest
    </p>
    <p>
        End If Loop
    </p>
    <p>
        REM Note that this does not actually change the page style name oPar.PageDescName = oPar.PageStyleName
    </p>
    <p>
        REM Set the new page number to be 7 oPar.PageNumberOffset = 7
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h3 class="unnumbered" id="set-the-paragraph-style">
    <em>Set the paragraph style</em>
</h3>
<blockquote>
    <p>
        The ParaStyleName property indicates the paragraph style for that paragraph. This property may be directly set.
    </p>
    <p>
        <em><strong>Listing 340.</strong> Enumerate the paragraph styles in the current document.</em>
    </p>
    <p>
        Sub EnumerateParStyles()
    </p>
    <p>
        Dim oEnum 'com.sun.star.container.XEnumerationAccess Dim oCurPar 'Last Paragraph object.
    </p>
    <p>
        Dim s$ 'General string variable.
    </p>
    <p>
        oEnum = ThisComponent.Text.createEnumeration() Do While oEnum.hasMoreElements()
    </p>
    <p>
        oCurPar = oEnum.nextElement()
    </p>
    <p>
        s = s &amp; oCurPar.ParaStyleName &amp; CHR$(10) Loop
    </p>
    <p>
        MsgBox s End Sub
    </p>
</blockquote>
<h1 id="character-properties">
    Character properties
</h1>
<blockquote>
    <p>
        Paragraphs contain numerous character-related properties. Like the paragraph-specific properties, these
        properties are optional and are encapsulated in services. The properties that are primarily related to
        characters are found in the CharacterProperties service (see <strong>Table 127</strong>).
    </p>
    <p>
        <strong>TIP</strong> Many of the properties are represented by a value in a constant group. Constant groups
        associate meaningful names to constant values. For example, the CharFontFamily accepts the value
        com.sun.star.awt.FontFamily.ROMAN to specify a Roman font with serifs. A value of 3 may also be used.
    </p>
    <p>
        In almost all cases, the first value is 0, the second value is 1, and so on. Code that uses the descriptive
        names is easier to read and understand.
    </p>
    <p>
        <em><strong>Table 127.</strong> Properties supported by the com.sun.style.CharacterProperties service.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 32%" />
        <col style="width: 67%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                CharFontName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the font in western text. This may be a comma-separated list of names.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharFontStyleName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the font style.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 32%" />
        <col style="width: 67%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                CharFontFamily
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the font family as specified in com.sun.star.awt.FontFamily constant group.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DONTKNOW = 0 – The font family is not known.
                        </p>
                    </li>
                    <li>
                        <p>
                            DECORATIVE = 1 – The font family uses decorative fonts.
                        </p>
                    </li>
                    <li>
                        <p>
                            MODERN = 2 – The font family is a modern font; this is a specific style.
                        </p>
                    </li>
                    <li>
                        <p>
                            ROMAN = 3 – The font family is a Roman font with serifs.
                        </p>
                    </li>
                    <li>
                        <p>
                            SCRIPT = 4 – The font family is a script font.
                        </p>
                    </li>
                    <li>
                        <p>
                            SWISS = 5 – The font family is a Roman font without serifs.
                        </p>
                    </li>
                    <li>
                        <p>
                            SYSTEM = 6 – The font family is a system font.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharFontCharSet
            </td>
            <td>
                Specify the text encoding of the font using the com.sun.star.awt.CharSet constant group. The values are
                self-explanatory: DONTKNOW, ANSI, MAC, IBMPC_437 (IBM PC character set number 437), IBMPC_850,
                IBMPC_860, IBMPC_86, IBMPC_863, IBMPC_865, SYSTEM, and SYMBOL.
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharFontPitch
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the character font pitch using the com.sun.star.awt.FontPitch constant group. The values
                        are self-explanatory: DONTKNOW, FIXED, and VARIABLE.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharColor
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the text color as a Long Integer.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharEscapement
            </td>
            <td>
                Specify the Short Integer representing the percentage of raising or lowering for superscript/subscript
                characters. Negative values lower the characters.
            </td>
        </tr>
        <tr class="even">
            <td>
                CharHeight
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the character height in points as a decimal number.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharUnderline
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the character underline type using the com.sun.star.awt.FontUnderline constant group.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE = 0 – No underlining.
                        </p>
                    </li>
                    <li>
                        <p>
                            SINGLE = 1 – Single line.
                        </p>
                    </li>
                    <li>
                        <p>
                            DOUBLE = 2 – Double line.
                        </p>
                    </li>
                    <li>
                        <p>
                            DOTTED = 3 – Dotted line.
                        </p>
                    </li>
                    <li>
                        <p>
                            DONTKNOW = 4 – Unknown underlining.
                        </p>
                    </li>
                    <li>
                        <p>
                            DASH = 5 – Dashed line.
                        </p>
                    </li>
                    <li>
                        <p>
                            LONGDASH = 6 – Long dashes.
                        </p>
                    </li>
                    <li>
                        <p>
                            DASHDOT = 7 – Dash and dot sequence.
                        </p>
                    </li>
                    <li>
                        <p>
                            DASHDOTDOT = 8 – Dash, dot, dot sequence.
                        </p>
                    </li>
                    <li>
                        <p>
                            SMALLWAVE = 9 – Small wave.
                        </p>
                    </li>
                    <li>
                        <p>
                            WAVE = 10 – Wave.
                        </p>
                    </li>
                    <li>
                        <p>
                            DOUBLEWAVE = 11 – Double wave.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLD = 12 – Bold line.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLDDOTTED = 13 – Bold dots.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLDDASH = 14 – Bold dashes.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLDLONGDASH = 15 – Long bold dashes.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLDDASHDOT = 16 – Dash and dot sequence in bold.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLDDASHDOTDOT = 17 – Dash, dot, dot sequence in bold.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLDWAVE = 18 – Bold wave.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharWeight
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the font weight using the com.sun.star.awt.FontWeight constant group.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DONTKNOW = 0.000 – Not specified/unknown.
                        </p>
                    </li>
                    <li>
                        <p>
                            THIN = 50.00 – 50% font weight.
                        </p>
                    </li>
                    <li>
                        <p>
                            ULTRALIGHT = 60.00 – 60% font weight.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 32%" />
        <col style="width: 67%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
            </td>
            <td>
                <ul>
                    <li>
                        <p>
                            LIGHT = 75.00 – 75% font weight.
                        </p>
                    </li>
                    <li>
                        <p>
                            SEMILIGHT = 90.00 – 90% font weight.
                        </p>
                    </li>
                    <li>
                        <p>
                            NORMAL = 100.00 – normal font weight (100%).
                        </p>
                    </li>
                    <li>
                        <p>
                            SEMIBOLD = 110.00 – 110% font weight.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLD = 150.00 – 150% font weight.
                        </p>
                    </li>
                    <li>
                        <p>
                            ULTRABOLD = 175.00 – 175% font weight.
                        </p>
                    </li>
                    <li>
                        <p>
                            BLACK = 200.00 – 200% font weight.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharPosture
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the character posture using the com.sun.star.awt.FontSlant enumeration with values:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE – No slant, regular text.
                        </p>
                    </li>
                    <li>
                        <p>
                            OBLIQUE – Oblique font (slant not designed into the font).
                        </p>
                    </li>
                    <li>
                        <p>
                            ITALIC – Italic font (slant designed into the font).
                        </p>
                    </li>
                    <li>
                        <p>
                            DONTKNOW – Unknown slant.
                        </p>
                    </li>
                    <li>
                        <p>
                            REVERSE_OBLIQUE – Reverse oblique (slant not designed into the font).
                        </p>
                    </li>
                    <li>
                        <p>
                            REVERSE_ITALIC – Reverse italic font (slant designed into the font).
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharAutoKerning
            </td>
            <td>
                Set to True to use the kerning tables for the current font. Automatic kerning adjusts the spacing
                between certain pairs of characters to improve readability.
            </td>
        </tr>
        <tr class="even">
            <td>
                CharBackColor
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the text background color as a Long Integer.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharBackTransparent
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the text background color is transparent.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharCaseMap
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify how characters should be displayed using the com.sun.star.style.CaseMap constant group.
                        This does not change the actual text—only the way it is displayed.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE = 0 – No case mapping is performed; this is the most commonly used value.
                        </p>
                    </li>
                    <li>
                        <p>
                            UPPERCASE = 1 – All characters are displayed in uppercase.
                        </p>
                    </li>
                    <li>
                        <p>
                            LOWERCASE = 2 – All characters are displayed in lowercase.
                        </p>
                    </li>
                    <li>
                        <p>
                            TITLE = 3 – The first character of each word is displayed in uppercase.
                        </p>
                    </li>
                    <li>
                        <p>
                            SMALLCAPS = 4 – All characters are displayed in uppercase, but with a smaller font.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharCrossedOut
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the characters have a line through them.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharFlash
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the characters are displayed flashing.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharStrikeout
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify character strikeout using the com.sun.star.awt.FontStrikeout constant group:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE = 0 – Do not strike out characters.
                        </p>
                    </li>
                    <li>
                        <p>
                            SINGLE = 1 – Strike out the characters with a single line.
                        </p>
                    </li>
                    <li>
                        <p>
                            DOUBLE = 2 – Strike out the characters with a double line.
                        </p>
                    </li>
                    <li>
                        <p>
                            DONTKNOW = 3 – The strikeout mode is not specified.
                        </p>
                    </li>
                    <li>
                        <p>
                            BOLD = 4 – Strike out the characters with a bold line.
                        </p>
                    </li>
                    <li>
                        <p>
                            SLASH = 5 – Strike out the characters with slashes.
                        </p>
                    </li>
                    <li>
                        <p>
                            X = 6 – Strike out the characters with X's.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharWordMode
            </td>
            <td>
                If True, white spaces (spaces and tabs) ignore the CharStrikeout and CharUnderline properties.
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharKerning
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the character kerning value as a Short Integer.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharLocale
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the character locale as a com.star.lang.Locale structure.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharKeepTogether
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, OOo tries to keep the character range on the same line. If a break must
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 32%" />
        <col style="width: 67%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
            </td>
            <td>
                <blockquote>
                    <p>
                        occur, it occurs before the characters.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharNoLineBreak
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, OOo ignores a line break in the character range. If a break must occur, it occurs after
                        the characters so it is possible that they will cross a border.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharShadowed
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the characters are formatted and displayed with a shadow effect.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharFontType
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the fundamental technology of the font using the com.sun.star.awt.FontType constant
                        group.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DONTKNOW = 0 – The type of the font is not known.
                        </p>
                    </li>
                    <li>
                        <p>
                            RASTER = 1 – The font is a raster (bitmapped) font.
                        </p>
                    </li>
                    <li>
                        <p>
                            DEVICE = 2 – The font is output-device specific, such as a printer font.
                        </p>
                    </li>
                    <li>
                        <p>
                            SCALABLE = 3 – The font is scalable.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharStyleName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the font style as a string.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharContoured
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, characters are formatted and displayed with a contour (3-D outline) effect.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharCombineIsOn
            </td>
            <td>
                If True, text is formatted and displayed using two lines. The CharCombinePrefix string precedes the text
                in full size, and the CharCombineSuffix follows the text in full size.
            </td>
        </tr>
        <tr class="even">
            <td>
                CharCombinePrefix
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the prefix (usually parentheses) used with the CharCombineIsOn property.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharCombineSuffix
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the suffix (usually parentheses) used with the CharCombineIsOn property.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharEmphasize
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the type and position of emphasis marks in Asian texts using the
                        com.sun.star.text.FontEmphasis constant group:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE = 0 – No emphasis mark is used.
                        </p>
                    </li>
                    <li>
                        <p>
                            DOT_ABOVE = 1 – A dot is set above (or right from vertical text) the text.
                        </p>
                    </li>
                    <li>
                        <p>
                            CIRCLE_ABOVE = 2 – A circle is set above (or right from vertical text) the text.
                        </p>
                    </li>
                    <li>
                        <p>
                            DISK_ABOVE = 3 – A disk is set above (or right from vertical text) the text.
                        </p>
                    </li>
                    <li>
                        <p>
                            ACCENT_ABOVE = 4 – An accent is set above (or right from vertical text) the text.
                        </p>
                    </li>
                    <li>
                        <p>
                            DOT_BELOW = 11 – A dot is set below (or left from vertical text) the text.
                        </p>
                    </li>
                    <li>
                        <p>
                            CIRCLE_BELOW = 12 – A circle is set below (or left from vertical text) the text.
                        </p>
                    </li>
                    <li>
                        <p>
                            DISK_BELOW = 13 – A disk is set below (or left from vertical text) the text.
                        </p>
                    </li>
                    <li>
                        <p>
                            ACCENT_BELOW = 14 – An accent is set below (or left from vertical text) the text.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharRelief
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the relief value from the com.sun.star.text.FontRelief constant group:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            NONE = 0 – No relief is used; normal text.
                        </p>
                    </li>
                    <li>
                        <p>
                            EMBOSSED = 1 – Characters look embossed (raised).
                        </p>
                    </li>
                    <li>
                        <p>
                            ENGRAVED = 2 – Characters look engraved (lowered).
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                RubyText
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the text that is set as ruby. “Ruby Text” acts as an annotation and is associated with a
                        “Ruby Base.” This is typically used in Asian writing systems, providing a helper for uncommonly
                        used writing characters that are not easily recognizable, especially by children. For example,
                        in Japanese writing, the phonetic Hiragana alphabet is used to pair phonetic “helper” readings
                        (called Furigana or Yomigana in Japanese) with the Chinese character counterpart.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                RubyAdjust
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the ruby text adjustment using the com.sun.star.text.RubyAdjust enumeration:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            LEFT – Adjust to the left.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 32%" />
        <col style="width: 67%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
            </td>
            <td>
                <ul>
                    <li>
                        <p>
                            CENTER – Adjust to the center.
                        </p>
                    </li>
                    <li>
                        <p>
                            RIGHT – Adjust to the right.
                        </p>
                    </li>
                    <li>
                        <p>
                            BLOCK – Adjust to both borders (stretched).
                        </p>
                    </li>
                    <li>
                        <p>
                            INDENT_BLOCK – Adjust to both borders with a small indent on both sides.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                RubyCharStyleName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the character style that is applied to RubyText.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                RubyIsAbove
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the Ruby is printed above the text (right if the text is vertical).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharRotation
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the rotation of a character in degrees as a Short Integer. Not all implementations
                        support all values.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharRotationIsFitToLine
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, OOo tries to fit the rotated text to the surrounding line height.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharScaleWidth
            </td>
            <td>
                Specify the scaling for superscript and subscript as a percentage using a Short Integer.
            </td>
        </tr>
        <tr class="odd">
            <td>
                HyperLinkURL
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the URL of a hyperlink (if set) as a String.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                HyperLinkTarget
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the target for a hyperlink (if set) as a String.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                HyperLinkName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the name of the hyperlink (if set) as a String.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                VisitedCharStyleName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the character style for visited hyperlinks as a String.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                UnvisitedCharStyleName
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the character style name for unvisited hyperlinks as a String.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharEscapementHeight
            </td>
            <td>
                Specify the additional height used for subscript or superscript characters as an Integer percent. For
                subscript characters the value is negative.
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharNoHyphenation
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the word cannot be hyphenated at the character.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharUnderlineColor
            </td>
            <td>
                <blockquote>
                    <p>
                        Specify the color of the underline as a Long Integer.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharUnderlineHasColor
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the CharUnderlineColor is used for an underline.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CharStyleNames
            </td>
            <td>
                <blockquote>
                    <p>
                        An array of character style names applied to the text. The order is not necessarily relevant.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <strong>TIP</strong> When a property supports a DONTKNOW value, the property is usually used as a hint to
        perform certain operations more efficiently or to find a close replacement value if the requested value is not
        available. For example, if a particular font is not available, you can use the CharFontFamily to choose a font
        of the
    </p>
    <p>
        correct type.
    </p>
    <p>
        The code in Listing 341 demonstrates modifying the character properties by modifying the FontRelief property and
        then changing it back.
    </p>
    <p>
        <em><strong>Listing 341.</strong> Set then restore the font relief.</em>
    </p>
    <p>
        Sub ViewFontRelief
    </p>
    <p>
        Dim oEnum 'com.sun.star.container.XEnumerationAccess Dim oPar 'Paragraph of some sort
    </p>
    <p>
        Dim i% 'General Counting variable Dim s$
    </p>
    <p>
        oEnum = ThisComponent.Text.createEnumeration() Do While oEnum.hasMoreElements()
    </p>
    <p>
        oPar = oEnum.nextElement()
    </p>
    <p>
        REM The returned paragraph will be a paragraph or a text table If
        oPar.supportsService("com.sun.star.text.Paragraph") Then
    </p>
    <p>
        i = i + 1 oPar.CharRelief = i MOD 3
    </p>
    <p>
        End If Loop
    </p>
    <p>
        MsgBox "The document now uses NONE, EMBOSSED, and ENGRAVED character relief"
    </p>
    <p>
        oEnum = ThisComponent.Text.createEnumeration() Do While oEnum.hasMoreElements()
    </p>
    <p>
        oPar = oEnum.nextElement()
    </p>
    <p>
        REM The returned paragraph will be a paragraph or a text table If
        oPar.supportsService("com.sun.star.text.Paragraph") Then
    </p>
    <p>
        i = i + 1
    </p>
    <p>
        oPar.CharRelief = com.sun.star.text.FontRelief.NONE End If
    </p>
    <p>
        Loop End Sub
    </p>
</blockquote>
<h1 id="enumerating-text-sections-paragraph-portions">
    Enumerating text sections (paragraph portions)
</h1>
<blockquote>
    <p>
        It is not unusual for a paragraph to contain text with dissimilar formatting—for example, a single word may be
        displayed in <strong>bold</strong> in the middle of a sentence that is displayed in the font’s normal state.
        Just as you can enumerate the paragraphs in a document, you can enumerate the text sections in a paragraph. Text
        within each enumerated portion uses the same properties and is of the same type. Table 128 lists the properties
        directly supported by the TextPortion service. The TextPortion service exports the TextRange service so it also
        supports the paragraph properties in Table 126 and the character properties in Table 127.
    </p>
    <p>
        <strong>TIP</strong> An object that supports paragraph or character properties typically provides a way to
        enclose a range of text. If a specific property changes value in the text range, it usually isn’t available to
        be set. For example, a text range can contain more than one paragraph. If all of the contained paragraphs in the
        text range do not
    </p>
    <p>
        support the same paragraph style, the paragraph style property is not available to the text range. If, however,
        the text range is reduced to contain only paragraphs that support a single paragraph style, the paragraph style
        property will be available to that text range.
    </p>
    <p>
        <em><strong>Table 128.</strong> Properties supported by the com.sun.text.TextPortion service.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 23%" />
        <col style="width: 76%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                TextPortionType
            </td>
            <td>
                <p>
                    String containing the type of the text portion. Valid content type names are:
                </p>
                <ul>
                    <li>
                        <p>
                            Text – String content.
                        </p>
                    </li>
                    <li>
                        <p>
                            TextField – TextField content.
                        </p>
                    </li>
                    <li>
                        <p>
                            TextContent – Indicates that text content is anchored as or to a character that is not
                            really part of the paragraph—for example, a text frame or a graphic object. As of OOo 1.1.0
                            and OOo 1.1.1, the type “Frame” is returned rather than “TextContent”. The OOo team refers
                            to this as issue #24444.
                        </p>
                    </li>
                    <li>
                        <p>
                            Frame – This is not a documented return value, but it is returned rather than the type
                            “TextContent”.
                        </p>
                    </li>
                    <li>
                        <p>
                            Footnote – Footnote or endnote.
                        </p>
                    </li>
                    <li>
                        <p>
                            ControlCharacter – Control character.
                        </p>
                    </li>
                    <li>
                        <p>
                            ReferenceMark – Reference mark.
                        </p>
                    </li>
                    <li>
                        <p>
                            DocumentIndexMark – Document index mark.
                        </p>
                    </li>
                    <li>
                        <p>
                            Bookmark – Bookmark.
                        </p>
                    </li>
                    <li>
                        <p>
                            Redline – Redline portion, which is a result of the change-tracking feature.
                        </p>
                    </li>
                    <li>
                        <p>
                            Ruby – Ruby attribute (used in Asian text).
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                ControlCharacter
            </td>
            <td>
                Short Integer containing the control character if the text portion contains a ControlCharacter.
            </td>
        </tr>
        <tr class="odd">
            <td>
                Bookmark
            </td>
            <td>
                If the text content is a bookmark, this is a reference to the bookmark. The property implements the
                com.sun.star.text.XTextContent interface.
            </td>
        </tr>
        <tr class="even">
            <td>
                IsCollapsed
            </td>
            <td>
                If True, the text portion is a point.
            </td>
        </tr>
        <tr class="odd">
            <td>
                IsStart
            </td>
            <td>
                If True, the text portion is a start portion if two portions are needed to include an object. For
                example, a DocmentIndexMark has a start and end text portion surrounding the text to be indexed.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        The macro in Listing 342 demonstrates enumerating the text content inside a paragraph. It displays the paragraph
        number and the included text portion types in a dialog. The paragraph number is calculated and is not a property
        of the paragraph.
    </p>
    <p>
        <em><strong>Listing 342.</strong> See text portion types.</em>
    </p>
    <p>
        Sub EnumerateTextSections
    </p>
    <p>
        Dim oParEnum 'Paragraph enumerator
    </p>
    <p>
        Dim osecEnum 'Text section enumerator
    </p>
    <p>
        Dim oPar 'Current paragraph
    </p>
    <p>
        Dim oParSection 'Current section
    </p>
    <p>
        Dim nPars As Integer 'Number of paragraphs Dim s$
    </p>
    <p>
        oParEnum = ThisComponent.Text.createEnumeration() Do While oParEnum.hasMoreElements()
    </p>
    <p>
        oPar = oParEnum.nextElement()
    </p>
    <p>
        If oPar.supportsService("com.sun.star.text.Paragraph") Then nPars = nPars + 1
    </p>
    <p>
        oSecEnum = oPar.createEnumeration() s = s &amp; nPars &amp; ":"
    </p>
    <p>
        Do While oSecEnum.hasMoreElements() oParSection = oSecEnum.nextElement()
    </p>
    <p>
        s = s &amp; oParSection.TextPortionType &amp; ":"
    </p>
    <p>
        Loop
    </p>
    <p>
        s = s &amp; CHR$(10)
    </p>
    <p>
        If nPars MOD 10 = 0 Then
    </p>
    <p>
        MsgBox s, 0, "Paragraph Text Sections" s = ""
    </p>
    <p>
        End If End If
    </p>
    <p>
        Loop
    </p>
    <p>
        MsgBox s, 0, "Paragraph Text Sections" End Sub
    </p>
</blockquote>
<h2 id="graphics">
    <em>Graphics</em>
</h2>
<blockquote>
    <p>
        The following macro inserts a text graphic object as a link in to the current document. This is a text graphics
        object, which is inserted at a cursor position. Although you must set the image size, you do not need to set the
        position.
    </p>
    <p>
        <em><strong>Listing 343.</strong> Insert a Graphics as a link at the start of the document.</em>
    </p>
    <p>
        Sub InsertGraphicObject(oDoc, sURL$) Dim oCursor
    </p>
    <p>
        Dim oGraph Dim oText
    </p>
    <p>
        oText = oDoc.getText()
    </p>
    <p>
        oCursor = oText.createTextCursor() oCursor.goToStart(FALSE)
    </p>
    <p>
        oGraph = oDoc.createInstance("com.sun.star.text.GraphicObject")
    </p>
    <p>
        With oGraph
    </p>
    <p>
        .GraphicURL = sURL
    </p>
    <p>
        .AnchorType = com.sun.star.text.TextContentAnchorType.AS_CHARACTER
    </p>
    <p>
        .Width = 6000
    </p>
    <p>
        .Height = 8000 End With
    </p>
    <p>
        'now insert the image into the text document oText.insertTextContent( oCursor, oGraph, False )
    </p>
    <p>
        End Sub
    </p>
    <p>
        You can also insert a graphics object shape, which is inserted into the draw page rather than at a cursor
        location, but you must use a com.sun.star.drawing.GraphicObjectShape, and then set both the location and the
        size.
    </p>
    <p>
        Sometimes, you must guess the image size because it is not available. The following method assumes that the
        argument is a service of type com.sun.star.graphic.GraphicDescriptor, which optionally provides the image size
        in 100th mm and in pixels. The method returns a value in 100th mm, which is what is required for the internal
        display.
    </p>
    <p>
        Integers are not used because the intermediate values may be large.
    </p>
    <p>
        If the size is available in 100th mm, then this is used. Next, the size is checked in Pixels. An image has both
        a size in pixels, and an expected pixel density (Dots Per Inch). We may have the number of pixels, but we do
    </p>
    <p>
        not have the DPI. I guess the pixel density as the pixel density of the computer display. In other words, if the
        expected size is not available, then assume that this was created for display on the current monitor.
    </p>
</blockquote>
<p>
    <em><strong>Listing 344.</strong> Guess image size.</em>
</p>
<blockquote>
    <p>
        Function RecommendGraphSize(oGraph) Dim oSize
    </p>
    <p>
        Dim lMaxW As Double ' Maximum width in 100th mm Dim lMaxH As Double ' Maximum height in 100th mm
    </p>
    <p>
        lMaxW = 6.75 * 2540 ' 6.75 inches
    </p>
    <p>
        lMaxH = 9.5 * 2540 ' 9.5 inches
    </p>
    <p>
        If IsNull(oGraph) OR IsEmpty(oGraph) Then Exit Function
    </p>
    <p>
        End If
    </p>
    <p>
        oSize = oGraph.Size100thMM
    </p>
    <p>
        If oSize.Height = 0 OR oSize.Width = 0 Then
    </p>
    <p>
        ' 2540 is 25.40 mm in an inch, but I need 100th mm. ' There are 1440 twips in an inch
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 65%" />
        <col style="width: 25%" />
        <col style="width: 9%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                oSize.Height = oGraph.SizePixel.Height * 2540.0
            </th>
            <th>
                * TwipsPerPixelY()
            </th>
            <th>
                / 1440
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                oSize.Width = oGraph.SizePixel.Width * 2540.0 *
            </td>
            <td>
                TwipsPerPixelX() /
            </td>
            <td>
                1440
            </td>
        </tr>
        <tr class="even">
            <td>
                End If
            </td>
            <td colspan="2" rowspan="3">
            </td>
        </tr>
        <tr class="odd">
            <td>
                If oSize.Height = 0 OR oSize.Width = 0 Then
            </td>
        </tr>
        <tr class="even">
            <td>
                <blockquote>
                    <p>
                        'oSize.Height = 2540
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        'oSize.Width = 2540 Exit Function
    </p>
    <p>
        End If
    </p>
    <p>
        If oSize.Width &gt; lMaxW Then
    </p>
    <p>
        oSize.Height = oSize.Height * lMaxW / oSize.Width oSize.Width = lMaxW
    </p>
    <p>
        End If
    </p>
    <p>
        If oSize.Height &gt; lMaxH Then
    </p>
    <p>
        oSize.Width = oSize.Width * lMaxH / oSize.Height oSize.Height = lMaxH
    </p>
    <p>
        End If
    </p>
    <p>
        RecommendGraphSize = oSize End Function
    </p>
</blockquote>
<p>
    An image is embedded as follows:
</p>
<ol type="1">
    <li>
        <p>
            A shape is created and added to the draw page.
        </p>
    </li>
    <li>
        <p>
            The graphic provider service is used to obtain image descriptor from disk before it is loaded.
        </p>
    </li>
    <li>
        <p>
            The image descriptor is used to guess the image size. The image size is guessed, because we only know what
            is in the descriptor, and the descriptor may not really know.
        </p>
    </li>
    <li>
        <p>
            The shape is set to image as provided by the graphic provider service. At this point, the image is loaded
            and known by OOo.
        </p>
    </li>
    <li>
        <p>
            A newly created graph object sets its URL to the URL used by the shape object. As such, the graphic and the
            shape should reference the same image.
        </p>
    </li>
    <li>
        <p>
            The graph is anchored as a character and then inserted into the document at the cursor.
        </p>
    </li>
    <li>
        <p>
            The shape is no longer required, so it is removed.
        </p>
    </li>
</ol>
<blockquote>
    <p>
        For reasons I do not understand, all images inserted as a very small images (less than 1 cm). I use the guessed
        image size to set the graphic size.
    </p>
    <p>
        <em><strong>Listing 345.</strong> Embed an image in a document.</em>
    </p>
    <p>
        ' oDoc - document to contain the image.
    </p>
    <p>
        ' oCurs - Cursor where the image is added ' sURL - URL of the image to insert.
    </p>
    <p>
        ' sParStyle - set the paragraph style to this. Sub EmbedGraphic(oDoc, oCurs, sURL$, sParStyle$)
    </p>
    <p>
        Dim oShape
    </p>
    <p>
        Dim oGraph 'The graphic object is text content. Dim oProvider 'GraphicProvider service.
    </p>
    <p>
        Dim oText
    </p>
    <p>
        oShape = oDoc.createInstance("com.sun.star.drawing.GraphicObjectShape") oGraph =
        oDoc.createInstance("com.sun.star.text.GraphicObject")
    </p>
    <p>
        oDoc.getDrawPage().add(oShape)
    </p>
    <p>
        oProvider = createUnoService("com.sun.star.graphic.GraphicProvider")
    </p>
    <p>
        Dim oProps(0) as new com.sun.star.beans.PropertyValue oProps(0).Name = "URL"
    </p>
    <p>
        oProps(0).Value = sURL
    </p>
    <p>
        REM Save the original size. Dim oSize100thMM
    </p>
    <p>
        Dim lHeight As Long Dim lWidth As Long
    </p>
    <p>
        oSize100thMM = RecommendGraphSize(oProvider.queryGraphicDescriptor(oProps))
    </p>
    <p>
        If NOT IsNull(oSize100thMM) AND NOT IsEmpty(oSize100thMM) Then lHeight = oSize100thMM.Height
    </p>
    <p>
        lWidth = oSize100thMM.Width End If
    </p>
    <p>
        oShape.Graphic = oProvider.queryGraphic(oProps()) oGraph.graphicurl = oShape.graphicurl
    </p>
    <p>
        oGraph.AnchorType = com.sun.star.text.TextContentAnchorType.AS_CHARACTER oText= oCurs.getText()
    </p>
    <p>
        oText.insertTextContent(oCurs, oGraph, false) oDoc.getDrawPage().remove(oShape)
    </p>
    <p>
        If lHeight &gt; 0 AND lWidth &gt; 0 Then Dim oSize
    </p>
    <p>
        oSize = oGraph.Size oSize.Height = lHeight oSize.Width = lWidth oGraph.Size = oSize
    </p>
    <p>
        End If
    </p>
    <p>
        ' Set the paragraph style if it is in the document.
    </p>
    <p>
        Dim oStyles
    </p>
    <p>
        oStyles = oDoc.StyleFamilies.getByName("ParagraphStyles")
    </p>
    <p>
        If oStyles.hasByName(sParStyle) Then oCurs.ParaStyleName = sParStyle
    </p>
    <p>
        End If End Sub
    </p>
</blockquote>
<h2 id="paste-html-then-embed-linked-graphics">
    <em>Paste HTML then embed linked graphics</em>
</h2>
<blockquote>
    <p>
        After copying a web page and pasting it into a text document, all of the images are embedded. Graphics in a
        document contain the GraphicURL property. The URL for a graphic contained in the document begins with the
        “vnd.sun.star.GraphiObject:”. Graphic inserted using the API are inserted as links – they are not embedded into
        the document without some work.
    </p>
    <p>
        The following macro brings many concepts together to find all linked images and convert them into embedded
        images contained in the document.
    </p>
    <p>
        <em><strong>Listing 346.</strong> Convert all linked images to embedded images.</em>
    </p>
    <p>
        Sub ConvertAllLinkedGraphics(Optional aDoc) Dim oDoc ' Working document
    </p>
    <p>
        Dim oDP ' Draw page
    </p>
    <p>
        Dim i% ' Index counter
    </p>
    <p>
        Dim oGraph ' Graph object in the draw page Dim iLinked% ' Number of linked images
    </p>
    <p>
        Dim iEmbedded% ' Number of embedded images
    </p>
    <p>
        Dim iConverted% ' Linked images converted to embedded Dim s1$ ' Graphic service name
    </p>
    <p>
        Dim s2$ ' Graphic service name
    </p>
    <p>
        REM Only know how to convert these types
    </p>
    <p>
        s1 = "com.sun.star.drawing.GraphicObjectShape" s2 = "com.sun.star.text.TextGraphicObject"
    </p>
    <p>
        If IsMissing(aDoc) OR IsNull(aDoc) OR IsEmpty(aDoc) Then oDoc = ThisComponent
    </p>
    <p>
        Else
    </p>
    <p>
        oDoc = aDoc End If
    </p>
    <p>
        REM Get the document draw page and then enumerate the images. oDP = oDoc.getDrawPage()
    </p>
    <p>
        For i=0 To oDP.getCount()-1 oGraph = oDP.getByIndex(i)
    </p>
    <p>
        If oGraph.supportsService(s1) OR oGraph.supportsService(s2) Then If InStr(oGraph.GraphicURL, "vnd.sun") &lt;&gt;
        0 Then
    </p>
    <p>
        iEmbedded = iEmbedded + 1 Else
    </p>
    <p>
        iLinked = iLinked + 1
    </p>
    <p>
        If EmbedLinkedGraphic(oGraph, oDoc) Then iConverted = iConverted + 1
    </p>
    <p>
        End If End If
    </p>
    <p>
        End If Next
    </p>
    <p>
        Print "Found " &amp; iLinked &amp; " linked and " &amp; iEmbedded &amp; _ " embedded images and converted "
        &amp; iConverted
    </p>
    <p>
        End Sub
    </p>
    <p>
        Function EmbedLinkedGraphic(oGraph, oDoc) As Boolean REM Author: Andrew Pitonyak
    </p>
    <p>
        Dim sGraphURL$ ' External URL of the image. Dim oGraph_2 ' Created image.
    </p>
    <p>
        Dim oCurs ' Cursor where the image is located. Dim oText ' Text object containing image.
    </p>
    <p>
        Dim oAnchor ' Anchor point of the image Dim s1$ ' Graphic service name
    </p>
    <p>
        Dim s2$ ' Graphic service name
    </p>
    <p>
        EmbedLinkedGraphic = False
    </p>
    <p>
        If InStr(oGraph.GraphicURL, "vnd.sun") &lt;&gt; 0 Then REM Ignore an image that is already embedded Exit
        Function
    </p>
    <p>
        End If
    </p>
    <p>
        s1 = "com.sun.star.drawing.GraphicObjectShape" s2 = "com.sun.star.text.TextGraphicObject"
    </p>
    <p>
        If oGraph.supportsService(s1) Then
    </p>
    <p>
        REM Convert a GraphicObjectShape. oAnchor = oGraph.getAnchor() oText = oAnchor.getText()
    </p>
    <p>
        oGraph_2 = ThisComponent.createInstance(s) oGraph_2.GraphicObjectFillBitmap = oGraph.GraphicObjectFillBitmap
        oGraph_2.Size = oGraph.Size
    </p>
    <p>
        oGraph_2.Position = oGraph.Position oText.insertTextContent(oAnchor, oGraph_2, False)
        oText.removeTextContent(oGraph) EmbedLinkedGraphic = True
    </p>
    <p>
        ElseIf oGraph.supportsService(s2) Then
    </p>
    <p>
        REM Convert a TextGraphicObject. Dim oBitmaps
    </p>
    <p>
        Dim sNewURL$ Dim sName$
    </p>
    <p>
        sName$ = oGraph.LinkDisplayName
    </p>
    <p>
        oBitmaps = oDoc.createInstance( "com.sun.star.drawing.BitmapTable" ) If oBitMaps.hasByName(sName) Then
    </p>
    <p>
        Print "Link display name " &amp; sName &amp; " already exists" Exit Function
    </p>
    <p>
        End If
    </p>
    <p>
        'Print "Ready to insert " &amp; sName oBitmaps.insertByName( sName, oGraph.GraphicURL ) sNewURL$ =
        oBitmaps.getByName( sName )
    </p>
    <p>
        'Print "inserted URL " &amp; sNewURL oGraph.GraphicURL = sNewURL
    </p>
    <p>
        EmbedLinkedGraphic = True End If
    </p>
    <p>
        End Function
    </p>
</blockquote>
<h2 id="cursors">
    <em>Cursors</em>
</h2>
<blockquote>
    <p>
        The capability to enumerate the entire text content is primarily used for tasks such as exporting a document,
        because exporting requires all of the content to be accessed in sequential order. A more typical method for
        accessing and manipulating a document involves the use of cursors. A TextCursor is a TextRange, which can be
        moved within a Text object. In other words, a text cursor not only can specify a single point in the text, but
        it also can encompass a range of text. You can use the cursor movement methods to reposition the cursor and to
        expand the section of selected text. Two primary types of text cursors are available in OOo: cursors that are
        view cursors (see Table 129) and cursors that are not (see Table 131).
    </p>
</blockquote>
<h1 id="view-cursors">
    View cursors
</h1>
<blockquote>
    <p>
        As its name implies, the view cursor deals with the visible cursor. In a single document window, you see one
        view at a time. Analogously, you can have one view cursor at a time. View cursors support commands that are
        directly related to viewing. To move a cursor one line at a time, or one screen at a time, requires a view
        cursor. The view cursor knows how the text is displayed (see Table 130).
    </p>
    <p>
        <em><strong>Table 129.</strong> In general, view cursors are not related to text ranges or XTextCursor.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 37%" />
        <col style="width: 62%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Cursor</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                com.sun.star.view.XViewCursor
            </td>
            <td>
                Simple cursor with basic movement methods that work in both text and tables.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XTextViewCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        Derived from XTextCursor, this describes a cursor in a text document’s view. It supports only
                        very simple movements.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.view.XLineCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        Defines line-related methods; this interface is not derived from a text range.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        Defines page-related methods; this interface is not derived from a text range.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.view.XScreenCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        Defines methods to move up and down one screen at a time.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Most of the cursor movement methods accept a Boolean argument that determines whether the text range of the
        cursor is expanded (True) or whether the cursor is simply moved to the new position (False). In other words, if
        the Boolean expression is False, the cursor is moved to the new position and no text is selected by the cursor.
        The description of the Boolean variable is assumed and not explicitly stated for each of the cursor movement
        methods in Table 130. Another commonality with the movement methods is that they return a Boolean value. A True
        value means that the movement worked, and a False value means that the movement failed. A movement request fails
        if it cannot be completed successfully. It is not possible, for example, to move the cursor down if it is
        already at the end of the document. The screen cursor is obtained from the document’s current controller (see
        Listing 347).
    </p>
    <p>
        <em><strong>Table 130.</strong> Object methods related to view cursors.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 23%" />
        <col style="width: 28%" />
        <col style="width: 48%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Defined</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                XViewCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        goDown(n, Boolean)
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor down by n lines.
            </td>
        </tr>
        <tr class="even">
            <td>
                XViewCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        goUp(n, Boolean)
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor up by n lines.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XViewCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        goLeft(n, Boolean)
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor left by n characters.
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 23%" />
        <col style="width: 28%" />
        <col style="width: 48%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Defined</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                XViewCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        goRight(n, Boolean)
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor right by n characters.
            </td>
        </tr>
        <tr class="even">
            <td>
                XTextViewCursor
            </td>
            <td>
                isVisible()
            </td>
            <td>
                Return True if the cursor is visible.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XTextViewCursor
            </td>
            <td>
                setVisible(Boolean)
            </td>
            <td>
                Show or hide the cursor.
            </td>
        </tr>
        <tr class="even">
            <td>
                XTextViewCursor
            </td>
            <td>
                getPosition()
            </td>
            <td>
                Return a com.sun.star.awt.Point structure specifying the cursor’s coordinates relative to the top-left
                position of the first page of the document.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XLineCursor
            </td>
            <td>
                isAtStartOfLine()
            </td>
            <td>
                Return True if the cursor is at the start of the line.
            </td>
        </tr>
        <tr class="even">
            <td>
                XLineCursor
            </td>
            <td>
                isAtEndOfLine()
            </td>
            <td>
                Return True if the cursor is at the end of the line.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XLineCursor
            </td>
            <td>
                gotoEndOfLine(Boolean)
            </td>
            <td>
                Move the cursor to the end of the current line.
            </td>
        </tr>
        <tr class="even">
            <td>
                XLineCursor
            </td>
            <td>
                gotoStartOfLine(Boolean)
            </td>
            <td>
                Move the cursor to the start of the current line.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        jumpToFirstPage()
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor to the first page.
            </td>
        </tr>
        <tr class="even">
            <td>
                XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        jumpToLastPage()
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor to the last page.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        jumpToPage(n)
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor to the specified page.
            </td>
        </tr>
        <tr class="even">
            <td>
                XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        getPage()
                    </p>
                </blockquote>
            </td>
            <td>
                Return the current page as a Short Integer.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        jumpToNextPage()
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor to the next page.
            </td>
        </tr>
        <tr class="even">
            <td>
                XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        jumpToPreviousPage()
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor to the previous page.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        jumpToEndOfPage()
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor to the end of the current page.
            </td>
        </tr>
        <tr class="even">
            <td>
                XPageCursor
            </td>
            <td>
                <blockquote>
                    <p>
                        jumpToStartOfPage()
                    </p>
                </blockquote>
            </td>
            <td>
                Move the cursor to the start of the current page.
            </td>
        </tr>
        <tr class="odd">
            <td>
                XScreenCursor
            </td>
            <td>
                screenDown()
            </td>
            <td>
                Scroll the view forward by one visible page.
            </td>
        </tr>
        <tr class="even">
            <td>
                XScreenCursor
            </td>
            <td>
                screenUp()
            </td>
            <td>
                Scroll the view backward by one visible page.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <em><strong>Listing 347.</strong> ScrollDownOneScreen is found in the Writer module in this chapter’s source
            code files as SC13.sxw.</em>
    </p>
    <p>
        Sub ScrollDownOneScreen
    </p>
    <p>
        REM Get the view cursor from the current controller ThisComponent.currentController.getViewCursor().screenDown()
    </p>
    <p>
        End Sub
    </p>
    <p>
        A more typical use of the view cursor is to insert some special text content at the current cursor position. The
        macro in Listing 348 inserts the character with Unicode value 257 (“a” with a bar over it) at the current cursor
        position. This type of macro is typically associated with a keystroke to insert special characters that are not
        present on the keyboard. The macro in Listing 348 is short and simple, yet very useful.
    </p>
    <p>
        <em><strong>Listing 348.</strong> Insert the character with Unicode value 257 at the current cursor.</em>
    </p>
    <p>
        Sub InsertControlCharacterAtCurrentCursor Dim oViewCursor As Object
    </p>
    <p>
        oViewCursor = ThisComponent.CurrentController.getViewCursor()
        oViewCursor.getText.insertString(oViewCursor.getStart(), CHR$(257), False)
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h1 id="text-non-view-cursors">
    Text (non-view) cursors
</h1>
<blockquote>
    <p>
        The view cursor knows how the data is displayed, but doesn’t know about the data itself. Text cursors (non- view
        cursors), however, know a lot about the data but very little about how it is displayed. For example, view
        cursors do not know about words or paragraphs, and text cursors do not know about lines, screens, or pages (see
        Table 131).
    </p>
    <p>
        <em><strong>Table 131.</strong> Text cursor interfaces all implement the XTextCursor interface.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 38%" />
        <col style="width: 61%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Cursor</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                com.sun.star.text.XTextCursor
            </td>
            <td>
                The primary text cursor that defines simple movement methods.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XWordCursor
            </td>
            <td>
                Provides word-related movement and testing methods.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XSentenceCursor
            </td>
            <td>
                Provides sentence-related movement and testing methods.
            </td>
        </tr>
        <tr class="even">
            <td>
                com.sun.star.text.XParagraphCursor
            </td>
            <td>
                Provides paragraph-related movement and testing methods.
            </td>
        </tr>
        <tr class="odd">
            <td>
                com.sun.star.text.XTextViewCursor
            </td>
            <td>
                Derived from XTextCursor, this describes a cursor in a text document’s view.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <strong>TIP</strong> Text cursors and view cursors have some overlap. The XTextViewCursor is derived from the
        XTextCursor so it supports the XTextCursor methods. This does not provide functionality with respect to the
        underlying data such as word-related or paragraph-related methods (see Table 132).
    </p>
    <p>
        The word cursor, sentence cursor, and paragraph cursor all define essentially identical object methods (see
        Table 132). The XTextViewCursor interface is listed in Table 130 so it is omitted from Table 132.
    </p>
    <p>
        <em><strong>Table 132.</strong> Object methods related to text cursors.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 21%" />
        <col style="width: 36%" />
        <col style="width: 42%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Defined</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                XTextCursor
            </td>
            <td>
                collapseToStart()
            </td>
            <td>
                <blockquote>
                    <p>
                        Set the end position to the start position.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XTextCursor
            </td>
            <td>
                collapseToEnd()
            </td>
            <td>
                <blockquote>
                    <p>
                        Set the start position to the end position.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XTextCursor
            </td>
            <td>
                isCollapsed()
            </td>
            <td>
                <blockquote>
                    <p>
                        Return True if the start and end positions are the same.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XTextCursor
            </td>
            <td>
                goLeft(n, Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move the cursor left by n characters.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XTextCursor
            </td>
            <td>
                goRight(n, Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move the cursor right by n characters.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XTextCursor
            </td>
            <td>
                gotoStart(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move the cursor to the start of the text.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XTextCursor
            </td>
            <td>
                gotoEnd(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move the cursor to the end of the text.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XTextCursor
            </td>
            <td>
                gotoRange(XTextRange, Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move or expand the cursor to the TextRange.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XWordCursor
            </td>
            <td>
                isStartOfWord()
            </td>
            <td>
                <blockquote>
                    <p>
                        Return True if at the start of a word.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XWordCursor
            </td>
            <td>
                isEndOfWord()
            </td>
            <td>
                <blockquote>
                    <p>
                        Return True if at the end of a word.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XWordCursor
            </td>
            <td>
                gotoNextWord(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the start of the next word.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XWordCursor
            </td>
            <td>
                gotoPreviousWord(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the end of the previous word.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XWordCursor
            </td>
            <td>
                gotoEndOfWord(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the end of the current word.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XWordCursor
            </td>
            <td>
                gotoStartOfWord(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the start of the current word.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XSentenceCursor
            </td>
            <td>
                isStartOfSentence()
            </td>
            <td>
                <blockquote>
                    <p>
                        Return True if at the start of a sentence.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XSentenceCursor
            </td>
            <td>
                isEndOfSentence()
            </td>
            <td>
                <blockquote>
                    <p>
                        Return True if at the end of a sentence.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 21%" />
        <col style="width: 36%" />
        <col style="width: 42%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Defined</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                XSentenceCursor
            </td>
            <td>
                gotoNextSentence(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the start of the next sentence.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XSentenceCursor
            </td>
            <td>
                gotoPreviousSentence(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the end of the previous sentence.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XSentenceCursor
            </td>
            <td>
                gotoEndOfSentence(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the end of the current sentence.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XSentenceCursor
            </td>
            <td>
                gotoStartOfSentence(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the start of the current sentence.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XParagraphCursor
            </td>
            <td>
                isStartOfParagraph()
            </td>
            <td>
                <blockquote>
                    <p>
                        True if at the start of a paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XParagraphCursor
            </td>
            <td>
                isEndOfParagraph()
            </td>
            <td>
                <blockquote>
                    <p>
                        True if at the end of a paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XParagraphCursor
            </td>
            <td>
                gotoNextParagraph(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the start of the next paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XParagraphCursor
            </td>
            <td>
                gotoPreviousParagraph(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the end of the previous paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                XParagraphCursor
            </td>
            <td>
                gotoEndOfParagraph(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the end of the current paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                XParagraphCursor
            </td>
            <td>
                gotoStartOfParagraph(Boolean)
            </td>
            <td>
                <blockquote>
                    <p>
                        Move to the start of the current paragraph.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<h1 id="using-cursors-to-traverse-text">
    Using cursors to traverse text
</h1>
<blockquote>
    <p>
        Although traversing text using a cursor is not inherently difficult, I struggled with cursors for a long time
        before I finally realized that I had a very basic and yet simple misunderstanding. A very common, and yet subtly
        incorrect, method of traversing text content using cursors is shown in Listing 349. This macro attempts to move
        the cursor from one paragraph to the next, selecting one paragraph at a time. Typically, something would be done
        to manipulate or modify the paragraph, such as setting the paragraph style.
    </p>
    <p>
        <em><strong>Listing 349.</strong> Example of incorrect use of cursors: This code misses the last paragraph in
            the document.</em>
    </p>
    <p>
        Dim oCursor
    </p>
    <p>
        REM Create a text cursor
    </p>
    <p>
        oCursor = ThisComponent.Text.createTextCursor() REM Start at the beginning of the document.
    </p>
    <p>
        REM This is the same as the start of the first document. oCursor.gotoStart(False)
    </p>
    <p>
        REM And this is where things go wrong!
    </p>
    <p>
        REM The cursor now spans from the start of the
    </p>
    <p>
        REM first paragraph to the start of the second paragraph. Do While oCursor.gotoNextParagraph(True)
    </p>
    <p>
        REM Process the paragraph here!
    </p>
    <p>
        REM Now, deselect all of the text, leaving the cursor at the REM start of the next paragraph.
    </p>
    <p>
        oCursor.goRight(0, False) Loop
    </p>
    <p>
        <strong>TIP</strong> I produced incorrect code as shown in Listing 349 before I understood cursors.
    </p>
    <p>
        The problem in Listing 349 is that the method gotoNextParagraph(True) causes the cursor to extend its selection
        from the start of one paragraph to the start of the next. The first problem with selecting from the start of one
        paragraph to the start of the next is that more than just one paragraph is selected. If the two different
        paragraphs do not have the same paragraph style, the ParaStyleName property will return an empty string rather
        than a value. The second problem is that when the cursor (as shown in Listing 349) is positioned at the start of
        the last paragraph, it is not possible to go to the next paragraph because the next paragraph does not exist.
        Therefore, the statement “gotoNextParagraph(True)” returns False and the last
    </p>
    <p>
        paragraph is never processed. The code in Listing 350 demonstrates one correct method of traversing all of the
        paragraphs using a cursor.
    </p>
    <p>
        <em><strong>Listing 350.</strong> The correct way to use cursors.</em>
    </p>
    <p>
        Dim oCursor
    </p>
    <p>
        REM Create a text cursor.
    </p>
    <p>
        oCursor = ThisComponent.Text.createTextCursor() REM Start at the beginning of the document.
    </p>
    <p>
        REM This is the same as the start of the first document. oCursor.gotoStart(False)
    </p>
    <p>
        Do
    </p>
    <p>
        REM The cursor is already positioned at the start
    </p>
    <p>
        REM of the current paragraph, so select the entire paragraph. oCursor.gotoEndOfParagraph(True)
    </p>
    <p>
        REM Process the paragraph here!
    </p>
    <p>
        REM The Loop statement moves to the next paragraph and REM it also deselects the text in the cursor.
    </p>
    <p>
        Loop While oCursor.gotoNextParagraph(False)
    </p>
    <p>
        The point is to align the cursor over the current paragraph, and then iterate aligned with the paragraphs,
        rather than ever looking ahead to the next paragraph while in the midst of dealing with the cursor.
    </p>
    <p>
        <strong>TIP</strong> You can use cursors and enumeration to traverse an entire document and obtain all of the
        paragraphs.
    </p>
    <p>
        Using a cursor is five times faster than using an enumerator.
    </p>
    <p>
        It is very simple to write an iterator that traverses the text while counting the words, sentences, and
        paragraphs (see Listing 351).
    </p>
    <p>
        <em><strong>Listing 351.</strong> Count paragraphs, sentences, and words.</em>
    </p>
    <p>
        Sub CountWordSentPar Dim oCursor
    </p>
    <p>
        Dim nPars As Long
    </p>
    <p>
        Dim nSentences As Long Dim nWords As Long
    </p>
    <p>
        REM Create a text cursor.
    </p>
    <p>
        oCursor = ThisComponent.Text.createTextCursor() oCursor.gotoStart(False)
    </p>
    <p>
        Do
    </p>
    <p>
        nPars = nPars + 1
    </p>
    <p>
        Loop While oCursor.gotoNextParagraph(False) oCursor.gotoStart(False)
    </p>
    <p>
        Do
    </p>
    <p>
        nSentences = nSentences + 1
    </p>
    <p>
        Loop While oCursor.gotoNextSentence(False)
    </p>
    <p>
        oCursor.gotoStart(False)
    </p>
    <p>
        Do
    </p>
    <p>
        nWords = nWords + 1
    </p>
    <p>
        Loop While oCursor.gotoNextWord(False)
    </p>
    <p>
        MsgBox "Paragraphs: " &amp; nPars &amp; CHR$(10) &amp;_ "Sentences: " &amp; nSentences &amp; CHR$(10) &amp;_
    </p>
    <p>
        "Words: " &amp; nWords &amp; CHR$(10), 0, "Doc Statistics" End Sub
    </p>
    <p>
        <strong>TIP</strong> With OOo 1.1, I found gotoNextSentence() and gotoNextWord() to be unreliable, but the
        paragraph cursor worked well. To count words, therefore, I used the word count macros from Andrew Brows: <a
            href="http://www.darwinwars.com/lunatic/bugs/oo_macros.html"><strong>http://www.darwinwars.com/lunatic/bugs/oo_macros.html</strong>.</a>
    </p>
</blockquote>
<h3 class="unnumbered" id="keep-the-view-cursor-and-text-cursor-in-sync">
    <em>Keep the view cursor and text cursor in sync</em>
</h3>
<blockquote>
    <p>
        A paragraph is broken into lines based on the page margins. Adjust the page margins and the line breaks change.
        Also, text copied from writer as text do not contain the page breaks. For the real world example in Listing 352
        adds real line breaks into the text based on how the lines break on screen.
    </p>
    <p>
        Both a view cursor and a non­view cursor are required to move through the text. The view cursor knows where a
        line ends, but it does not know where the paragraph starts or ends. A non­view cursor knows about paragraphs,
        but the view cursor does not.
    </p>
    <p>
        Listing 352 moves the view cursor around on the screen, demonstrating how to change its location.
    </p>
    <p>
        <em><strong>Listing 352.</strong> Add line breaks in a paragraph.</em>
    </p>
    <p>
        Sub LineBreaksInParagraph
    </p>
    <p>
        Dim oText 'Save typing ThisComponent.Text Dim oViewCursor 'Save typing
        ThisComponent.CurrentController.getViewCursor() Dim oTextCursor 'Created text cursor
    </p>
    <p>
        Dim oSaveCursor 'In case I want to restore the view cursor oText = ThisComponent.Text
    </p>
    <p>
        REM You require a view cursor
    </p>
    <p>
        REM because only the view knows where a line ends. oViewCursor = ThisComponent.CurrentController.getViewCursor()
    </p>
    <p>
        REM You require a text cursor so that you know where the paragraph ends. REM Too bad the view cursor is not a
        paragraph cursor.
    </p>
    <p>
        oTextCursor = oText.createTextCursorByRange(oViewCursor)
    </p>
    <p>
        REM You only need this if you want to restore the view cursor oSaveCursor =
        oText.createTextCursorByRange(oViewCursor)
    </p>
    <p>
        REM Move the cursor to the start of the current paragraph REM so that the entire paragraph can be processed.
    </p>
    <p>
        If NOT oTextCursor.isStartOfParagraph() Then oTextCursor.gotoStartOfParagraph(False)
        oViewCursor.gotoRange(oTextCursor, False)
    </p>
    <p>
        End If
    </p>
    <p>
        REM Now visit each line of the paragraph. Do While True
    </p>
    <p>
        REM Only the view cursor knows where the end of the line is REM because this is a formatting issue and not
        determined by REM punctuation.
    </p>
    <p>
        oViewCursor.gotoEndOfLine(false)
    </p>
    <p>
        REM Move with the view cursor to the end of the current line REM and then see if you're at the end of the
        paragraph. oTextCursor.gotoRange(oViewCursor, False)
    </p>
    <p>
        REM Check for end of paragraph BEFORE inserting the line break. If oTextCursor.isEndOfParagraph() Then Exit Do
    </p>
    <p>
        REM Insert a line break at the current view cursor. oText.insertControlCharacter(oViewCursor,_
    </p>
    <p>
        com.sun.star.text.ControlCharacter.LINE_BREAK, false)
    </p>
    <p>
        Loop
    </p>
    <p>
        REM If you only want to move the cursor away from the end of the REM current paragraph, then this will suffice.
        oViewCursor.goRight(1, False)
    </p>
    <p>
        REM I want to restore the view cursor location, however. REM oViewCursor.gotoRange(oSaveCursor, False)
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h1 id="accessing-content-using-cursors">
    Accessing content using cursors
</h1>
<blockquote>
    <p>
        I have a habit of inspecting the objects returned to me by OOo. While inspecting a view cursor, I noticed that
        the view cursor contained useful undocumented properties. According to the developers at Sun, these will
        eventually be documented. Some of the properties that I noticed include: Cell, DocumentIndex, DocumentIndexMark,
        Endnote, Footnote, ReferenceMark, Text, TextField, TextFrame, TextSection, and TextTable. If a cursor is in a
        text table, the cursor’s TextTable property is not empty. If a cursor is on a text field, the cursor’s TextField
        property is not empty. These special properties are empty if they are not relevant. I first used these
        undocumented properties when I was asked how to determine if the view cursor was positioned in a text table, and
        if so, what cell contains the view cursor. See Listing 353.
    </p>
    <p>
        <em><strong>Listing 353.</strong> Testing view cursor properties.</em>
    </p>
    <p>
        If NOT IsEmpty(oViewCursor.TextTable) Then
    </p>
    <p>
        Cursors provide the ability to quickly find objects in close proximity to something else. For example, I was
        recently asked how to find a text field contained in the current paragraph—the current paragraph is defined as
        the paragraph containing the view cursor. It’s easy to obtain the view cursor, and you can use a paragraph
        cursor to move around the current paragraph.
    </p>
    <p>
        My first attempt called the createContentEnumeration("com.sun.star.text.TextContent") object method on the
        cursor. This creates an enumeration of text content, enumerating objects such as inserted buttons. I had
        mistakenly assumed that this would include text fields in the enumeration. My second attempt to find a text
        field, which was successful, uses the createEnumeration() object method. The createEnumeration() method returns
        an enumeration of the paragraphs contained in the cursor. Enumerating the content contained in a paragraph
        provides access to the text field. My final attempt, which was also successful, moves the cursor to the start of
        the document and then moves through the paragraph one location at a time looking for a text field. The macro in
        Listing 354 demonstrates all of the methods that I used to try to find a text field in the current paragraph.
    </p>
    <p>
        <em><strong>Listing 354.</strong> Check current paragraph for a text field.</em>
    </p>
    <p>
        Sub TextFieldInCurrentParagraph
    </p>
    <p>
        Dim oEnum 'Cursor enumerator Dim oSection 'Current section
    </p>
    <p>
        Dim oViewCursor 'Current view cursor
    </p>
    <p>
        Dim oTextCursor 'Created text cursor
    </p>
    <p>
        Dim oText 'Text object in current document Dim s$
    </p>
    <p>
        Dim sTextContent$ 'Service name for text content. sTextContent = "com.sun.star.text.TextContent"
    </p>
    <p>
        oText = ThisComponent.Text
    </p>
    <p>
        oViewCursor = ThisComponent.CurrentController.getViewCursor()
    </p>
    <p>
        REM Obtain the view cursor, and then select the paragraph REM containing the view cursor.
    </p>
    <p>
        oTextCursor = oText.createTextCursorByRange(oViewCursor)
    </p>
    <p>
        REM Move to the start of the paragraph as a single point. oTextCursor.gotoStartOfParagraph(False)
    </p>
    <p>
        REM Move to the end of the current paragraph and expand the REM selection so that the entire paragraph is
        selected. oTextCursor.gotoEndOfParagraph(True)
    </p>
    <p>
        REM I want to enumerate the text content contained by this text cursor. REM Although this will find inserted
        drawing objects, such as the shape REM used by a button, it will not find a text field!
    </p>
    <p>
        oEnum = oTextCursor.createContentEnumeration(sTextContent) Do While oEnum.hasMoreElements()
    </p>
    <p>
        oSection = oEnum.nextElement()
    </p>
    <p>
        Print "Enumerating TextContent: " &amp; oSection.ImplementationName Loop
    </p>
    <p>
        REM And this enumerates the paragraphs that are contained in REM the text cursor.
    </p>
    <p>
        oEnum = oTextCursor.createEnumeration() Dim v
    </p>
    <p>
        Do While oEnum.hasMoreElements() v = oEnum.nextElement()
    </p>
    <p>
        Dim oSubSection Dim oSecEnum
    </p>
    <p>
        REM Now create an enumeration of the paragraphs.
    </p>
    <p>
        REM We can enumerate the sections of the paragraph to REM obtain the text field and other paragraph content.
        oSecEnum = v.createEnumeration()
    </p>
    <p>
        s = "Enumerating section type: " &amp; v.ImplementationName Do While oSecEnum.hasMoreElements()
    </p>
    <p>
        oSubSection = oSecEnum.nextElement()
    </p>
    <p>
        s = s &amp; CHR$(10) &amp; oSubSection.TextPortionType If oSubSection.TextPortionType = "TextField" Then
    </p>
    <p>
        s = s &amp; " &lt;== Type " &amp; oSubSection.TextField.ImplementationName End If
    </p>
    <p>
        Loop
    </p>
    <p>
        MsgBox s, 0, "Enumerate Single Paragraph" Loop
    </p>
    <p>
        REM And this is yet another way to find the text field.
    </p>
    <p>
        REM Start at the beginning of the paragraph and then move the cursor REM through it, looking for text fields.
        oTextCursor.gotoStartOfParagraph(False)
    </p>
    <p>
        Do While oTextCursor.goRight(1, False) AND _ NOT oTextCursor.isEndOfParagraph()
    </p>
    <p>
        If NOT IsEmpty(oTextCursor.TextField) Then
    </p>
    <p>
        Print "It is NOT empty, you can use the text field" End If
    </p>
    <p>
        Loop End Sub
    </p>
    <p>
        <strong>TIP</strong> As unintuitive as it sounds, it is not only possible—but common—for the end of a text range
        to come before the start of a text range. The order of the start and end is primarily an issue when dealing with
        text selected by a human user but may also occur due to the movement of a text cursor while expanding the text
        range.
    </p>
    <p>
        As the object methods getStart() and getEnd() imply, it’s possible for a text range to represent a single point.
        It’s also possible that the start position comes after the end position. Unexpected start and end positions are
        typically a problem while dealing with selected text. When you select text using a mouse or your keyboard, the
        initial selection point is generally the start location. Moving the final selection point toward the start of
        the document causes the end position to occur before the start position in the text range. The same behavior may
        occur while manually moving and expanding a cursor. This behavior is not documented, but it has been observed in
        OOo 1.1.0, and like all undocumented behavior, it may change at any time. The text object can compare two ranges
        (see Table 133), but the text object must contain both text ranges—a text range has the getText() object method
        to return the text object that contains the text range.
    </p>
    <p>
        <em><strong>Table 133.</strong> Methods defined by the com.sun.star.text.XTextRangeCompare interface.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 45%" />
        <col style="width: 54%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                compareRegionStarts(XTextRange, XTextRange)
            </td>
            <td>
                <ul>
                    <li>
                        <p>
                            Return 1 if the first range starts before the second.
                        </p>
                    </li>
                    <li>
                        <p>
                            Return 0 if the first range starts at the same position as the second.
                        </p>
                    </li>
                    <li>
                        <p>
                            Return -1 if the first range starts after the second.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                compareRegionEnds(XTextRange, XTextRange)
            </td>
            <td>
                <ul>
                    <li>
                        <p>
                            Return 1 if the first range ends before the second.
                        </p>
                    </li>
                    <li>
                        <p>
                            Return 0 if the first range ends at the same position as the second.
                        </p>
                    </li>
                    <li>
                        <p>
                            Return -1 if the first range ends after the second.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<h2 id="selected-text">
    <em>Selected text</em>
</h2>
<blockquote>
    <p>
        Selected text refers to the text that has been selected by a user, probably using the keyboard or the mouse.
        Selected text is represented as nothing more than a text range. After you find a text selection, it’s possible
        to get the text [getString()] and set the text [setString()]. Although strings are limited to 64KB in size,
        selections are not. There are some instances, therefore, when you can’t use the getString() and setString()
        methods. Therefore, it’s probably better to use a cursor to traverse the selected text and then use the cursor’s
        text object to insert text content. Most problems using selected text look the same at an abstract level.
    </p>
    <p>
        If nothing is selected then do work on entire document
    </p>
    <p>
        else
    </p>
    <p>
        for each selected area
    </p>
    <p>
        do work on selected area
    </p>
    <p>
        The difficult part that changes each time is writing a macro that iterates over a selection or between two text
        ranges.
    </p>
</blockquote>
<h1 id="is-text-selected">
    Is text selected?
</h1>
<blockquote>
    <p>
        Text documents support the XTextSectionsSupplier interface (see Table 122), which defines the single method
        getCurrentSelection(). If there is no current controller (which means that you’re an advanced user running
        OpenOffice.org as a server with no user interface and you won’t be looking for selected text anyway),
        getCurrentSelection() returns a null rather than any selected text.
    </p>
    <p>
        If the selection count is zero, nothing is selected. I have never seen a selection count of zero, but I check
        for it anyway. If no text is selected, there is one selection of zero length—the start and end positions are the
        same. I have seen examples, which I consider unsafe, where a zero-length selection is determined as follows:
    </p>
    <p>
        If Len(oSel.getString()) = 0 Then nothing is selected
    </p>
    <p>
        It is possible that selected text will contain more than 64KB characters, and a string cannot contain more than
        64KB characters. Therefore, don’t check the length of the selected string to see if it is zero; this is not
        safe. The better solution is to create a text cursor from the selected range and then check to see if the start
        and end points are the same.
    </p>
    <p>
        oCursor = oDoc.Text.CreateTextCursorByRange(oSel) If oCursor.IsCollapsed() Then nothing is selected
    </p>
    <p>
        The macro function in Listing 355 performs the entire check, returning True if something is selected, and False
        if nothing is selected.
    </p>
    <p>
        <em><strong>Listing 355.</strong> Determine if anything is selected.</em>
    </p>
    <p>
        Function IsAnythingSelected(oDoc As Object) As Boolean Dim oSelections 'Contains all of the selections
    </p>
    <p>
        Dim oSel 'Contains one specific selection
    </p>
    <p>
        Dim oCursor 'Text cursor to check for a collapsed range REM Assume nothing is selected
    </p>
    <p>
        IsAnythingSelected = False
    </p>
    <p>
        If IsNull(oDoc) Then Exit Function
    </p>
    <p>
        ' The current selection in the current controller. 'If there is no current controller, it returns NULL.
        oSelections = oDoc.getCurrentSelection()
    </p>
    <p>
        If IsNull(oSelections) Then Exit Function
    </p>
    <p>
        If oSelections.getCount() = 0 Then Exit Function If oSelections.getCount() &gt; 1 Then
    </p>
    <p>
        REM There is more than one selection so return True IsAnythingSelected = True
    </p>
    <p>
        Else
    </p>
    <p>
        REM There is only one selection so obtain the first selection oSel = oSelections.getByIndex(0)
    </p>
    <p>
        REM Create a text cursor that covers the range and then see if it is REM collapsed.
    </p>
    <p>
        oCursor = oDoc.Text.CreateTextCursorByRange(oSel)
    </p>
    <p>
        If Not oCursor.IsCollapsed() Then IsAnythingSelected = True
    </p>
    <p>
        REM You can also compare these to see if the selection starts and ends at REM the same location.
    </p>
    <p>
        REM If oDoc.Text.compareRegionStarts(oSel.getStart(),_ REM oSel.getEnd()) &lt;&gt; 0 Then
    </p>
    <p>
        REM IsAnythingSelected = True REM End If
    </p>
    <p>
        End If
    </p>
    <p>
        End Function
    </p>
    <p>
        Obtaining a selection is complicated because it’s possible to have multiple non-contiguous selections. Some
        selections are empty and some are not. If you write code to handle text selection, it should handle all of these
        cases because they occur frequently. The example in Listing 356 iterates through all selected sections and
        displays them in a message box.
    </p>
    <p>
        <em><strong>Listing 356.</strong> Display selected text.</em>
    </p>
    <p>
        Sub PrintMultipleTextSelection
    </p>
    <p>
        Dim oSelections 'Contains all of the selections
    </p>
    <p>
        Dim oSel 'Contains one specific selection Dim lWhichSelection As Long 'Which selection to print
    </p>
    <p>
        If NOT IsAnythingSelected(ThisComponent) Then Print "Nothing is selected"
    </p>
    <p>
        Else
    </p>
    <p>
        oSelections = ThisComponent.getCurrentSelection()
    </p>
    <p>
        For lWhichSelection = 0 To oSelections.getCount() - 1 oSel = oSelections.getByIndex(lWhichSelection)
    </p>
    <p>
        MsgBox oSel.getString(), 0, "Selection " &amp; lWhichSelection Next
    </p>
    <p>
        End If End Sub
    </p>
</blockquote>
<h1 id="selected-text-which-end-is-which">
    Selected text: Which end is which?
</h1>
<blockquote>
    <p>
        Selections are text ranges with a start and an end. Although selections have both a start and an end, which side
        of the text is which is determined by the selection method. For example, position the cursor in the middle of a
        line, and then select text by moving the cursor either right or left. In both cases, the start position is the
        same. In one of these cases, the start position is after the end position. The text object provides methods to
        compare starting and ending positions of text ranges (see Table 133). I use the two methods in Listing 357 to
        find the leftmost and rightmost cursor position of selected text.
    </p>
    <p>
        <em><strong>Listing 357.</strong> Get left and right cursor.</em>
    </p>
    <p>
        'oSel is a text selection or cursor range 'oText is the text object
    </p>
    <p>
        Function GetLeftMostCursor(oSel, oText) Dim oRange
    </p>
    <p>
        Dim oCursor
    </p>
    <p>
        If oText.compareRegionStarts(oSel.getEnd(), oSel) &gt;= 0 Then oRange = oSel.getEnd()
    </p>
    <p>
        Else
    </p>
    <p>
        oRange = oSel.getStart()
    </p>
    <p>
        End If
    </p>
    <p>
        oCursor = oText.CreateTextCursorByRange(oRange) oCursor.goRight(0, False)
    </p>
    <p>
        GetLeftMostCursor = oCursor End Function
    </p>
    <p>
        'oSel is a text selection or cursor range 'oText is the text object
    </p>
    <p>
        Function GetRightMostCursor(oSel, oText) Dim oRange
    </p>
    <p>
        Dim oCursor
    </p>
    <p>
        If oText.compareRegionStarts(oSel.getEnd(), oSel) &gt;= 0 Then oRange = oSel.getStart()
    </p>
    <p>
        Else
    </p>
    <p>
        oRange = oSel.getEnd()
    </p>
    <p>
        End If
    </p>
    <p>
        oCursor = oText.CreateTextCursorByRange(oRange) oCursor.goLeft(0, False)
    </p>
    <p>
        GetRightMostCursor = oCursor End Function
    </p>
    <p>
        While using text cursors to move through a document, I noticed that cursors remember the direction in which they
        are traveling. The cursors returned by the macros in Listing 357 are oriented to travel into the text selection
        by moving the cursor left or right zero characters. This is also an issue while moving a cursor to the right and
        then turning it around to move left. I always start by moving the cursor zero characters in the desired
        direction before actually moving the cursor. Then my macro can use these cursors to traverse the selected text
        from the start (moving right) or the end (moving left).
    </p>
</blockquote>
<h1 id="selected-text-framework">
    Selected text framework
</h1>
<blockquote>
    <p>
        While dealing with selected text, I use a framework that returns a two-dimensional array of start and end
        cursors over which to iterate. Using a framework allows me to use a very minimal code base to iterate over
        selected text or the entire document. If no text is selected, the framework asks if the macro should use the
        entire document. If the answer is yes, a cursor is created at the start and the end of the document. If text is
        selected, each selection is retrieved, and a cursor is obtained at the start and end of each selection. See
        Listing 358.
    </p>
    <p>
        <em><strong>Listing 358.</strong> Create cursors with selected areas.</em>
    </p>
    <p>
        'sPrompt : How to ask if should iterate over the entire text 'oCursors() : Has the return cursors
    </p>
    <p>
        'Returns True if should iterate and False if should not
    </p>
    <p>
        Function CreateSelectedTextIterator(oDoc, sPrompt$, oCursors()) As Boolean Dim oSelections 'Contains all of the
        selections
    </p>
    <p>
        Dim oSel 'Contains one specific selection
    </p>
    <p>
        Dim oText 'Document text object Dim lSelCount As Long 'Number of selections Dim lWhichSelection As Long 'Current
        selection Dim oLCursor, oRCursor 'Temporary cursors CreateSelectedTextIterator = True
    </p>
    <p>
        oText = oDoc.Text
    </p>
    <p>
        If Not IsAnythingSelected(oDoc) Then Dim i%
    </p>
    <p>
        i% = MsgBox("No text selected!" + CHR$(13) + sPrompt, _
    </p>
    <p>
        1 OR 32 OR 256, "Warning")
    </p>
    <p>
        If i% = 1 Then
    </p>
    <p>
        oLCursor = oText.createTextCursorByRange(oText.getStart()) oRCursor =
        oText.createTextCursorByRange(oText.getEnd()) oCursors = DimArray(0, 1) 'Two-Dimensional array with one row
        oCursors(0, 0) = oLCursor
    </p>
    <p>
        oCursors(0, 1) = oRCursor Else
    </p>
    <p>
        oCursors = DimArray() 'Return an empty array CreateSelectedTextIterator = False
    </p>
    <p>
        End If Else
    </p>
    <p>
        oSelections = oDoc.getCurrentSelection() lSelCount = oSelections.getCount() oCursors = DimArray(lSelCount - 1,
        1)
    </p>
    <p>
        For lWhichSelection = 0 To lSelCount - 1
    </p>
    <p>
        oSel = oSelections.getByIndex(lWhichSelection) oLCursor = GetLeftMostCursor(oSel, oText) oRCursor =
        GetRightMostCursor(oSel, oText) oCursors(lWhichSelection, 0) = oLCursor oCursors(lWhichSelection, 1) = oRCursor
    </p>
    <p>
        Next End If
    </p>
    <p>
        End Function
    </p>
    <p>
        <strong>TIP</strong> The argument oCursors() is an array that is set in the macro in Listing 358.
    </p>
    <p>
        The macro in Listing 359 uses the selected text framework to print the Unicode values of the selected text.
    </p>
    <p>
        <em><strong>Listing 359.</strong> Display Unicode of the selected text.</em>
    </p>
    <p>
        Sub PrintUnicodeExamples Dim oCursors(), i%
    </p>
    <p>
        If Not CreateSelectedTextIterator(ThisComponent, _
    </p>
    <p>
        "Print Unicode for the entire document?", oCursors()) Then Exit Sub For i% = LBound(oCursors()) To
        UBound(oCursors())
    </p>
    <p>
        PrintUnicode_worker(oCursors(i%, 0), oCursors(i%, 1), ThisComponent.Text) Next i%
    </p>
    <p>
        End Sub
    </p>
    <p>
        Sub PrintUnicode_worker(oLCursor, oRCursor, oText)
    </p>
    <p>
        Dim s As String 'contains the primary message string Dim ss As String 'used as a temporary string
    </p>
    <p>
        If IsNull(oLCursor) Or IsNull(oRCursor) Or IsNull(oText) Then Exit Sub If oText.compareRegionEnds(oLCursor,
        oRCursor) &lt;= 0 Then Exit Sub
    </p>
    <p>
        REM Start the cursor in the correct direction with no text selected oLCursor.goRight(0, False)
    </p>
    <p>
        Do While oLCursor.goRight(1, True)_
    </p>
    <p>
        AND oText.compareRegionEnds(oLCursor, oRCursor) &gt;= 0 ss = oLCursor.getString()
    </p>
    <p>
        REM The string may be empty If Len(ss) &gt; 0 Then
    </p>
    <p>
        s = s &amp; oLCursor.getString() &amp; "=" &amp; ASC(oLCursor.getString()) &amp; " " End If
    </p>
    <p>
        oLCursor.goRight(0, False)
    </p>
    <p>
        Loop
    </p>
    <p>
        msgBox s, 0, "Unicode Values" End Sub
    </p>
</blockquote>
<h1 id="remove-empty-spaces-and-lines-a-larger-example">
    Remove empty spaces and lines: A larger example
</h1>
<blockquote>
    <p>
        A common request is for a macro that removes extra blank spaces. To remove all empty paragraphs, it’s better to
        use the Remove Blank Paragraphs option from the AutoCorrect dialog (<strong>Tools | AutoCorrect Options |
            Options</strong>). To remove only selected paragraphs or runs of blank space, a macro is required.
    </p>
    <p>
        This section presents a set of macros that replaces all runs of white-space characters with a single white-
        space character. You can easily modify this macro to delete different types of white space. The different types
        of space are ordered by importance, so if you have a regular space followed by a new paragraph, the new
        paragraph stays and the single space is removed. The end effect is that leading and trailing white space is
        removed from each line.
    </p>
</blockquote>
<h3 class="unnumbered" id="what-is-white-space">
    <em>What is white space?</em>
</h3>
<blockquote>
    <p>
        The term “white space” typically refers to any character that is displayed as a blank space. This includes tabs
        (ASCII value 9), regular spaces (ASCII value 32), non-breaking spaces (ASCII value 160), new paragraphs (ASCII
        value 13), and new lines (ASCII value 10). By encapsulating the definition of white space into a function (see
        Listing 360), you can trivially change the definition of white space to ignore certain characters.
    </p>
    <p>
        <em><strong>Listing 360.</strong> Determine if a character is white space.</em>
    </p>
    <p>
        Function IsWhiteSpace(iChar As Integer) As Boolean Select Case iChar
    </p>
    <p>
        Case 9, 10, 13, 32, 160
    </p>
    <p>
        IsWhiteSpace = True Case Else
    </p>
    <p>
        IsWhiteSpace = False End Select
    </p>
    <p>
        End Function
    </p>
    <p>
        If time is a serious issue, it is faster to create an array that is indexed by the Unicode value that contains
        true or false to indicate if a character is white space. The problem is that the array must be set before the
        call.
    </p>
    <p>
        For i = LBound(isWhiteArray) To UBound(isWhiteArray) isWhiteArray(i) = False
    </p>
    <p>
        Next
    </p>
    <p>
        isWhiteArray(9) = True isWhiteArray(10) = True isWhiteArray(13) = True isWhiteArray(32) = True isWhiteArray(160)
        = True
    </p>
    <p>
        The function to test is as follows:
    </p>
    <p>
        Function IsWhiteSpace2(iChar As Integer) As Boolean If iChar &gt; UBound(isWhiteArray) Then
    </p>
    <p>
        IsWhiteSpace2 = False Else
    </p>
    <p>
        IsWhiteSpace2 = isWhiteArray(iChar) End If
    </p>
    <p>
        End Function
    </p>
</blockquote>
<h3 class="unnumbered" id="rank-characters-for-deletion">
    <em>Rank characters for deletion</em>
</h3>
<blockquote>
    <p>
        While removing runs of white space, each character is compared to the character before it. If both characters
        are white space, the less important character is deleted. For example, if there is both a space and a new
        paragraph, the space is deleted. The RankChar() function (see Listing 361) accepts two characters: the previous
        character and the current character. The returned integer indicates which, if any, character should be deleted.
    </p>
    <p>
        <em><strong>Listing 361.</strong> Rank characters for deletion.</em>
    </p>
    <p>
        '-1 means delete the previous character ' 0 means ignore this character
    </p>
    <p>
        ' 1 means delete this character
    </p>
    <p>
        ' If an input character is 0, this is the start of a line. ' Rank from highest to lowest is: 0, 13, 10, 9, 160,
        32 Function RankChar(iPrevChar, iCurChar) As Integer
    </p>
    <p>
        If Not IsWhiteSpace(iCurChar) Then 'Current not white space, ignore it RankChar = 0
    </p>
    <p>
        ElseIf iPrevChar = 0 Then 'Line start, current is white space RankChar = 1 ' delete the current character.
    </p>
    <p>
        ElseIf Not IsWhiteSpace(iPrevChar) Then 'Current is space but not previous RankChar = 0 ' ignore the current
        character.
    </p>
    <p>
        REM At this point, both characters are white space
    </p>
    <p>
        ElseIf iPrevChar = 13 Then 'Previous is highest ranked space RankChar = 1 ' delete the current character.
    </p>
    <p>
        ElseIf iCurChar = 13 Then 'Current is highest ranked space RankChar = -1 ' delete the previous character.
    </p>
    <p>
        REM Neither character is a new paragraph, the highest ranked ElseIf iPrevChar = 10 Then 'Previous is new line
    </p>
    <p>
        RankChar = 1 ' delete the current character.
    </p>
    <p>
        ElseIf iCurChar = 10 Then 'Current is new line
    </p>
    <p>
        RankChar = -1 ' delete the previous character.
    </p>
    <p>
        REM At this point, the highest ranking possible is a tab ElseIf iPrevChar = 9 Then 'Previous char is tab
    </p>
    <p>
        RankChar = 1 ' delete the current character.
    </p>
    <p>
        ElseIf iCurChar = 9 Then 'Current char is tab
    </p>
    <p>
        RankChar = -1 ' delete the previous character.
    </p>
    <p>
        ElseIf iPrevChar = 160 Then 'Previous char is a hard space RankChar = 1 ' delete the current character.
    </p>
    <p>
        ElseIf iCurChar = 160 Then 'Current char is a hard space RankChar = -1 ' delete the previous character.
    </p>
    <p>
        ElseIf iPrevChar = 32 Then 'Previous char is a regular space RankChar = 1 ' delete the current character.
    </p>
    <p>
        REM Probably should never get here... both characters are white space REM and the previous is not any known
        white space character.
    </p>
    <p>
        ElseIf iCurChar = 32 Then 'Current char is a regular space RankChar = -1 ' delete the previous character.
    </p>
    <p>
        Else 'Should probably not get here
    </p>
    <p>
        RankChar = 0 'so simply ignore it!
    </p>
    <p>
        End If
    </p>
    <p>
        End Function
    </p>
</blockquote>
<h3 class="unnumbered" id="use-the-standard-framework">
    <em>Use the standard framework</em>
</h3>
<blockquote>
    <p>
        The standard framework is used to remove the empty spaces. The primary routine is simple enough that it barely
        warrants mentioning.
    </p>
    <p>
        <em><strong>Listing 362.</strong> Remove empty space.</em>
    </p>
    <p>
        Sub RemoveEmptySpace Dim oCursors(), i%
    </p>
    <p>
        If Not CreateSelectedTextIterator(ThisComponent, _
    </p>
    <p>
        "ALL empty space will be removed from the ENTIRE document?", oCursors()) Then Exit Sub For i% =
        LBOUND(oCursors()) To UBOUND(oCursors())
    </p>
    <p>
        RemoveEmptySpaceWorker (oCursors(i%, 0), oCursors(i%, 1), ThisComponent.Text) Next i%
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h3 class="unnumbered" id="the-worker-macro">
    <em>The worker macro</em>
</h3>
<blockquote>
    <p>
        The macro in Listing 363 represents the interesting part of this problem; it decides what is deleted and what is
        left untouched. Some interesting points should be noted:
    </p>
    <p>
        Because a text cursor is used, the formatting is left unchanged.
    </p>
    <p>
        A text range (cursor) may contain text content that returns a zero­length string. This includes, for example,
        buttons and graphic images contained in the document. Handling exceptional cases adds complexity to the macro.
        Many tasks are very simple if you ignore the exceptional cases, such as inserted graphics. If you know that your
        macro will run with simple controlled data, you may choose to sacrifice robustness to reduce complexity. Listing
        363 handles the exceptional cases.
    </p>
    <p>
        If the selected text starts or ends with white space, it will be removed even if it does not start or end the
        document.
    </p>
    <p>
        <em><strong>Listing 363.</strong> RemoveEmptySpaceWorker.</em>
    </p>
    <p>
        Sub RemoveEmptySpaceWorker(oLCursor, oRCursor, oText) Dim s As String 'Temporary text string
    </p>
    <p>
        Dim i As Integer 'Temporary integer used for comparing text ranges Dim iLastChar As Integer 'Unicode of last
        character
    </p>
    <p>
        Dim iThisChar As Integer 'Unicode of the current character
    </p>
    <p>
        Dim iRank As Integer 'Integer ranking that decides what to delete
    </p>
    <p>
        REM If something is null, then do nothing
    </p>
    <p>
        If IsNull(oLCursor) Or IsNull(oRCursor) Or IsNull(oText) Then Exit Sub
    </p>
    <p>
        REM Ignore any collapsed ranges
    </p>
    <p>
        If oText.compareRegionEnds(oLCursor, oRCursor) &lt;= 0 Then Exit Sub
    </p>
    <p>
        REM Default the first and last character to indicate start of new line iLastChar = 0
    </p>
    <p>
        iThisChar = 0
    </p>
    <p>
        REM Start the leftmost cursor moving toward the end of the document REM and make certain that no text is
        currently selected. oLCursor.goRight(0, False)
    </p>
    <p>
        REM At the end of the document, the cursor can no longer move right Do While oLCursor.goRight(1, True)
    </p>
    <p>
        REM It is possible that the string is zero length.
    </p>
    <p>
        REM This can happen when stepping over certain objects anchored into REM the text that contain no text. Extra
        care must be taken because REM this routine can delete these items because the cursor steps over
    </p>
    <p>
        REM them but they have no text length. I arbitrarily call this a regular REM ASCII character without obtaining
        the string.
    </p>
    <p>
        s = oLCursor.getString()
    </p>
    <p>
        If Len(s) = 0 Then oLCursor.goRight(0, False) iThisChar = 65
    </p>
    <p>
        Else
    </p>
    <p>
        iThisChar = Asc(oLCursor.getString()) End If
    </p>
    <p>
        REM If at the last character Then always remove white space i = oText.compareRegionEnds(oLCursor, oRCursor)
    </p>
    <p>
        If i = 0 Then
    </p>
    <p>
        If IsWhiteSpace(iThisChar) Then oLCursor.setString("") Exit Do
    </p>
    <p>
        End If
    </p>
    <p>
        REM If went past the end then get out If i &lt; 0 Then Exit Do
    </p>
    <p>
        iRank = RankChar(iLastChar, iThisChar) If iRank = 1 Then
    </p>
    <p>
        REM Ready to delete the current character. REM The iLastChar is not changed.
    </p>
    <p>
        REM Deleting the current character by setting the text to the REM empty string causes no text to be selected.
    </p>
    <p>
        'Print "Deleting Current with " + iLastChar + " and " + iThisChar oLCursor.setString("")
    </p>
    <p>
        ElseIf iRank = -1 Then
    </p>
    <p>
        REM Ready to delete the previous character. One character is already REM selected. It was selected by moving
        right so moving left two
    </p>
    <p>
        REM deslects the currently selected character and selects the REM character to the left.
    </p>
    <p>
        oLCursor.goLeft(2, True)
    </p>
    <p>
        'Print "Deleting to the left with " + iLastChar + " and " + iThisChar oLCursor.setString("")
    </p>
    <p>
        REM Now the cursor is moved over the current character again but REM this time it is not selected.
    </p>
    <p>
        oLCursor.goRight(1, False)
    </p>
    <p>
        REM Set the previous character to the current character. iLastChar = iThisChar
    </p>
    <p>
        Else
    </p>
    <p>
        REM Instructed to ignore the current character so deselect any text REM and then set the last character to the
        current character. oLCursor.goRight(0, False)
    </p>
    <p>
        iLastChar = iThisChar End If
    </p>
    <p>
        Loop End Sub
    </p>
</blockquote>
<h1 id="selected-text-closing-thoughts">
    Selected text, closing thoughts
</h1>
<blockquote>
    <p>
        Anyone who has studied algorithms will tell you that a better algorithm is almost always better than a faster
        computer. An early problem that I solved was counting words in selected text. I created three solutions with
        varying degrees of success.
    </p>
    <p>
        My first solution converted the selected text to OOo Basic strings and then manipulated the strings. This
        solution was fast, counting 8000 words in 2.7 seconds. This solution failed when text strings exceeded 64KB in
        size, rendering it useless for large documents.
    </p>
    <p>
        My second solution used a cursor as it walked through the text one character at a time. This solution, although
        able to handle any length of text, required 47 seconds to count the same 8000 words. In other words, the users
        found the solution unusably slow.
    </p>
    <p>
        My final solution used a word cursor, which counted the words in 1.7 seconds. Unfortunately, sometimes the word
        cursor is sometimes unreliable.
    </p>
    <p>
        <strong>TIP</strong> To count words correctly, visit Andrew Brown’s useful macro Web site:
    </p>
    <p>
        <a
            href="http://www.darwinwars.com/lunatic/bugs/oo_macros.html"><strong>http://www.darwinwars.com/lunatic/bugs/oo_macros.html</strong>.</a>
    </p>
</blockquote>
<h2 id="search-and-replace">
    <em>Search and replace</em>
</h2>
<blockquote>
    <p>
        The search process is directed by a search descriptor, which is able to search only the object that created it.
        In other words, you cannot use the same search descriptor to search multiple documents. The search descriptor
        specifies the search text and how the text is searched (see Table 134). The search descriptor is the most
        complicated component of searching.
    </p>
    <p>
        <em><strong>Table 134.</strong> Properties of the com.sun.star.util.SearchDescriptor service.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 29%" />
        <col style="width: 70%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                SearchBackwards
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, search the document backwards.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                SearchCaseSensitive
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the case of the letters affects the search.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                SearchWords
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, only complete words are found.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                SearchRegularExpression
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the search string is treated as a regular expression.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                SearchStyles
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, text is found based on applied style names—not on the text content.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                SearchSimilarity
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, a “similarity search” is performed.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                SearchSimilarityRelax
            </td>
            <td>
                <blockquote>
                    <p>
                        If True, the properties SearchSimilarityRelax, SearchSimilarityRemove, SearchSimilarityAdd, and
                        SearchSimilarityExchange are all used.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                SearchSimilarityRemove
            </td>
            <td>
                <blockquote>
                    <p>
                        Short Integer specifying how many characters may be ignored in a match.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                SearchSimilarityAdd
            </td>
            <td>
                <blockquote>
                    <p>
                        Short Integer specifying how many characters may be added in a match.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                SearchSimilarityExchange
            </td>
            <td>
                <blockquote>
                    <p>
                        Short Integer specifying how many characters may be replaced in a match.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Although not included in Table 134, a search descriptor supports the string property SearchString, which
        represents the string to search. The XSearchDescriptor interface defines the methods getSearchString() and
        setSearchString() to get and set the property if you prefer to use a method rather than directly setting the
        property. The XSearchable interface defines the methods used for searching and creating the search descriptor
        (see Table 135).
    </p>
    <p>
        <em><strong>Table 135.</strong> Methods defined by the com.sun.star.util.XSearchable interface.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 40%" />
        <col style="width: 59%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                createSearchDescriptor()
            </td>
            <td>
                Create a new SearchDescriptor.
            </td>
        </tr>
        <tr class="even">
            <td>
                findAll(XSearchDescriptor)
            </td>
            <td>
                <blockquote>
                    <p>
                        Return an XindexAccess containing all occurrences.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                findFirst(XSearchDescriptor)
            </td>
            <td>
                Starting from the beginning of the searchable object, return a text range containing the first found
                text.
            </td>
        </tr>
        <tr class="even">
            <td>
                findNext(XTextRange, XSearchDescriptor)
            </td>
            <td>
                Starting from the provided text range, return a text range containing the first found text.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        The macro in Listing 364 is very simple; it sets the CharWeight character property of all occurrences of the
        text “hello” to com.sun.start.awt.FontWeight.BOLD—text ranges support character and paragraph properties.
    </p>
    <p>
        <em><strong>Listing 364.</strong> Set all occurrences of the word “hello” to bold text.</em>
    </p>
    <p>
        Sub SetHelloToBold
    </p>
    <p>
        Dim oDescriptor 'The search descriptor Dim oFound 'The found range
    </p>
    <p>
        oDescriptor = ThisComponent.createSearchDescriptor() With oDescriptor
    </p>
    <p>
        .SearchString = "hello"
    </p>
    <p>
        .SearchWords = true 'The attributes default to False
    </p>
    <p>
        .SearchCaseSensitive = False 'So setting one to False is redundant End With
    </p>
    <p>
        ' Find the first one
    </p>
    <p>
        oFound = ThisComponent.findFirst(oDescriptor) Do While Not IsNull(oFound)
    </p>
    <p>
        Print oFound.getString()
    </p>
    <p>
        oFound.CharWeight = com.sun.star.awt.FontWeight.BOLD oFound = ThisComponent.findNext(oFound.End, oDescriptor)
    </p>
    <p>
        Loop End Sub
    </p>
</blockquote>
<h1 id="searching-selected-text-or-a-specified-range">
    Searching selected text or a specified range
</h1>
<blockquote>
    <p>
        The trick to searching a specified range of text is to notice that you can use any text range, including a text
        cursor, in the findNext routine. After each call to findNext(), check the end points of the find to see if the
        search went too far. You may, therefore, constrain a search to any text range. The primary purpose of the
        findFirst method is to obtain the initial text range for the findNext routine. You can use the selected text
        framework very easily to search a range of text.
    </p>
    <p>
        <em><strong>Listing 365.</strong> Iterate through all occurrences of text between two cursors.</em>
    </p>
    <p>
        Sub SearchSelectedWorker(oLCursor, oRCursor, oText, oDescriptor)
    </p>
    <p>
        If oText.compareRegionEnds(oLCursor, oRCursor) &lt;= 0 Then Exit Sub
    </p>
    <p>
        oLCursor.goRight(0, False) Dim oFound
    </p>
    <p>
        REM There is no reason to perform a findFirst. oFound = oDoc.findNext(oLCursor, oDescriptor) Do While Not
        IsNull(oFound)
    </p>
    <p>
        REM See if we searched past the end
    </p>
    <p>
        If -1 = oText.compareRegionEnds(oFound, oRCursor) Then Exit Do Print oFound.getString()
    </p>
    <p>
        oFound = ThisComponent.findNext(oFound.End, oDescriptor) Loop
    </p>
    <p>
        End Sub
    </p>
    <p>
        The text object cannot compare two regions unless they both belong to that text object. Text that resides in a
        different frame, section, or even a text table, uses a different text object than the main document text object.
        As an exercise, investigate what happens if the found text is in a different text object than the text object
        that contains oRCursor in Listing 365. Is the code in Listing 365 robust?
    </p>
</blockquote>
<h1 class="unnumbered" id="searching-for-all-occurrences">
    Searching for all occurrences
</h1>
<blockquote>
    <p>
        It is significantly faster to search for all occurrences of the text at one time using the findAll() object
        method than to repeatedly call findNext(). Care must be used, however, when using all occurrences of the
        specified text. The macro in Listing 366 is an extreme example of code gone bad on purpose.
    </p>
    <p>
        <em><strong>Listing 366.</strong> Find and replace all occurrences of the word “helloxyzzy”.</em>
    </p>
    <p>
        Sub SimpleSearchHelloXyzzy
    </p>
    <p>
        Dim oDescriptor 'The search descriptor Dim oFound 'The found range
    </p>
    <p>
        Dim oFoundAll 'The found range
    </p>
    <p>
        Dim n% 'General index variable oDescriptor = ThisComponent.createSearchDescriptor() oDescriptor.SearchString =
        "helloxyzzy"
    </p>
    <p>
        oFoundAll = ThisComponent.findAll(oDescriptor)
    </p>
    <p>
        For n% = 0 to oFoundAll.getCount()-1 oFound = oFoundAll.getByIndex(n%) 'Print oFound.getString()
        oFound.setString("hello" &amp; n%)
    </p>
    <p>
        Next End Sub
    </p>
    <p>
        The macro in Listing 366 obtains a list of text ranges that encapsulate the text “helloxyzzy”. This text is then
        replaced with a shorter piece of text. In a perfect world, the occurrences of “helloxyzzy” would be replaced
        with “hello0”, “hello1”, “hello2”, ... When each instance is replaced with the shorter text, the total length of
        the document changes. Remember that the text-range objects were all obtained before the first instance of text
        is modified. Although the text-range interface is clearly defined, the internal workings are not. I purposely
        created this example because I expected it to fail, and with no defined behavior my only option was to create a
        test. Experimentally, I observed that if multiple occurrences of “helloxyzzy” are contained in the same word,
        poor behavior results. I also observed that if all occurrences of “helloxyzzy” are contained in separate words,
        everything works great, and only occurrences of “helloxyzzy” are changed—leaving the surrounding text intact. I
        can but nod my head in approval at the brilliance of the programmers that allow this behavior, while remaining
        cautiously paranoid, expecting that code relying on this behavior will fail in the future.
    </p>
    <p>
        Investigating the behavior of the macro in Listing 366 is more than simple academics. I use a similar macro
        regularly in my own writing. For various reasons, the numbering used during the creation of this book was done
        manually rather than using the built-in numbering capabilities of OOo—in other words, I should have read Chapter
        5 of <em>Taming OpenOffice.org Writer 1.1</em> by Jean Hollis Weber. Manually inserting numbering is a problem
        when a table, figure, or code listing is deleted, inserted, or moved. In other words, if I delete the first
        table in my document, all of my tables will be numbered incorrectly. I created a macro that verifies that the
        items are sequentially numbered starting with 1. Consider tables, for example. The table captions use the
        paragraph style “_table caption.” Tables are numbered using the form “Table 122.” The macro in <strong>Listing
            390</strong> verifies that the captions are sequentially numbered, and it renumbers them if required. When
        the text “Table #” is found in a paragraph using the “_table caption” paragraph style, it is assumed to be
        identifying a table. The macro in Listing 390 renumbers these based on their occurrence in the document. Each
        occurrence of “Table #” that is not in the “_table caption” paragraph style is assumed to be a reference to a
        table.
    </p>
</blockquote>
<h1 id="searching-and-replacing">
    Searching and replacing
</h1>
<blockquote>
    <p>
        You can perform simple searching and replacing by searching and manually replacing each found occurrence with
        the replacement text. OOo also defines the XReplaceable interface, which adds the ability to replace all
        occurrences using one method. You must use an XReplaceDescriptor rather than an XSearchDescriptor, however.
        Replacing all occurrences of text is very simple (see Listing 367).
    </p>
    <p>
        <strong>TIP</strong> The XReplaceable interface is derived from the XSearchable interface, and the
        XReplaceDescriptor is derived from the XSearchDescriptor interface.
    </p>
    <p>
        <em><strong>Listing 367.</strong> Replace “hello you” with “hello me”.</em>
    </p>
    <p>
        oDescriptor = oDoc.createReplaceDescriptor() With oDescriptor
    </p>
    <p>
        .SearchString = "hello you"
    </p>
    <p>
        .ReplaceString = "hello me" End With oDoc.ReplaceAll(oDescriptor)
    </p>
</blockquote>
<h1 id="advanced-search-and-replace">
    Advanced search and replace
</h1>
<blockquote>
    <p>
        While using the OOo GUI for searching and replacing, it is possible to search for and replace attributes as well
        as text. An inspection of the search-and-replace descriptors reveals the object methods setSearchAttributes()
        and setReplaceAttributes(). I discovered how to use these object methods when I found some code written by Alex
        Savitsky, whom I do not know, and Laurent Godard, whom I do.
    </p>
    <p>
        The macro in Listing 368 finds all text that is in bold type, converts the text to regular type, and then
        surrounds the text with two sets of curly brackets. The conversion of attributes to text tags is frequently done
        while converting formatted text to regular ASCII text with no special formatting capabilities. While reading
        Listing 368, look for the following interesting techniques:
    </p>
    <p>
        To search for all text that is bold regardless of the content, you must use a regular expression. In OOo, the
        period matches any single character and the asterisk means “find zero or more occurrences of the previous
        character.” Placed together, the regular expression “.*” matches any text. Regular expressions are required to
        find “any text” that is bold.
    </p>
    <p>
        While searching regular expressions, the ampersand character is replaced by the found text. In Listing 368, the
        replacement text “{{ &amp; }}” causes the found text “hello” to become “{{ hello }}”.
    </p>
    <p>
        Text that is set to bold using an applied style is found only while searching character attributes if
        SearchStyles is set to True. If the SearchStyles attribute is set to False, only text that has been directly set
        to bold will be found.
    </p>
    <p>
        To search for text with specific attributes, create an array of structures of type PropertyValue. There should
        be one entry in the array for each attribute you want to search. Set the property name to the name of the
        attribute to search, and the property value to the value for which to search. Although this is complicated to
        describe using words, it is clearly shown in Listing 368.
    </p>
    <p>
        You can set attribute values by specifying the replacement attributes in the same way that you set the search
        attributes.
    </p>
    <p>
        <em><strong>Listing 368.</strong> Replace bold text.</em>
    </p>
    <p>
        Sub ReplaceFormatting
    </p>
    <p>
        REM original code : Alex Savitsky REM modified by : Laurent Godard REM modified by : Andrew Pitonyak
    </p>
    <p>
        REM The purpose of this macro is to surround all BOLD elements with {{ }} REM and change the Bold attribute to
        NORMAL by using a regular expression.
    </p>
    <p>
        Dim oReplace
    </p>
    <p>
        Dim SrchAttributes(0) as new com.sun.star.beans.PropertyValue Dim ReplAttributes(0) as new
        com.sun.star.beans.PropertyValue
    </p>
    <p>
        oReplace = ThisComponent.createReplaceDescriptor()
    </p>
    <p>
        oReplace.SearchString = ".*" 'Regular expression. Match any text oReplace.ReplaceString = "{{ &amp; }}" 'Note
        the &amp; places the found text back oReplace.SearchRegularExpression=True 'Use regular expressions
        oReplace.searchStyles=True 'We want to search styles
    </p>
    <p>
        oReplace.searchAll=True 'Do the entire document
    </p>
    <p>
        REM This is the attribute to find SrchAttributes(0).Name = "CharWeight"
    </p>
    <p>
        SrchAttributes(0).Value =com.sun.star.awt.FontWeight.BOLD
    </p>
    <p>
        REM This is the attribute to replace it with ReplAttributes(0).Name = "CharWeight" ReplAttributes(0).Value
        =com.sun.star.awt.FontWeight.NORMAL
    </p>
    <p>
        REM Set the attributes in the replace descriptor oReplace.SetSearchAttributes(SrchAttributes())
        oReplace.SetReplaceAttributes(ReplAttributes())
    </p>
    <p>
        REM Now do the work! ThisComponent.replaceAll(oReplace)
    </p>
    <p>
        End Sub
    </p>
    <p>
        <strong>Table 136</strong> lists the supported regular expression characters.
    </p>
    <p>
        <em><strong>Table 136.</strong> Supported regular expression characters.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 18%" />
        <col style="width: 81%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Character</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                .
            </td>
            <td>
                A period represents any single character. The search term "sh.rt" finds both “shirt” and “short”.
            </td>
        </tr>
        <tr class="even">
            <td>
                *
            </td>
            <td>
                An asterisk represents any number of characters. The search term “sh*rt” finds “shrt”, “shirt”,
                ”shiirt”, “shioibaldawpclasdfa asdf asdfrt” and “short”—to name a few things that it can find.
            </td>
        </tr>
        <tr class="odd">
            <td>
                ^
            </td>
            <td>
                A caret represents the beginning of a paragraph. The search term “^Bob” only finds the word “Bob” if it
                is at the beginning of a paragraph. The search term “^.” finds the first character in a paragraph.
            </td>
        </tr>
        <tr class="even">
            <td>
                $
            </td>
            <td>
                A dollar sign represents the end of a paragraph. The search term “Bob$” only finds the word “Bob” if it
                is at the end of a paragraph.
            </td>
        </tr>
        <tr class="odd">
            <td>
                ^$
            </td>
            <td>
                Search for an empty paragraph. This is listed here only because it is used so frequently.
            </td>
        </tr>
        <tr class="even">
            <td>
                +
            </td>
            <td>
                <p>
                    A plus sign indicates that the preceding character must appear at least once. The plus sign also
                    works with the wildcard character “.”. For example, “t.+s” finds a section of text that starts with
                    a “t” and ends with an “s”.
                </p>
                <p>
                    The longest possible text within the paragraph is always found. In other words, multiple words may
                    be found, but the found text will always reside in the same paragraph.
                </p>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ?
            </td>
            <td>
                A question mark marks the previous character as optional. For example, you could find words that include
                the characters that come before the character that is in front of the “\”. For example, “birds?” finds
                both “bird” and “birds”.
            </td>
        </tr>
        <tr class="even">
            <td>
                \n
            </td>
            <td>
                The text “\n” has two uses. When searching, this finds a hard row break inserted with Shift+Enter. In
                the replace field, this represents a paragraph break. You can, therefore, replace all hard breaks with a
                paragraph break.
            </td>
        </tr>
        <tr class="odd">
            <td>
                \t
            </td>
            <td>
                The text “\t” is used to find a tab. In the replace field, this adds a tab.
            </td>
        </tr>
        <tr class="even">
            <td>
                \&gt;
            </td>
            <td>
                Using the text “\&gt;” indicates that the preceding text must end a word. For example, “book\&gt;” finds
                “checkbook” but not “bookmark”.
            </td>
        </tr>
        <tr class="odd">
            <td>
                \&lt;
            </td>
            <td>
                Using the text “\&lt;” indicates that the following text must start a word. For example, “\&lt;book”
                finds “bookmark” but not “checkbook”.
            </td>
        </tr>
        <tr class="even">
            <td>
                \xXXXX
            </td>
            <td>
                <p>
                    A backslash followed by a lowercase x followed by a four-digit hexadecimal number
                </p>
                <p>
                    (XXXX) finds the character whose Unicode (ASCII) value is the same as the four-digit hexadecimal
                    number.
                </p>
            </td>
        </tr>
        <tr class="odd">
            <td>
                \
            </td>
            <td>
                The backslash character followed by anything other than “n”, “t”, “&gt;”, “&lt;”, or “x” is used to
                specify the character that follows. For example, “\M” finds “M”. The primary purpose is to allow special
                wild characters to be found. For example, assume that I wanted to find any character preceded by a “+”.
                Well, the “+” is a special character so I need to precede it with a “\”. Use “.\+” to find any character
                preceding a “+” character.
            </td>
        </tr>
        <tr class="even">
            <td>
                &amp;
            </td>
            <td>
                The ampersand is used in the replace text to add the found characters. In Listing 368, the ampersand is
                used to surround all bold text with “{{“ and “}}”.
            </td>
        </tr>
        <tr class="odd">
            <td>
                [abc123]
            </td>
            <td>
                Match any character that is between square brackets. For example, “t[ex]+t” finds “text”, “teet”, and
                “txeeet”; to name a few examples of what it finds.
            </td>
        </tr>
        <tr class="even">
            <td>
                [a-e]
            </td>
            <td>
                <p>
                    The minus sign is used to define a range when used inside of square brackets. For example, “[a-e]”
                    matches characters between “a” and “e” and “[a-ex-z]” matches characters between “a” and “e” or
                </p>
                <p>
                    “x” and “z”.
                </p>
            </td>
        </tr>
        <tr class="odd">
            <td>
                [^a-e]
            </td>
            <td>
                <p>
                    Placing a caret symbol inside square brackets will find anything but the specified characters.
                </p>
                <p>
                    For example, “[^a-e]” finds any character that is not between “a” and “e”.
                </p>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 18%" />
        <col style="width: 81%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Character</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                |
            </td>
            <td>
                Placing a vertical bar between two search strings will match what is before and also match what is
                after. For example, “bob|jean” matches the string “bob” and also matches the string “jean”.
            </td>
        </tr>
        <tr class="even">
            <td>
                {2}
            </td>
            <td>
                <p>
                    Placing a number between curly brackets finds that many occurrences of the previous character.
                </p>
                <p>
                    For example, “me{2}t” matches “meet”, and “[0-9]{3}” matches any three-digit number. Note that
                </p>
                <p>
                    “[0-9]{3}” will also find the first three digits of a number with more than three digits, unless
                    “find whole words” is also specified.
                </p>
            </td>
        </tr>
        <tr class="odd">
            <td>
                {1,2}
            </td>
            <td>
                Placing two numbers separated by a comma between curly brackets finds the preceding character a variable
                number of times. For example, “[0-9]{1,4}” finds any number that contains between one and four digits.
            </td>
        </tr>
        <tr class="even">
            <td>
                ( )
            </td>
            <td>
                <p>
                    Text placed within parentheses is treated as a reference. The text “\1” finds the first reference,
                    “\2” finds the second reference, and so on. For example, “([0-9]{3})-[0-9]
                </p>
                <p>
                    {2}-\1” finds “123-45-123” but not “123-45-678”.
                </p>
                <p>
                    Parentheses can also be used for grouping. For example, “(he|she|me)$” finds any paragraph that ends
                    with “he”, “she”, or “me”.
                </p>
            </td>
        </tr>
        <tr class="odd">
            <td>
                [:digit:]
            </td>
            <td>
                Finds a single-digit number. For example, “[:digit:]?” finds a single-digit number and “[:digit:]+”
                finds any number with one or more digits.
            </td>
        </tr>
        <tr class="even">
            <td>
                [:space:]
            </td>
            <td>
                Finds any white space, such as spaces and tabs.
            </td>
        </tr>
        <tr class="odd">
            <td>
                [:print:]
            </td>
            <td>
                Finds any printable characters.
            </td>
        </tr>
        <tr class="even">
            <td>
                [:cntrl:]
            </td>
            <td>
                Finds any non-printing characters.
            </td>
        </tr>
        <tr class="odd">
            <td>
                [:alnum:]
            </td>
            <td>
                Finds any alphanumeric characters (numbers and text characters).
            </td>
        </tr>
        <tr class="even">
            <td>
                [:alpha:]
            </td>
            <td>
                Finds any alphabetic characters, both uppercase and lowercase.
            </td>
        </tr>
        <tr class="odd">
            <td>
                [:lower:]
            </td>
            <td>
                Finds any lowercase characters if “Match case” is selected in the Options area.
            </td>
        </tr>
        <tr class="even">
            <td>
                [:upper:]
            </td>
            <td>
                Finds any uppercase characters if “Match case” is selected in the Options area.
            </td>
        </tr>
    </tbody>
</table>
<h2 id="text-content">
    <em>Text content</em>
</h2>
<blockquote>
    <p>
        The primary purpose of a Writer document is to contain simple text. The text is stored and enumerated by
        paragraphs. When a paragraph enumerates content, each enumerated section uses the same set of properties. In
        general, text content must be created by the document that will contain the content. After creation, the text
        content is inserted into the document at a specified location. Paragraphs, however, are not specifically created
        and then inserted (see Listing 333 near the beginning of this chapter). Paragraph text is inserted as a string
        and new paragraphs are inserted as control characters (see Table 123). More complicated text content is
        typically added using the insertTextContent() object method (see Listing 334). There are other, less-used
        methods to insert text content—for example, pasting content from the clipboard (see Listing 381 later in this
        chapter) and inserting an entire document (see Listing 369).
    </p>
    <p>
        <em><strong>Listing 369.</strong> Insert a document at a text cursor.</em>
    </p>
    <p>
        oCursor.insertDocumentFromURL(sFileURL, Array())
    </p>
    <p>
        Most text content is named and accessible in a similar way (see <strong>Table 137</strong>). The most popular
        content type in Table 137 is undoubtedly text tables.
    </p>
    <p>
        <em><strong>Table 137.</strong> Content contained in a text document.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 33%" />
        <col style="width: 33%" />
        <col style="width: 33%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Content Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Mechanism</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Access Method</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                Footnotes
            </td>
            <td>
                Index Access
            </td>
            <td>
                getFootnotes()
            </td>
        </tr>
        <tr class="even">
            <td>
                Endnotes
            </td>
            <td>
                Index Access
            </td>
            <td>
                getEndnotes()
            </td>
        </tr>
        <tr class="odd">
            <td>
                Reference marks
            </td>
            <td>
                Named Access
            </td>
            <td>
                getReferenceMarks()
            </td>
        </tr>
        <tr class="even">
            <td>
                Graphic objects
            </td>
            <td>
                Named Access
            </td>
            <td>
                getGraphicObjects()
            </td>
        </tr>
        <tr class="odd">
            <td>
                Embedded objects
            </td>
            <td>
                Named Access
            </td>
            <td>
                getEmbeddedObjects()
            </td>
        </tr>
        <tr class="even">
            <td>
                Text tables
            </td>
            <td>
                Named Access
            </td>
            <td>
                getTables()
            </td>
        </tr>
        <tr class="odd">
            <td>
                Bookmarks
            </td>
            <td>
                Named Access
            </td>
            <td>
                getBookmarks()
            </td>
        </tr>
        <tr class="even">
            <td>
                Style families
            </td>
            <td>
                Named Access
            </td>
            <td>
                getStyleFamilies()
            </td>
        </tr>
        <tr class="odd">
            <td>
                Document indexes
            </td>
            <td>
                Index Access
            </td>
            <td>
                getDocumentIndexes()
            </td>
        </tr>
        <tr class="even">
            <td>
                Text fields
            </td>
            <td>
                Enumeration Access
            </td>
            <td>
                getTextFields()
            </td>
        </tr>
        <tr class="odd">
            <td>
                Text field masters
            </td>
            <td>
                Named Access
            </td>
            <td>
                getTextFieldMasters()
            </td>
        </tr>
        <tr class="even">
            <td>
                Text frames
            </td>
            <td>
                Named Access
            </td>
            <td>
                getTextFrames()
            </td>
        </tr>
        <tr class="odd">
            <td>
                Text sections
            </td>
            <td>
                Named Access
            </td>
            <td>
                getTextSections()
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <strong>TIP</strong> Content accessible using named access also provides indexed access.
    </p>
</blockquote>
<h2 id="text-tables">
    <em>Text tables</em>
</h2>
<blockquote>
    <p>
        Writer documents act as a text-tables supplier, so you can directly retrieve text tables from Writer documents.
        Although text tables are enumerated as text content along with paragraphs (see Listing 336), tables are more
        typically obtained by name or by index (see <strong>Listing 370</strong> and <strong>Figure 94</strong>).
    </p>
    <p>
        <em><strong>Listing 370.</strong> Demonstrate enumerating text tables.</em>
    </p>
    <p>
        Sub EnumrateAllTextTables
    </p>
    <p>
        Dim oTables 'All of the text tables Dim s$ 'Work string
    </p>
    <p>
        Dim i% 'Index variable
    </p>
    <p>
        oTables = ThisComponent.TextTables REM First, access the tables based on index. s = "Tables By Index" &amp;
        CHR$(10)
    </p>
    <p>
        For i = 0 To oTables.getCount() - 1
    </p>
    <p>
        s = s &amp; "Table " &amp; (i+1) &amp; " = " &amp; oTables(i).Name &amp; CHR$(10)
    </p>
    <p>
        Next
    </p>
    <p>
        s = s &amp; CHR$(10) &amp; CHR$(10) &amp; "Text Tables By Name" &amp; CHR$(10) s = s &amp;
        Join(oTables.getElementNames(), CHR$(10))
    </p>
    <p>
        MsgBox s, 0, "Tables" End Sub
    </p>
    <p>
        <img src="media/image1.jpeg" style="width:1.53875in;height:1.91812in" />
    </p>
    <p>
        <em><strong>Figure 94.</strong> Tables contained in a document, by index and named access.</em>
    </p>
    <p>
        <strong>TIP</strong> Most named text content is retrieved, created, inserted, and disposed of in the same way.
        Learn to do this using tables and you’ll be ready to use other named text content—bookmarks, for example.
    </p>
    <p>
        As with most text content, tables must be created by the document before they are inserted into the document.
        The macro in Listing 371 inserts a table named “SampleTable” if it does not exist, and removes it if it does.
    </p>
    <p>
        <em><strong>Listing 371.</strong> Insert then delete a text table.</em>
    </p>
    <p>
        Sub InsertDeleteTable
    </p>
    <p>
        Dim oTable 'Newly created table to insert Dim oTables 'All of the text tables
    </p>
    <p>
        Dim oInsertPoint 'Where the table will be inserted Dim sTableName as String
    </p>
    <p>
        sTableName = "SampleTable" oTables = ThisComponent.TextTables
    </p>
    <p>
        If oTables.hasByName(sTableName) Then oTable = oTables.getByName(sTableName)
    </p>
    <p>
        REM Although this seems like the correct way to remove text content, REM what if the table is not inserted into
        the primary document's REM text object? oTable.dispose() may be safer to use.
    </p>
    <p>
        ThisComponent.Text.removeTextContent(oTable) Else
    </p>
    <p>
        REM Let the document create the text table.
    </p>
    <p>
        oTable = ThisComponent.createInstance( "com.sun.star.text.TextTable") oTable.initialize(2, 3) 'Two rows, three
        columns
    </p>
    <p>
        REM If there is a bookmark named "InsertTableHere", then insert REM the table at that point. If this bookmark
        does not exist, REM then simply choose the very end of the document.
    </p>
    <p>
        If ThisComponent.getBookmarks().hasByName("InsertTableHere") Then oInsertPoint =_
    </p>
    <p>
        ThisComponent.getBookmarks().getByName("InsertTableHere").getAnchor()
    </p>
    <p>
        Else
    </p>
    <p>
        oInsertPoint = ThisComponent.Text.getEnd()
    </p>
    <p>
        End If
    </p>
    <p>
        REM Now insert the text table at the end of the document. REM Note that the text object from the oInsertPoint
        text REM range is used rather than the document text object.
    </p>
    <p>
        oInsertPoint.getText().insertTextContent(oInsertPoint , oTable, False)
    </p>
    <p>
        REM The setData() object method works ONLY with numerical data.
    </p>
    <p>
        REM The setDataArray() object method, however, also allows strings. oTable.setDataArray(Array(Array(0, "One",
        2), Array(3, "Four", 5))) oTable.setName(sTableName)
    </p>
    <p>
        End If End Sub
    </p>
    <p>
        <strong>TIP</strong> In general, it is better to set table properties before inserting the table into the
        document. This prevents screen flicker as the object is modified and then redrawn on the screen. Due to a bug in
        OOo 1.1.0, if Listing 371 is modified to set the data before inserting the table, the table name is modified and
        it contains
    </p>
    <p>
        an extra garbage character at the end. Be warned, however, that some text content, such as text field masters,
        cannot change their names after they have been inserted into a document.
    </p>
    <p>
        The macro in Listing 371 demonstrates many useful techniques:
    </p>
</blockquote>
<ul>
    <li>
        <p>
            A named text content is found and obtained. Notice that finding the table and the bookmark are very similar
            processes.
        </p>
    </li>
    <li>
        <p>
            A bookmark is used.
        </p>
    </li>
    <li>
        <p>
            A text table is created, initialized, and inserted at a location marked by a bookmark.
        </p>
    </li>
    <li>
        <p>
            Text content is deleted.
        </p>
    </li>
    <li>
        <p>
            A table is initialized with data.
        </p>
    </li>
    <li>
        <p>
            The table name is set.
        </p>
    </li>
</ul>
<h1 id="using-the-correct-text-object">
    Using the correct text object
</h1>
<blockquote>
    <p>
        It is very important that you use the correct text object. It is possible that the text object in a text section
        or table cell is not the same as the text object returned by the document. Each text range is associated with a
        specific text object. Attempting to use object methods from one text object to operate on a text range
        associated with a different text object causes an error. In Listing 371, a table is removed, with the single
        line shown in <strong>Listing 372</strong>.
    </p>
    <p>
        <em><strong>Listing 372.</strong> What if the table is not contained in the document’s text object?</em>
    </p>
    <p>
        ThisComponent.Text.removeTextContent(oTable)
    </p>
    <p>
        The code in Listing 372 assumes that the table is contained in the document’s text object. If the table is not
        contained in the primary document’s text object, the code in Listing 372 will fail. Although Listing 372 will
        rarely fail, it will undoubtedly fail at the worst possible time. The macro works because the sample document
        was designed so that the table is inserted into the primary document’s text object. Either solution shown in
        Listing 373 may be a better solution for deleting the table.
    </p>
    <p>
        <em><strong>Listing 373.</strong> Two safe methods to delete the table.</em>
    </p>
    <p>
        oTable.getAnchor().getText().removeTextContent(oTable) oTable.dispose()
    </p>
    <p>
        The second time that a text object is used in Listing 371, it is obtained from the anchor returned from a
        bookmark—this is safe.
    </p>
    <p>
        <em><strong>Listing 374.</strong> A safe way to get a text object.</em>
    </p>
    <p>
        oInsertPoint.getText().insertTextContent(oInsertPoint , oTable, False)
    </p>
    <p>
        If the text range oInsertPoint is not contained in the document’s text object, attempting to insert the table
        using the document’s text object will fail. Only you can decide how careful you need to be when accessing text
        objects. Consider the selected text framework. What text object is used to create text cursors and to compare
        text cursors? Can you make the code more robust?
    </p>
</blockquote>
<h1 id="methods-and-properties">
    Methods and properties
</h1>
<blockquote>
    <p>
        The methods supported by text tables are very similar to the methods supported by spreadsheets contained in Calc
        documents (see Chapter 15, “Calc Documents”). Table 138 summarizes the object methods supported by text tables.
    </p>
    <p>
        <em><strong>Table 138.</strong> Object methods supported by text tables.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 39%" />
        <col style="width: 60%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                autoFormat(name)
            </td>
            <td>
                Apply the specified auto-format name to the table.
            </td>
        </tr>
        <tr class="even">
            <td>
                createCursorByCellName(name)
            </td>
            <td>
                XTextTableCursor positioned at the specified cell.
            </td>
        </tr>
        <tr class="odd">
            <td>
                createSortDescriptor()
            </td>
            <td>
                Array of PropertyValues that specify the sort criteria.
            </td>
        </tr>
        <tr class="even">
            <td>
                dispose()
            </td>
            <td>
                Destroy a text object, which also removes it from the document.
            </td>
        </tr>
        <tr class="odd">
            <td>
                getAnchor()
            </td>
            <td>
                Return a text range identifying where the table is anchored. This method allows text content to be added
                easily before or after a text table.
            </td>
        </tr>
        <tr class="even">
            <td>
                getCellByName(name)
            </td>
            <td>
                Return an XCell based on the cell name, such as “B3”.
            </td>
        </tr>
        <tr class="odd">
            <td>
                getCellByPosition(col, row)
            </td>
            <td>
                Numbering starts at zero. This has difficulties with complex tables.
            </td>
        </tr>
        <tr class="even">
            <td>
                getCellNames()
            </td>
            <td>
                String array of cell names contained in the table.
            </td>
        </tr>
        <tr class="odd">
            <td>
                getCellRangeByName(name)
            </td>
            <td>
                XCellRange based on cell name, such as A1:B4. Fails if the name identifies a cell that has been split.
            </td>
        </tr>
        <tr class="even">
            <td>
                getCellRangeByPosition(left, top, right, bottom)
            </td>
            <td>
                XCellRange based on numeric range.
            </td>
        </tr>
        <tr class="odd">
            <td>
                getColumnDescriptions()
            </td>
            <td>
                Array of strings describing the columns. Fails for complex tables.
            </td>
        </tr>
        <tr class="even">
            <td>
                getColumns()
            </td>
            <td>
                XTableColumns object enumerates columns by index. Also supports insertByIndex(idx, count) and
                removeByIndex(idx, count).
            </td>
        </tr>
        <tr class="odd">
            <td>
                getData()
            </td>
            <td>
                Get numerical data as a nested sequence of values (arrays in an array). Fails for complex tables.
            </td>
        </tr>
        <tr class="even">
            <td>
                getDataArray()
            </td>
            <td>
                Same as getData() but may contain String or Double.
            </td>
        </tr>
        <tr class="odd">
            <td>
                getName()
            </td>
            <td>
                Get the table name as a string.
            </td>
        </tr>
        <tr class="even">
            <td>
                getRowDescriptions()
            </td>
            <td>
                Array of strings describing the rows. Fails for complex tables.
            </td>
        </tr>
        <tr class="odd">
            <td>
                getRows()
            </td>
            <td>
                XTableRows object enumerates rows by index. Also supports insertByIndex(idx, count) and
                removeByIndex(idx, count).
            </td>
        </tr>
        <tr class="even">
            <td>
                initialize(rows, cols)
            </td>
            <td>
                Set the numbers of rows and columns. Must be done before the table is
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 39%" />
        <col style="width: 60%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
            </td>
            <td>
                inserted (see Listing 334).
            </td>
        </tr>
        <tr class="even">
            <td>
                setColumnDescriptions(string())
            </td>
            <td>
                Set the column descriptions from an array of strings.
            </td>
        </tr>
        <tr class="odd">
            <td>
                setData(Double())
            </td>
            <td>
                Set numerical data as a nested sequence of values. Fails for complex tables.
            </td>
        </tr>
        <tr class="even">
            <td>
                setDataArray(array())
            </td>
            <td>
                Same as setData() but may contain String or Double.
            </td>
        </tr>
        <tr class="odd">
            <td>
                setName(name)
            </td>
            <td>
                Set the table name.
            </td>
        </tr>
        <tr class="even">
            <td>
                setRowDescriptions(string())
            </td>
            <td>
                Set the row descriptions from an array of strings.
            </td>
        </tr>
        <tr class="odd">
            <td>
                sort(array())
            </td>
            <td>
                Sort the table based on a sort descriptor.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Text table objects also support a variety of properties (see Table 139). Text tables support many of the same
        properties that are supported by paragraphs (see Table 126).
    </p>
    <p>
        <em><strong>Table 139.</strong> Properties supported by the com.sun.star.text.TextTable service.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 24%" />
        <col style="width: 75%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                BreakType
            </td>
            <td>
                Specify the type of break that is applied at the start of the table (see the BreakType attribute in
                Table 126).
            </td>
        </tr>
        <tr class="even">
            <td>
                LeftMargin
            </td>
            <td>
                Specify the left table margin in 0.01 mm as a Long Integer. Set the HoriOrient property to something
                other than FULL.
            </td>
        </tr>
        <tr class="odd">
            <td>
                RightMargin
            </td>
            <td>
                Specify the right table margin in 0.01 mm as a Long Integer. Set the HoriOrient property to something
                other than FULL.
            </td>
        </tr>
        <tr class="even">
            <td>
                HoriOrient
            </td>
            <td>
                <p>
                    Specify the horizontal orientation using the com.sun.star.text.HoriOrientation constants. The
                    default value is com.sun.star.text.HoriOrientation.FULL.
                </p>
                <ul>
                    <li>
                        <p>
                            NONE = 0 – No alignment is applied.
                        </p>
                    </li>
                    <li>
                        <p>
                            RIGHT = 1 – The object is aligned at the right side.
                        </p>
                    </li>
                    <li>
                        <p>
                            CENTER = 2 – The object is aligned at the middle.
                        </p>
                    </li>
                    <li>
                        <p>
                            LEFT = 3 – The object is aligned at the left side.
                        </p>
                    </li>
                    <li>
                        <p>
                            INSIDE = 4 – (Not yet supported)
                        </p>
                    </li>
                    <li>
                        <p>
                            OUTSIDE = 5 – (Not yet supported)
                        </p>
                    </li>
                    <li>
                        <p>
                            FULL = 6 – The object uses the full space (for text tables only).
                        </p>
                    </li>
                    <li>
                        <p>
                            LEFT_AND_WIDTH = 7 – The left offset and the width of the object are defined.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                KeepTogether
            </td>
            <td>
                If True, prevents page or column breaks between this table and the following paragraph or text table.
            </td>
        </tr>
        <tr class="even">
            <td>
                Split
            </td>
            <td>
                If False, the table will not split across two pages.
            </td>
        </tr>
        <tr class="odd">
            <td>
                PageDescName
            </td>
            <td>
                If this string is set, a page break occurs before the paragraph, and the new page uses the given page
                style name (see PageDescName in Table 126).
            </td>
        </tr>
        <tr class="even">
            <td>
                PageNumberOffset
            </td>
            <td>
                If a page break occurs, specify a new page number (see PageNumberOffset in Table 126).
            </td>
        </tr>
        <tr class="odd">
            <td>
                RelativeWidth
            </td>
            <td>
                Specify the width of the table relative to its environment as a Short Integer.
            </td>
        </tr>
        <tr class="even">
            <td>
                IsWidthRelative
            </td>
            <td>
                If True, the relative width is valid.
            </td>
        </tr>
        <tr class="odd">
            <td>
                RepeatHeadline
            </td>
            <td>
                If True, the first row of the table is repeated on every new page.
            </td>
        </tr>
        <tr class="even">
            <td>
                ShadowFormat
            </td>
            <td>
                Specify the type, color, and size of the shadow (see ParaShadowFormat in Table 126).
            </td>
        </tr>
        <tr class="odd">
            <td>
                TopMargin
            </td>
            <td>
                Specify the top table margin in 0.01 mm as a Long Integer.
            </td>
        </tr>
        <tr class="even">
            <td>
                BottomMargin
            </td>
            <td>
                Specify the bottom table margin in 0.01 mm as a Long Integer.
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 24%" />
        <col style="width: 75%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                BackTransparent
            </td>
            <td>
                If True, the background color is transparent.
            </td>
        </tr>
        <tr class="even">
            <td>
                Width
            </td>
            <td>
                Specify the absolute table width as a Long Integer—this is a read-only property.
            </td>
        </tr>
        <tr class="odd">
            <td>
                ChartRowAsLabel
            </td>
            <td>
                If True, the first row is treated as axis labels if a chart is created.
            </td>
        </tr>
        <tr class="even">
            <td>
                ChartColumnAsLabel
            </td>
            <td>
                If True, the first column is treated as axis labels if a chart is created.
            </td>
        </tr>
        <tr class="odd">
            <td>
                TableBorder
            </td>
            <td>
                <p>
                    Specify the table borders in a com.sun.star.table.TableBorder structure. The structure contains
                    numerous complicated properties:
                </p>
                <ul>
                    <li>
                        <p>
                            The properties TopLine, BottomLine, LeftLine, RightLine, HorizontalLine, and VerticalLine
                            are all structures of type BorderLine as described by the LeftBorder property in Table 126.
                        </p>
                    </li>
                    <li>
                        <p>
                            The Distance property contains the distance between the lines and other contents.
                        </p>
                    </li>
                    <li>
                        <p>
                            You can turn each border property on or off by setting one of the following properties to
                            True or False: IsTopLineValid, IsBottomLineValid, IsLeftLineValid, IsRightLineValid,
                            IsHorizontalLineValid, IsVerticalLineValid, and IsDistanceValid.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                TableColumnSeparators
            </td>
            <td>
                <p>
                    Specify the width of each column with an array of table column separators. Each separator is a
                    com.sun.star.text.TableColumnSeparator structure.
                </p>
                <ul>
                    <li>
                        <p>
                            Position is a Short Integer that defines the position of a cell separator.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsVisible determines if the separator is visible.
                        </p>
                    </li>
                </ul>
                <p>
                    The width of a cell is defined by the position of the separator between adjacent cells. When two
                    cells are merged, the separator is hidden, not removed.
                </p>
                <p>
                    The Position values are relative to the text table TableColumnRelativeSum property. This property is
                    valid for a table only if every row has the same structure. If they do not, obtain the separators
                    from the individual row objects.
                </p>
            </td>
        </tr>
        <tr class="odd">
            <td>
                TableColumnRelativeSum
            </td>
            <td>
                Specify the sum of the column-width values used in TableColumnSeparators as a Short Integer.
            </td>
        </tr>
        <tr class="even">
            <td>
                BackColor
            </td>
            <td>
                Specify the paragraph background color as a Long Integer.
            </td>
        </tr>
        <tr class="odd">
            <td>
                BackGraphicURL
            </td>
            <td>
                Specify the URL of the paragraph background graphic.
            </td>
        </tr>
        <tr class="even">
            <td>
                BackGraphicFilter
            </td>
            <td>
                Specify the name of the graphic filter for the paragraph background graphic.
            </td>
        </tr>
        <tr class="odd">
            <td>
                BackGraphicLocation
            </td>
            <td>
                Specify the position of a background graphic (see ParaBackGraphicLocation in Table 126).
            </td>
        </tr>
    </tbody>
</table>
<h1 id="simple-and-complex-tables">
    Simple and complex tables
</h1>
<blockquote>
    <p>
        Simply speaking, a text table is a set of rows and columns of text. All of the tables in this book are
        represented using simple text tables. OOo supports both simple and complex tables. A simple table contains no
        merged or split cells; the table cells are laid out in a simple grid (see <strong>Table 140</strong>). Each
        column is labeled alphabetically starting with the letter A, and each row is labeled numerically starting with
        the number 1. The object method getCellByName() uses this name to return the specified cell. A similar object
        method, getCellByPosition(), returns the cell based on the column and row number. The column and row number are
        zero-based numbers, so requesting (1, 2) returns the cell named “B3”.
    </p>
    <p>
        <em><strong>Table 140.</strong> Simple table with the cell names labeled.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 25%" />
        <col style="width: 25%" />
        <col style="width: 25%" />
        <col style="width: 24%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                A1
            </th>
            <th>
                B1
            </th>
            <th>
                C1
            </th>
            <th>
                D1
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                A2
            </td>
            <td>
                B2
            </td>
            <td>
                C2
            </td>
            <td>
                D2
            </td>
        </tr>
        <tr class="even">
            <td>
                A3
            </td>
            <td>
                B3
            </td>
            <td>
                C3
            </td>
            <td>
                D3
            </td>
        </tr>
        <tr class="odd">
            <td>
                A4
            </td>
            <td>
                B4
            </td>
            <td>
                C4
            </td>
            <td>
                D4
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Use getRows() to obtain the rows from the text table. The returned rows object is useful to determine how many
        rows are present, retrieving, inserting, and deleting rows.
    </p>
    <p>
        <em><strong>Table 141.</strong> Main access methods supported by a table rows object.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 32%" />
        <col style="width: 67%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                getByIndex
            </td>
            <td>
                Retrieve a specific row.
            </td>
        </tr>
        <tr class="even">
            <td>
                getCount
            </td>
            <td>
                Number of rows in the table.
            </td>
        </tr>
        <tr class="odd">
            <td>
                hasElements
            </td>
            <td>
                Determine if there are any rows in the table.
            </td>
        </tr>
        <tr class="even">
            <td>
                insertByIndex
            </td>
            <td>
                Add rows to the table.
            </td>
        </tr>
        <tr class="odd">
            <td>
                removeByIndex
            </td>
            <td>
                Remove rows from the table.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Although it is easy to enumerate individual rows, a row is not useful for obtaining the cells that it contains.
        An individual row object is primarily used as follows:
    </p>
</blockquote>
<ul>
    <li>
        <blockquote>
            <p>
                Set the row height using the Height attribute.
            </p>
        </blockquote>
    </li>
    <li>
        <blockquote>
            <p>
                Set IsAutoHeight to true so that the rows height is automatically adjusted.
            </p>
        </blockquote>
    </li>
    <li>
        <blockquote>
            <p>
                Set IsSplitAllowed to false so that a row can not be split at a page boundary.
            </p>
        </blockquote>
    </li>
    <li>
        <blockquote>
            <p>
                Modify the TableColumnSeparators to change column widths.
            </p>
        </blockquote>
    </li>
</ul>
<blockquote>
    <p>
        Use getColumns() to obtain the columns from the text table. The columns object supports the same methods as the
        rows object. It is not possible, however, to obtain a specific column from a column object; the method
        getByIndex() exists, but it returns null. Although I expected to set a column width by obtaining a specific
        column and setting the width, you need to modify the table column separators available from the row object.
    </p>
    <p>
        A complex text table is a text table that is not simple. More accurately, a complex text table contains cells
        that have been split, or merged. To demonstrate a complex text table, start with <em>Table 140</em> and perform
        the following tasks:
    </p>
</blockquote>
<ol type="1">
    <li>
        <blockquote>
            <p>
                Right click in cell A2 and choose Cell &gt; Split &gt; Horizontal. Cell A2 becomes two cells. From a
                cell naming perspective, a new third row is inserted that contains one column. At this point, the API
                indicates that there are five rows and four columns.
            </p>
        </blockquote>
    </li>
</ol>
<blockquote>
    <p>
        <em><strong>Table 142.</strong> Split cell A2 horizontally.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 19%" />
        <col style="width: 27%" />
        <col style="width: 27%" />
        <col style="width: 24%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                A1
            </th>
            <th>
                B1
            </th>
            <th>
                C1
            </th>
            <th>
                D1
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                A2
            </td>
            <td rowspan="2">
                B2
            </td>
            <td rowspan="2">
                C2
            </td>
            <td rowspan="2">
                D2
            </td>
        </tr>
        <tr class="even">
            <td>
                (A3)
            </td>
        </tr>
        <tr class="odd">
            <td>
                A3=&gt;A4
            </td>
            <td>
                B3=&gt;B4
            </td>
            <td>
                C3=&gt;C4
            </td>
            <td>
                D3=&gt;D4
            </td>
        </tr>
        <tr class="even">
            <td>
                A4=&gt;A5
            </td>
            <td>
                B4=&gt;B5
            </td>
            <td>
                C4=&gt;C5
            </td>
            <td>
                D4=&gt;D5
            </td>
        </tr>
    </tbody>
</table>
<ol start="2" type="1">
    <li>
        <blockquote>
            <p>
                Right click in cell B2 and choose Cell &gt; Split &gt; Vertical. Cell B2 becomes two distinct cells, B2
                and C2; a new column appears to have been inserted at cell B2. The API still indicates that there are
                five rows and four columns.
            </p>
        </blockquote>
    </li>
</ol>
<blockquote>
    <p>
        <em><strong>Table 143.</strong> Split cell B2 vertically..</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 19%" />
        <col style="width: 13%" />
        <col style="width: 13%" />
        <col style="width: 27%" />
        <col style="width: 24%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                A1
            </th>
            <th colspan="2">
                B1
            </th>
            <th>
                C1
            </th>
            <th>
                D1
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                A2
            </td>
            <td rowspan="2">
                B2
            </td>
            <td rowspan="2">
                (C2)
            </td>
            <td rowspan="2">
                C2=&gt;D2
            </td>
            <td rowspan="2">
                D2=&gt;E2
            </td>
        </tr>
        <tr class="even">
            <td>
                A3
            </td>
        </tr>
        <tr class="odd">
            <td>
                A4
            </td>
            <td colspan="2">
                B4
            </td>
            <td>
                C4
            </td>
            <td>
                D4
            </td>
        </tr>
        <tr class="even">
            <td>
                A5
            </td>
            <td colspan="2">
                B5
            </td>
            <td>
                C5
            </td>
            <td>
                D5
            </td>
        </tr>
    </tbody>
</table>
<ol start="3" type="1">
    <li>
        <blockquote>
            <p>
                Select cells A4 and B4, right click and choose Cell &gt; Merge.
            </p>
        </blockquote>
    </li>
</ol>
<blockquote>
    <p>
        <em><strong>Table 144.</strong> Complex table after merging cells in the same row.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 19%" />
        <col style="width: 13%" />
        <col style="width: 13%" />
        <col style="width: 27%" />
        <col style="width: 24%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                A1
            </th>
            <th colspan="2">
                B1
            </th>
            <th>
                C1
            </th>
            <th>
                D1
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                A2
            </td>
            <td rowspan="2">
                B2
            </td>
            <td rowspan="2">
                C2
            </td>
            <td rowspan="2">
                D2
            </td>
            <td rowspan="2">
                E2
            </td>
        </tr>
        <tr class="even">
            <td>
                A3
            </td>
        </tr>
        <tr class="odd">
            <td colspan="3">
                A4, (B4) =&gt; A4
            </td>
            <td>
                C4=&gt;B4
            </td>
            <td>
                D4=&gt;C4
            </td>
        </tr>
        <tr class="even">
            <td>
                A5
            </td>
            <td colspan="2">
                B5
            </td>
            <td>
                C5
            </td>
            <td>
                D5
            </td>
        </tr>
    </tbody>
</table>
<ol start="4" type="1">
    <li>
        <blockquote>
            <p>
                Select cells B4 and C5, right click and choose Cell &gt; Merge. Cell C5 just goes away.
            </p>
        </blockquote>
    </li>
</ol>
<blockquote>
    <p>
        <em><strong>Table 145.</strong> Split cell B2 vertically..</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 19%" />
        <col style="width: 13%" />
        <col style="width: 13%" />
        <col style="width: 27%" />
        <col style="width: 24%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                A1
            </th>
            <th colspan="2">
                B1
            </th>
            <th>
                C1
            </th>
            <th>
                D1
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                A2
            </td>
            <td rowspan="2">
                B2
            </td>
            <td rowspan="2">
                C2
            </td>
            <td rowspan="2">
                D2
            </td>
            <td rowspan="2">
                E2
            </td>
        </tr>
        <tr class="even">
            <td>
                A3
            </td>
        </tr>
        <tr class="odd">
            <td colspan="3">
                A4
            </td>
            <td rowspan="2">
                B4, (C5)=&gt;B4
            </td>
            <td>
                C4
            </td>
        </tr>
        <tr class="even">
            <td>
                A5
            </td>
            <td colspan="2">
                B5
            </td>
            <td>
                D5
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <strong>TIP</strong> Not all object methods work with complex tables. For example, the object methods getData()
        and setData() cause an exception for complex tables, which makes sense.
    </p>
    <p>
        Although the object method getCellByName() works as expected for complex tables, getCellByPosition() is not able
        to return all of the cells because it allows only a column and a row number. Use the getCellNames() object
        method to return the names of the cells in a table (see Listing 375); you can then use the cell names to
        individually obtain each cell in the table.
    </p>
    <p>
        <em><strong>Listing 375.</strong> Join the array of strings to print the cell names in a table.</em>
    </p>
    <p>
        MsgBox Join(oTable.getCellNames(), "|")
    </p>
    <p>
        Place the text cursor in a text table and run the following macro to set the text in each cell to the text name;
        this modifies the text table and erases all existing text.
    </p>
    <p>
        <em><strong>Listing 376.</strong> Set the text of each cell to contain the cell's name.</em>
    </p>
    <p>
        Sub SetCellNames Dim oTable
    </p>
    <p>
        Dim sNames
    </p>
    <p>
        Dim i As Integer
    </p>
    <p>
        oTable = ThisComponent.currentController.ViewCursor.TextTable If IsNull(oTable) Then
    </p>
    <p>
        Exit Sub End If
    </p>
    <p>
        sNames = oTable.getCellNames()
    </p>
    <p>
        For i = LBound(sNames) To UBound(sNames) oTable.getCellByName(sNames(i)).setString(sNames(i))
    </p>
    <p>
        Next End Sub
    </p>
</blockquote>
<h1 id="tables-contain-cells">
    Tables contain cells
</h1>
<blockquote>
    <p>
        The cells in a text table are very versatile objects capable of holding all types of data. The cell objects
        implement both the XText interface (see Table 123 near the beginning of this chapter) as well as the XCell
        interface (see Table 146).
    </p>
    <p>
        <strong>TIP</strong> Tables are able to create a text table cursor with methods and properties specifically
        designed to traverse and select cells, and each individual cell is able to produce a text cursor that is local
        to the cell text object.
    </p>
    <p>
        <em><strong>Table 146.</strong> Methods defined by the com.sun.star.table.XCell interface.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 22%" />
        <col style="width: 77%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                getFormula()
            </td>
            <td>
                <blockquote>
                    <p>
                        The original string typed into the cell, even if it is not a formula.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                setFormula(String)
            </td>
            <td>
                <blockquote>
                    <p>
                        Set the cell’s formula. Use setString() from the XText interface to set text.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                getValue()
            </td>
            <td>
                <blockquote>
                    <p>
                        Floating-point (Double) value of the cell.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                setValue(Double)
            </td>
            <td>
                <blockquote>
                    <p>
                        Set the floating-point value of the cell.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                getType()
            </td>
            <td>
                <blockquote>
                    <p>
                        Return a com.sun.star.table.CellContentType enumeration with valid values of EMPTY, VALUE, TEXT,
                        and FORMULA.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                getError()
            </td>
            <td>
                Long Integer error value. If the cell is not a formula, the error value is zero.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Each cell object posses numerous properties. These properties are generally familiar because they are used in
        other objects. For example, the BackColor, BackGraphicFilter, BackGraphicLocation, BackGraphicURL,
        BackTransparent, BorderDistance, BottomBorder, BottomBorderDistance, LeftBorder, LeftBorderDistance,
        RightBorder, RightBorderDistance, TopBorder, and TopBorderDistance properties are defined for text tables in
        Table 139 and/or paragraph properties in Table 126. One of the more useful properties that is available only in
        the cell object, however, is CellName. This is useful to determine the location of the current cursor. The macro
        in Listing 377 demonstrates a few new manipulations for tables.
    </p>
    <p>
        The text tables, rows, columns, and cells all support the BackColor property. Listing 377 sets the background
        color of the first row to a light gray, which is commonly used to mark headings.
    </p>
    <p>
        The insertByIndex(index, num) object method is used to insert new rows at the end of a table. Rows can also be
        inserted into the middle or at the start of a table.
    </p>
    <p>
        Individual cells are retrieved by name; both numeric values and strings are set. Notice that strings are set
        using setString() rather than setFormula().
    </p>
    <p>
        <strong>TIP</strong> Although the Web-based OOo documentation makes no distinction between cells contained in
        text tables and cells contained in spreadsheets, the two cell types do not support the same property set. For
        example, the CellStyle, CellBackColor, and RotateAngle properties are not supported in a text document.
    </p>
    <p>
        <em><strong>Listing 377.</strong> Simple text table manipulations.</em>
    </p>
    <p>
        Sub SimpleTableManipulations
    </p>
    <p>
        Dim oTable 'Newly created table to insert Dim oTables 'All of the text tables
    </p>
    <p>
        Dim oInsertPoint 'Where the table will be inserted Dim sTableName as String
    </p>
    <p>
        sTableName = "SampleTable" oTables = ThisComponent.TextTables
    </p>
    <p>
        REM Remove the table if it exists! If oTables.hasByName(sTableName) Then
    </p>
    <p>
        ThisComponent.Text.removeTextContent(oTables.getByName(sTableName)) End If
    </p>
    <p>
        REM Let the document create the text table.
    </p>
    <p>
        oTable = ThisComponent.createInstance( "com.sun.star.text.TextTable") oTable.initialize(4, 3) 'Two rows, three
        columns
    </p>
    <p>
        REM If there is a bookmark named "InsertTableHere", then insert REM the table at that point. If this bookmark
        does not exist, REM then simply choose the very end of the document.
    </p>
    <p>
        If ThisComponent.getBookmarks().hasByName("InsertTableHere") Then oInsertPoint =_
    </p>
    <p>
        ThisComponent.getBookmarks().getByName("InsertTableHere").getAnchor()
    </p>
    <p>
        Else
    </p>
    <p>
        oInsertPoint = ThisComponent.Text.getEnd()
    </p>
    <p>
        End If
    </p>
    <p>
        oInsertPoint.getText().insertTextContent(oInsertPoint , oTable, False)
    </p>
    <p>
        oTable.setDataArray(Array(Array("Name", "Score", "Test"),_ Array("Bob", 80, "CCW"), Array("Andy", 80, "CCW"),_
    </p>
    <p>
        Array("Jean", 100, "CCI")))
    </p>
    <p>
        oTable.setName(sTableName)
    </p>
    <p>
        REM Set the first row to have a gray background. oTable.getRows().getByIndex(0).BackColor = RGB(235, 235, 235)
    </p>
    <p>
        REM removeByIndex uses the same arguments as insertByIndex, namely REM the index at which to insert or remove
        followed by the number REM of rows to insert or remove. The following line inserts
    </p>
    <p>
        REM one row at index 4. oTable.getRows().insertByIndex(4, 1)
    </p>
    <p>
        REM Obtain the individual cells and set the values. oTable.getCellByName("A5").setString("Whil")
        oTable.getCellByName("B5").setValue(100) oTable.getCellByName("C5").setString("Advanced")
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h1 id="using-a-table-cursor">
    Using a table cursor
</h1>
<blockquote>
    <p>
        Although text table cursors implement methods specific to traversing text tables, they are not significantly
        different from their text cursor counterparts in general functionality. You can select and manipulate ranges of
        cells, and set cell properties.
    </p>
    <p>
        <strong>TIP</strong> You cannot obtain a text table from the document and then simply insert it again at another
        location. So, how do you copy a text table? See Listing 381.
    </p>
    <p>
        Like text cursors, text table cursor movement methods accept a Boolean argument that indicates if the current
        selection should be expanded (True) or if the cursor should simply be moved (False). The movement methods also
        return a Boolean value indicating if the movement was successful. Table 147 contains the methods defined by the
        XTextTableCursor interface.
    </p>
    <p>
        <em><strong>Table 147.</strong> Methods defined by the com.sun.star.text.XTextTableCursor interface.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 29%" />
        <col style="width: 70%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Method</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                getRangeName()
            </td>
            <td>
                Return the cell range selected by this cursor as a string. For example, “B3:D5”.
            </td>
        </tr>
        <tr class="even">
            <td>
                gotoCellByName(String, boolean)
            </td>
            <td>
                Move the cursor to the cell with the specified name; return Boolean.
            </td>
        </tr>
        <tr class="odd">
            <td>
                goLeft(n, boolean)
            </td>
            <td>
                Move the cursor left n cells; return Boolean.
            </td>
        </tr>
        <tr class="even">
            <td>
                goRight(n, boolean)
            </td>
            <td>
                Move the cursor right n cells; return Boolean.
            </td>
        </tr>
        <tr class="odd">
            <td>
                goUp(n, boolean)
            </td>
            <td>
                Move the cursor up n cells; return Boolean.
            </td>
        </tr>
        <tr class="even">
            <td>
                goDown(n, boolean)
            </td>
            <td>
                Move the cursor down n cells; return Boolean.
            </td>
        </tr>
        <tr class="odd">
            <td>
                gotoStart(boolean)
            </td>
            <td>
                Move the cursor to the top left cell.
            </td>
        </tr>
        <tr class="even">
            <td>
                gotoEnd(boolean)
            </td>
            <td>
                Move the cursor to the bottom right cell.
            </td>
        </tr>
        <tr class="odd">
            <td>
                mergeRange()
            </td>
            <td>
                Merge the selected range of cells; return True for success.
            </td>
        </tr>
        <tr class="even">
            <td>
                splitRange(n, boolean)
            </td>
            <td>
                Create n (an integer) new cells in each cell selected by the cursor. For the Boolean, specify True to
                split horizontally, False for vertically. Returns True on success.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Text table cursors are used to split and merge table cells. In general, I consider this to be the primary use of
        a text table cursor. You can use text table cursors to move around the table by using the methods in Table 147.
        The macro in Listing 378 obtains the table cell names, creates a cell cursor that contains the first table cell,
        and then moves the cursor to the last cell in the table. A cell range is created based on the range name, and
        then the entire table is selected by the current controller.
    </p>
    <p>
        <em><strong>Listing 378.</strong> Select an entire table using a cursor. This may fail for a complex table.</em>
    </p>
    <p>
        oCellNames = oTable.getCellNames()
    </p>
    <p>
        oCursor = oTable.createCursorByCellName(oCellNames(0)) oCursor.gotoCellByName(oCellNames(UBound(oCellNames())),
        True)
    </p>
    <p>
        oRange = oTable.getCellRangeByName(oCursor.getRangeName()) 'This may fail!
        Thiscomponent.getCurrentController.select(oRange)
    </p>
    <p>
        Listing 378 demonstrates how to select all cells in a table by using a table cell cursor. You can then
        manipulate the entire table using the cursor. It may fail, however, in selecting the entire table in the current
        view. Table cell cursors have no problems with complex tables. The object methods supported by tables, however,
        do not all support complex tables. A notable example is the object method getCellRangeByName(), as used in
        Listing 378. This is very unfortunate because the view cursor is able to select text based on a cell range, but
        the table cannot return a cell range that has a split cell as one of the endpoints. For example, the cell range
        A1.2.1:C4 fails.
    </p>
    <p>
        There is no easy method to duplicate an entire text table. The clipboard has always been the solution of choice
        to copy general text (see Listing 381), but, if available, use transferable content instead (see Listing 382).
        First, use the view cursor or current controller to select the object that you want to copy. Then use a
        dispatcher to copy the object to the clipboard, move the view cursor where the object should be placed, and then
        use a dispatcher to paste the object from the clipboard.
    </p>
    <p>
        As you may have guessed, the difficult part in this process is selecting the table with the view cursor.
        Although numerous people have tried and failed to solve this problem, a brilliant solution was provided by Paolo
        Mantovani, a contributor on the OOo mailing lists. Paolo starts by noting that selecting an entire table with
        the current controller places the view cursor at the start of the first cell (see Listing 379).
    </p>
    <p>
        <em><strong>Listing 379.</strong> Place the cursor at the start of the first cell in the table.</em>
    </p>
    <p>
        ThisComponent.CurrentController.select(oTable)
    </p>
    <p>
        Although Listing 379 does not entirely solve the problem, it does provide a good start, because the view cursor
        is in the table at a known position. Paolo then provides a very succinct method to select the entire table (see
        Listing 380).
    </p>
    <p>
        <em><strong>Listing 380.</strong> Select the entire table in the current view.</em>
    </p>
    <p>
        ThisComponent.CurrentController.select(oTable) oVCursor.gotoEnd(True) 'Move to the end of the current cell
        oVCursor.gotoEnd(True) 'Move to the end of the table
    </p>
    <p>
        <strong>TIP</strong> Remember to carefully test all code dealing with tables. A different solution proposed by
        Paolo—which failed—was to use goRight() and then goDown() based on the number of rows and columns.
    </p>
    <p>
        The macro in Listing 381 selects a table by name, copies the table to the clipboard, and then pastes it at the
        end of the document.
    </p>
    <p>
        <em><strong>Listing 381.</strong> Copy a text table using the clipboard.</em>
    </p>
    <p>
        Sub CopyNamedTableToEndWithClipboard(sName As String) Dim oTable 'Table to copy
    </p>
    <p>
        Dim oText 'Document's text object
    </p>
    <p>
        Dim oFrame 'Current frame to use with the dispatcher Dim oVCursor 'Current view cursor
    </p>
    <p>
        Dim oDispatcher 'Dispatcher for clipboard commands
    </p>
    <p>
        oVCursor = ThisComponent.CurrentController.getViewCursor() oText = ThisComponent.getText()
    </p>
    <p>
        oFrame = ThisComponent.CurrentController.Frame
    </p>
    <p>
        oDispatcher = createUnoService("com.sun.star.frame.DispatchHelper")
    </p>
    <p>
        If NOT ThisComponent.getTextTables().hasByName(sName) Then MsgBox "Sorry, the document does not contain table "
        &amp; sName Exit Sub
    </p>
    <p>
        End If
    </p>
    <p>
        oTable = ThisComponent.getTextTables().getByName(sName) REM Place the cursor in the start of the first cell.
    </p>
    <p>
        REM This is very easy! ThisComponent.CurrentController.select(oTable) oVCursor.gotoEnd(True) 'Move to the end of
        the current cell. oVCursor.gotoEnd(True) 'Move to the end of the table.
    </p>
    <p>
        REM Copy the table to the clipboard. oDispatcher.executeDispatch(oFrame, ".uno:Copy", "", 0, Array())
    </p>
    <p>
        REM Move the cursor to the end of the document and then paste the table. oVCursor.gotoRange(oText.getEnd(),
        False) oDispatcher.executeDispatch(oFrame, ".uno:Paste", "", 0, Array())
    </p>
    <p>
        End Sub
    </p>
    <p>
        The clipboard is used by all applications so another application may modify the clipboard while the problem is
        running. The current controller provides access to the transferable content without using the clipboard.
    </p>
    <p>
        <em><strong>Listing 382.</strong> Copy a text table using transferable content.</em>
    </p>
    <p>
        Sub CopyNamedTableToEndUsingTransferable(sName As String) Dim oTable 'Table to copy
    </p>
    <p>
        Dim oText 'Document's text object Dim oVCursor 'Current view cursor Dim o 'Transferable content
    </p>
    <p>
        oVCursor = ThisComponent.CurrentController.getViewCursor() oText = ThisComponent.getText()
    </p>
    <p>
        If NOT ThisComponent.getTextTables().hasByName(sName) Then MsgBox "Sorry, the document does not contain table "
        &amp; sName Exit Sub
    </p>
    <p>
        End If
    </p>
    <p>
        oTable = ThisComponent.getTextTables().getByName(sName) REM Place the cursor in the start of the first cell.
    </p>
    <p>
        REM This is very easy! ThisComponent.CurrentController.select(oTable) oVCursor.gotoEnd(True) 'Move to the end of
        the current cell.
    </p>
    <p>
        oVCursor.gotoEnd(True) 'Move to the end of the table. o = ThisComponent.CurrentController.getTransferable()
    </p>
    <p>
        REM Move the cursor to the end of the document and then paste the table. oVCursor.gotoRange(oText.getEnd(),
        False) ThisComponent.CurrentController.insertTransferable(o)
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h1 id="formatting-a-text-table">
    Formatting a text table
</h1>
<blockquote>
    <p>
        I format text tables using paragraph styles, alternating the background color for each row, and by changing the
        cell borders.
    </p>
    <p>
        <em><strong>Listing 383.</strong> Format a text table.</em>
    </p>
    <p>
        Sub FormatTable(Optional oUseTable) Dim oTable
    </p>
    <p>
        Dim oCell
    </p>
    <p>
        Dim nRow As Long Dim nCol As Long
    </p>
    <p>
        If IsMissing(oUseTable) Then
    </p>
    <p>
        oTable = ThisComponent.CurrentController.getViewCursor().TextTable Else
    </p>
    <p>
        oTable = oUseTable End If
    </p>
    <p>
        If IsNull(oTable) OR IsEmpty(oTable) Then Print "FormatTable: No table specified" Exit Sub
    </p>
    <p>
        End If
    </p>
    <p>
        Dim v Dim x
    </p>
    <p>
        v = oTable.TableBorder
    </p>
    <p>
        x = v.TopLine : x.OuterLineWidth = 2
    </p>
</blockquote>
<table style="width:100%;" border="1">
    <colgroup>
        <col style="width: 81%" />
        <col style="width: 9%" />
        <col style="width: 9%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                v.TopLine = x
            </th>
            <th colspan="2">
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                x = v.LeftLine x.OuterLineWidth
            </td>
            <td>
                =
            </td>
            <td>
                2
            </td>
        </tr>
        <tr class="even">
            <td>
                v.LeftLine = x
            </td>
            <td>
            </td>
            <td>
            </td>
        </tr>
        <tr class="odd">
            <td>
                x = v.RightLine x.OuterLineWidth
            </td>
            <td>
                =
            </td>
            <td>
                2
            </td>
        </tr>
        <tr class="even">
            <td>
                v.RightLine = x
            </td>
            <td>
            </td>
            <td>
            </td>
        </tr>
        <tr class="odd">
            <td>
                x = v.TopLine x.OuterLineWidth
            </td>
            <td>
                =
            </td>
            <td>
                2
            </td>
        </tr>
        <tr class="even">
            <td>
                v.TopLine = x
            </td>
            <td>
            </td>
            <td>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        x = v.VerticalLine x.OuterLineWidth = 2 v.VerticalLine = x
    </p>
    <p>
        x = v.HorizontalLine
    </p>
    <p>
        x.OuterLineWidth = 0 v.HorizontalLine = x
    </p>
    <p>
        x = v.BottomLine x.OuterLineWidth = 2 v.BottomLine = x
    </p>
    <p>
        oTable.TableBorder = v
    </p>
    <p>
        For nRow = 0 To oTable.getRows().getCount() - 1
    </p>
    <p>
        For nCol = 0 To oTable.getColumns().getCount() - 1 oCell = oTable.getCellByPosition(nCol, nRow)
    </p>
    <p>
        If nRow = 0 Then oCell.BackColor = 128
    </p>
    <p>
        SetParStyle(oCell.getText(), "OOoTableHeader") Else
    </p>
    <p>
        SetParStyle(oCell.getText(), "OOoTableText")
    </p>
    <p>
        If nRow MOD 2 = 1 Then oCell.BackColor = -1
    </p>
    <p>
        Else
    </p>
    <p>
        REM color is (230, 230, 230)
    </p>
    <p>
        oCell.BackColor = 15132390 End If
    </p>
    <p>
        End If Next
    </p>
    <p>
        Next End Sub
    </p>
    <p>
        Each cell has its own text object. The following macro sets every paragraph in a text object to use the same
        paragraph style.
    </p>
    <p>
        <em><strong>Listing 384.</strong> Set the paragraph style for every paragraph in a text object.</em>
    </p>
    <p>
        Sub SetParStyle(oText, sParStyle As String) Dim oEnum
    </p>
    <p>
        Dim oPar
    </p>
    <p>
        oEnum = oText.createEnumeration() Do While oEnum.hasMoreElements()
    </p>
    <p>
        oPar = oEnum.nextElement()
    </p>
    <p>
        If opar.supportsService("com.sun.star.text.Paragraph") Then 'oPar.ParaConditionalStyleName = sParStyle
        oPar.ParaStyleName = sParStyle
    </p>
    <p>
        End If Loop
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h2 id="text-fields">
    <em>Text fields</em>
</h2>
<blockquote>
    <p>
        A text field is text content that is usually seamlessly inserted into the existing text, but the actual content
        comes from elsewhere—for example, the total number of pages or a database field. Table 148 lists the standard
        field types.
    </p>
    <p>
        <em><strong>Table 148.</strong> Text field services starting with com.sun.star.text.TextField.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 25%" />
        <col style="width: 74%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Field Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                Annotation
            </td>
            <td>
                Inserted note with string properties Author and Content. The property Date, of type
                com.sun.star.util.Date, contains the date that the note was created.
            </td>
        </tr>
        <tr class="even">
            <td>
                Author
            </td>
            <td>
                <blockquote>
                    <p>
                        Displays the document’s author. The following optional fields may be present:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            IsFixed – If False, the author is modified every time the document is saved.
                        </p>
                    </li>
                    <li>
                        <p>
                            Content – String content of the text field.
                        </p>
                    </li>
                    <li>
                        <p>
                            AuthorFormat – Constants from the com.sun.star.text.AuthorDisplayFormat constant group;
                            these have the values: FULL (0), LAST_NAME (1), FIRST_NAME (2), or INITIALS (3).
                        </p>
                    </li>
                    <li>
                        <p>
                            CurrentPresentation – String containing the current text of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            FullName – If False, the initials are displayed rather than the full name.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                Bibliography
            </td>
            <td>
                <blockquote>
                    <p>
                        Contains a property named Fields, which is an array of type PropertyValue. This field is
                        dependent on a Bibliography text field master.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                Chapter
            </td>
            <td>
                <p>
                    Chapter information. The Level property is a Byte integer. The ChapterFormat property is a constant
                    group of type com.sun.star.text.ChapterFormat with the following valid values: NAME (0), NUMBER (1),
                    NAME_NUMBER (2), NO_PREFIX_SUFFIX (3), or DIGIT
                </p>
                <blockquote>
                    <p>
                        (4).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CharacterCount
            </td>
            <td>
                <blockquote>
                    <p>
                        Indicates the number of characters in the document. This contains one property, NumberingType,
                        from the constant group com.sun.star.style.NumberingType; valid values are shown in Table 149.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CombinedCharacters
            </td>
            <td>
                <blockquote>
                    <p>
                        Displays one to six characters and treats them as one character.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ConditionalText
            </td>
            <td>
                <blockquote>
                    <p>
                        Displays text that changes based on a condition in the text field.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            TrueContent – String to use if the condition is True.
                        </p>
                    </li>
                    <li>
                        <p>
                            FalseContent – String to use if the condition is False.
                        </p>
                    </li>
                    <li>
                        <p>
                            Condition – String condition to evaluate.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsConditionTrue – Boolean result of the evaluation (read-only value).
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                DDE
            </td>
            <td>
                <blockquote>
                    <p>
                        Displays the result from a DDE connection. Uses a DDE text field master.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                Database
            </td>
            <td>
                <p>
                    Database text field used as a mail-merge field. This field depends on a text field master and
                    contains the following properties:
                </p>
                <ul>
                    <li>
                        <p>
                            Content – Merged database content as a String.
                        </p>
                    </li>
                    <li>
                        <p>
                            CurrentPresentation – Displays content as a String.
                        </p>
                    </li>
                    <li>
                        <p>
                            DataBaseFormat – If True, the database number display format is used.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberFormat – com.sun.star.util.NumberFormatter that formats the field.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                DatabaseName
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the database name when performing database operations (depends on a text field master)
                        with these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DataBaseName – String containing the database name.
                        </p>
                    </li>
                    <li>
                        <p>
                            DataCommandType – Constant group com.sun.star.sdb.CommandType specifies what DataTableName
                            supports: TABLE (0), QUERY(1), or COMMAND (2).
                        </p>
                    </li>
                    <li>
                        <p>
                            DataTableName – String containing the table name, query, or statement.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                DatabaseNextSet
            </td>
            <td>
                <blockquote>
                    <p>
                        Increment a selection (depends on a text field master) with these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DataBaseName – String name of the database.
                        </p>
                    </li>
                    <li>
                        <p>
                            DataCommandType – Constant group com.sun.star.sdb.CommandType specifies what DataTableName
                            supports: TABLE (0), QUERY(1), or COMMAND (2).
                        </p>
                    </li>
                    <li>
                        <p>
                            DataTableName – String containing the table name, query, or statement.
                        </p>
                    </li>
                    <li>
                        <p>
                            Condition – String that determines if the selection is advanced to the next position.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 25%" />
        <col style="width: 74%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Field Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                DatabaseNumberOfSet
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the current database set number (depends on a text field master) with these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DataBaseName – String name of the database.
                        </p>
                    </li>
                    <li>
                        <p>
                            DataCommandType – Constant group com.sun.star.sdb.CommandType specifies what DataTableName
                            supports: TABLE (0), QUERY(1), or COMMAND (2).
                        </p>
                    </li>
                    <li>
                        <p>
                            DataTableName – String containing the table name, query, or statement.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberingType – See Table 149 property for valid values.
                        </p>
                    </li>
                    <li>
                        <p>
                            SetNumber – Long Integer database set.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                DatabaseSetNumber
            </td>
            <td>
                <blockquote>
                    <p>
                        Set the database cursor selection (depends on a text field master) with these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DataBaseName – String name of the database.
                        </p>
                    </li>
                    <li>
                        <p>
                            DataCommandType – Constant group com.sun.star.sdb.CommandType specifies what DataTableName
                            supports: TABLE (0), QUERY(1), or COMMAND (2).
                        </p>
                    </li>
                    <li>
                        <p>
                            DataTableName – String containing the table name, query, or statement.
                        </p>
                    </li>
                    <li>
                        <p>
                            Condition – String condition that determines if the SetNumber is applied.
                        </p>
                    </li>
                    <li>
                        <p>
                            SetNumber – Long Integer set number to be applied.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                DateTime
            </td>
            <td>
                <blockquote>
                    <p>
                        Display a date or time with the following optional properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            IsFixed – If False, the current date or time is displayed.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsDate – If False, this is only a time. If True, this is a date with an optional time.
                        </p>
                    </li>
                    <li>
                        <p>
                            DateTimeValue – com.sun.star.util.DateTime object with the actual content.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberFormat – com.sun.star.util.NumberFormatter that formats the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            Adjust – Long Integer offset to the date or time in minutes.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixedLanguage – If False, setting the adjacent text language may change the field display.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                DropDown
            </td>
            <td>
                <blockquote>
                    <p>
                        Display a drop-down field with the following properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Name – Field name.
                        </p>
                    </li>
                    <li>
                        <p>
                            Items – Array of strings with the drop-down value.
                        </p>
                    </li>
                    <li>
                        <p>
                            SelectedItem – The selected item or an empty string if nothing is selected.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                EmbeddedObjectCount
            </td>
            <td>
                Display the number of objects embedded in the document. Contains the NumberingType property; see Table
                149 property for valid values.
            </td>
        </tr>
        <tr class="even">
            <td>
                ExtendedUser
            </td>
            <td>
                <p>
                    Display information for the user data (under Tools | Options | OpenOffice.org | User Data) such as
                    name, address, or phone number.
                </p>
                <ul>
                    <li>
                        <p>
                            Content – String content.
                        </p>
                    </li>
                    <li>
                        <p>
                            CurrentPresentation – String containing the current text of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixed – If False, the content is updated.
                        </p>
                    </li>
                    <li>
                        <p>
                            UserDataType – Specify what to display from the com.sun.star.text.UserDataPart constant
                            group: COMPANY, FIRSTNAME, NAME, SHORTCUT, STREET, COUNTRY, ZIP, CITY, TITLE, POSITION,
                            PHONE_PRIVATE, PHONE_COMPANY, FAX, EMAIL, STATE.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                FileName
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the document file name (URL). Contains the following properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            CurrentPresentation – String containing the current text of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            FileFormat – File name format com.sun.star.text.FilenameDisplayFormat constants with the
                            following values: FULL, PATH, NAME, and NAME_AND_EXT.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixed – If False, the content is updated.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 25%" />
        <col style="width: 74%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Field Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                GetExpression
            </td>
            <td>
                <p>
                    Display the result from a “SetExpression” text field. (use <strong>Insert &gt; Fields &gt;
                        Other</strong>, to open the Fields dialog, then navigate to the Cross-references tab).
                </p>
                <ul>
                    <li>
                        <p>
                            Content – String content.
                        </p>
                    </li>
                    <li>
                        <p>
                            CurrentPresentation – String containing the current text of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberFormat – com.sun.star.util.NumberFormatter that formats the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberingType – See Table 149 property for valid values.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsShowFormula – If True, the formula is displayed rather than the content.
                        </p>
                    </li>
                    <li>
                        <p>
                            SubType – Variable type from the com.sun.star.text.SetVariableType constants with the
                            following values: VAR, SEQUENCE, FORMULA, and STRING.
                        </p>
                    </li>
                    <li>
                        <p>
                            Value – Numerical (Double) value of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixedLanguage – If False, setting the adjacent text language may change the field display.
                        </p>
                    </li>
                </ul>
                <blockquote>
                    <p>
                        <em>A GetExpression field references a SetExpression field. If you delete the corresponding
                            SetExpression field, the CurrentPresentation says something like “Invalid reference”, but I
                            know of no other way to determine that the reference is no longer valid.</em>
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                GetReference
            </td>
            <td>
                <blockquote>
                    <p>
                        Reference field with these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            CurrentPresentation – String containing the current text of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            ReferenceFieldSource – com.sun.star.text.ReferenceFieldSource constant with the following
                            values: REFERENCE_MARK, SEQUENCE_FIELD, BOOKMARK, FOOTNOTE, or ENDNOTE.
                        </p>
                    </li>
                    <li>
                        <p>
                            SourceName – String reference name such as a bookmark name.
                        </p>
                    </li>
                    <li>
                        <p>
                            ReferenceFieldPart – com.sun.star.text.ReferenceFieldPart constant with the following
                            values: PAGE, CHAPTER, TEXT, UP_DOWN, PAGE_DESC, CATEGORY_AND_NUMBER, ONLY_CAPTION, and
                            ONLY_SEQUENCE_NUMBER.
                        </p>
                    </li>
                    <li>
                        <p>
                            SequenceNumber – Short integer sequence number used as sequence field or ReferenceId
                            property of a footnote or endnote.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                GraphicObjectCount
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the number of graphic objects embedded in the document. Contains the NumberingType
                        property; see Table 149 property for valid values.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                HiddenParagraph
            </td>
            <td>
                <p>
                    Allow a paragraph to be hidden. Used, for example, to create a test with the questions and answers
                    all in one document. Setting the answers to hidden allows the test questions to be printed for the
                    students.
                </p>
                <ul>
                    <li>
                        <p>
                            Condition – String condition to evaluate.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsHidden – Boolean result of the last evaluation of the condition.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                HiddenText
            </td>
            <td>
                <blockquote>
                    <p>
                        A field with hidden text. Differs from a hidden paragraph in that only the text in the field is
                        hidden, rather than the entire containing paragraph.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Content – String text content of the hidden text field.
                        </p>
                    </li>
                    <li>
                        <p>
                            Condition – String condition.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsHidden – Boolean result of the last evaluation of the condition.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                Input
            </td>
            <td>
                <blockquote>
                    <p>
                        Text input field.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Content – String text content of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            Hint – String hint text.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                InputUser
            </td>
            <td>
                <blockquote>
                    <p>
                        User-defined text field that depends on a field master.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Content – String text content of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            Hint – String hint text.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 25%" />
        <col style="width: 74%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Field Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                JumpEdit
            </td>
            <td>
                <blockquote>
                    <p>
                        Placeholder text field.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Hint – String hint text.
                        </p>
                    </li>
                    <li>
                        <p>
                            PlaceHolder – String text of the placeholder.
                        </p>
                    </li>
                    <li>
                        <p>
                            PlaceHolderType – com.sun.star.text.PlaceholderType constant with the following valid
                            values: TEXT, TABLE, TEXTFRAME, GRAPHIC, or OBJECT.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                Macro
            </td>
            <td>
                <blockquote>
                    <p>
                        Macro text field.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Hint – String hint text.
                        </p>
                    </li>
                    <li>
                        <p>
                            MacroName – String macro name to run.
                        </p>
                    </li>
                    <li>
                        <p>
                            MacroLibrary – String library name that contains the macro.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                PageCount
            </td>
            <td>
                Display the number of pages in the document. Contains the NumberingType property; see Table 149 property
                for valid values.
            </td>
        </tr>
        <tr class="even">
            <td>
                PageNumber
            </td>
            <td>
                <blockquote>
                    <p>
                        Display a page number.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Offset – Short Integer offset to show a different page number.
                        </p>
                    </li>
                    <li>
                        <p>
                            SubType – Which page is displayed from the com.sun.star.text.PageNumberType enumeration.
                            Valid values: PREV, CURRENT, or NEXT.
                        </p>
                    </li>
                    <li>
                        <p>
                            UserText – String that is displayed when the NumberingType is CHAR_SPECIAL.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberingType – See Table 149 property for valid values.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParagraphCount
            </td>
            <td>
                Display the number of paragraphs in the document. Contains the NumberingType property; see Table 149
                property for valid values.
            </td>
        </tr>
        <tr class="even">
            <td>
                ReferencePageGet
            </td>
            <td>
                Display the page number of a reference point. Contains the NumberingType property; see Table 149
                property for valid values.
            </td>
        </tr>
        <tr class="odd">
            <td>
                ReferencePageSet
            </td>
            <td>
                <blockquote>
                    <p>
                        Insert additional page numbers. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Offset – Short Integer that changes the displayed value of a ReferencePageGet field.
                        </p>
                    </li>
                    <li>
                        <p>
                            NameOn – If True, the ReferencePageGet text fields are displayed.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                Script
            </td>
            <td>
                <blockquote>
                    <p>
                        Display text obtained by running a script. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Content – Script text or URL of the script as a string.
                        </p>
                    </li>
                    <li>
                        <p>
                            ScriptType – String script type, such as JavaScript.
                        </p>
                    </li>
                    <li>
                        <p>
                            URLContent – If True, Content is a URL. If False, Content is the script text.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 25%" />
        <col style="width: 74%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Field Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                SetExpression
            </td>
            <td>
                <p>
                    An expression text field (use <strong>Insert &gt; Fields &gt; Other</strong>, to open the Fields
                    dialog, then navigate to the Variables tab). Contains these properties:
                </p>
                <ul>
                    <li>
                        <p>
                            Content – String content.
                        </p>
                    </li>
                    <li>
                        <p>
                            CurrentPresentation – String containing the current text of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberFormat – com.sun.star.util.NumberFormatter that formats the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberingType – See Table 149 property for valid values.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsShowFormula – If True, the formula is displayed rather than the content.
                        </p>
                    </li>
                    <li>
                        <p>
                            Hint – String hint used if this is an input field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsInput – If True, the field is an input field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsVisible – If True, the field is visible.
                        </p>
                    </li>
                    <li>
                        <p>
                            SequenceValue – Sequence value when this field is used as sequence field.
                        </p>
                    </li>
                    <li>
                        <p>
                            SubType – Variable type from the com.sun.star.text.SetVariableType constants with the
                            following values: VAR, SEQUENCE, FORMULA, and STRING.
                        </p>
                    </li>
                    <li>
                        <p>
                            Value – Numerical (Double) value of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            VariableName – Name of the associated set expression field master.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixedLanguage – If False, setting the adjacent text language may change the field display.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                TableCount
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the number of tables in the document. Contains the NumberingType property; see Table 149
                        property for valid values.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                TemplateName
            </td>
            <td>
                Display the name of the template used to create the document. Supports the FileFormat property as
                supported by the Filename property.
            </td>
        </tr>
        <tr class="even">
            <td>
                URL
            </td>
            <td>
                <blockquote>
                    <p>
                        Display a URL. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Format – Short Integer specifying the URL output format.
                        </p>
                    </li>
                    <li>
                        <p>
                            URL – String containing the unparsed original URL.
                        </p>
                    </li>
                    <li>
                        <p>
                            Representation – Display string shown to the user.
                        </p>
                    </li>
                    <li>
                        <p>
                            TargetFrame – String frame name where the URL will be opened.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                User
            </td>
            <td>
                <blockquote>
                    <p>
                        Display a user-defined field with a field master. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            IsShowFormula – If True, the formula is displayed rather than the content.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsVisible – If True, the field is visible.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberFormat – com.sun.star.util.NumberFormatter that formats the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixedLanguage – If False, setting the adjacent text language may change the field display.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                WordCount
            </td>
            <td>
                Display the number of words in the document. Contains the NumberingType property; see Table 149 property
                for valid values.
            </td>
        </tr>
        <tr class="odd">
            <td>
                docinfo.ChangeAuthor
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the name of the last author to modify the document.
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Author – String containing the name of the author.
                        </p>
                    </li>
                    <li>
                        <p>
                            CurrentPresentation – Current content of the text field as a String.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixed – If False, the content is updated when the document is saved.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 25%" />
        <col style="width: 74%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Field Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                docinfo.ChangeDateTime
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the date and time the document was last changed. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            CurrentPresentation – Current content of the text field as a String.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixed – If False, the current date or time is displayed.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsDate – If False, this is only a time. If True, this is a date with an optional time.
                        </p>
                    </li>
                    <li>
                        <p>
                            DateTimeValue – com.sun.star.util.DateTime object with the actual content.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberFormat – com.sun.star.util.NumberFormatter that formats the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixedLanguage – If False, setting the adjacent text language may change the field display.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                docinfo.CreateAuthor
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the name of the author who created the document (see docinfo.ChangeAuthor for supported
                        properties).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                docinfo.CreateDateTime
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the date and time the document was created (see docinfo.ChangeDateTime for supported
                        properties).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                docinfo.Custom
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the user-defined field in the document information; used to be docinfo.Info0.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                docinfo.Description
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the document description as contained in the document properties (File | Properties).
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            Content – String content.
                        </p>
                    </li>
                    <li>
                        <p>
                            CurrentPresentation – String containing the current text of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixed – If False, the content is updated when the document information is changed.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                docinfo.EditTime
            </td>
            <td>
                <p>
                    Display the duration the document has been edited. In other words, how long did it take to write?
                </p>
                <ul>
                    <li>
                        <p>
                            CurrentPresentation – String containing the current text of the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixed – If False, the date or time is always displayed as the current date or time.
                        </p>
                    </li>
                    <li>
                        <p>
                            DateTimeValue – Date and time as a Double.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberFormat – com.sun.star.util.NumberFormatter that formats the field.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsFixedLanguage – If False, setting the adjacent text language may change the field display.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                docinfo.Info0
            </td>
            <td>
                <blockquote>
                    <p>
                        Deprecated, use docinfo.Custom instead.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                docinfo.Info1
            </td>
            <td>
                <blockquote>
                    <p>
                        Deprecated, use docinfo.Custom instead.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                docinfo.Info2
            </td>
            <td>
                <blockquote>
                    <p>
                        Deprecated, use docinfo.Custom instead.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                docinfo.Info3
            </td>
            <td>
                <blockquote>
                    <p>
                        Deprecated, use docinfo.Custom instead.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                docinfo.Keywords
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the document info keywords (see docinfo.Description).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                docinfo.PrintAuthor
            </td>
            <td>
                Display the name of the author who printed the document (see docinfo.ChangeAuthor for supported
                properties).
            </td>
        </tr>
        <tr class="odd">
            <td>
                docinfo.PrintDateTime
            </td>
            <td>
                Display the time the document was last printed (see docinfo.ChangeDateTime for supported properties).
            </td>
        </tr>
        <tr class="even">
            <td>
                docinfo.Revision
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the current document revision (see docinfo.Description).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                docinfo.Subject
            </td>
            <td>
                <blockquote>
                    <p>
                        Display the document subject specified in the document information (see docinfo.Description).
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                docinfo.Title
            </td>
            <td>
                Display the document title specified in the document information (see docinfo.Description).
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <strong>TIP</strong> The Annotation field is a service of type com.sun.star.text.TextField.Annotation. Some
        sources of documentation show the text “textfield” in all lowercase letters; this is incorrect. The code in
        Listing 385 shows this correctly.
    </p>
    <p>
        Table 149 contains the valid values for the CharacterCount property from Table 148. Most API listings stop at
        CIRCLE_NUMBER=14, I do not know why.
    </p>
    <p>
        <em><strong>Table 149.</strong> Constants defined by com.sun.star.style.NumberingType.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 37%" />
        <col style="width: 62%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Constant</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                CHARS_UPPER_LETTER
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is in uppercase letters as “A, B, C, D, ...”.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CHARS_LOWER_LETTER
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is in lowercase letters as “a, b, c, d,...”.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ROMAN_UPPER
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is in Roman numbers with uppercase letters as “I, II, III, IV, ...”.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                ROMAN_LOWER
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is in Roman numbers with lowercase letters as “i, ii, iii, iv, ...”.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ARABIC
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is in Arabic numbers as “1, 2, 3, 4, ...”.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                NUMBER_NONE
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is invisible.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CHAR_SPECIAL
            </td>
            <td>
                <blockquote>
                    <p>
                        Use a character from a specified font.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                PAGE_DESCRIPTOR
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is specified in the page style.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                BITMAP
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is displayed as a bitmap graphic.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CHARS_UPPER_LETTER_N
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is in uppercase letters as “A, B, ..., Y, Z, AA, BB, CC, ... AAA, ...”.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CHARS_LOWER_LETTER_N
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering is in lowercase letters as “a, b, ..., y, z, aa, bb, cc, ... aaa, ...”.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                TRANSLITERATION
            </td>
            <td>
                <blockquote>
                    <p>
                        A transliteration module is used to produce numbers in Chinese, Japanese, etc.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                NATIVE_NUMBERING
            </td>
            <td>
                The native-number-supplier service is called to produce numbers in native languages.
            </td>
        </tr>
        <tr class="even">
            <td>
                FULLWIDTH_ARABIC
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering for full-width Arabic number.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CIRCLE_NUMBER
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Circle Number.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                NUMBER_LOWER_ZH
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering for Chinese lowercase numbers.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                NUMBER_UPPER_ZH
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering for Chinese uppercase numbers.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                NUMBER_UPPER_ZH_TW
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering for Traditional Chinese uppercase numbers.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                TIAN_GAN_ZH
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Chinese Tian Gan.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                DI_ZI_ZH
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Chinese Di Zi.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                NUMBER_TRADITIONAL_JA
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering for Japanese traditional numbers.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                AIU_FULLWIDTH_JA
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Japanese AIU full width.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                AIU_HALFWIDTH_JA
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Japanese AIU half width.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                IROHA_FULLWIDTH_JA
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Japanese IROHA full width.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                IROHA_HALFWIDTH_JA
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Japanese IROHA half width.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                NUMBER_UPPER_KO
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering for Korean uppercase numbers.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                NUMBER_HANGUL_KO
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering for Korean hangul numbers.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                HANGUL_JAMO_KO
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Korean Hangul Jamo.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 37%" />
        <col style="width: 62%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Constant</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                HANGUL_SYLLABLE_KO
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Korean Hangul Syllable.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                HANGUL_CIRCLED_JAMO_KO
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Korean Hangul Circled Jamo.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                HANGUL_CIRCLED_SYLLABLE_KO
            </td>
            <td>
                <blockquote>
                    <p>
                        Bullet for Korean Hangul Circled Syllable.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                CHARS_ARABIC
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering in Arabic alphabet letters.
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                CHARS_THAI
            </td>
            <td>
                <blockquote>
                    <p>
                        Numbering in Thai alphabet letters.
                    </p>
                </blockquote>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        The text fields contained in the document are available using the getTextFields() object method (see Table 137).
        Every text field object supports the object method getPresentation(boolean), which returns a string representing
        either the field type (True) or the displayed text (False). See <strong>Listing 385</strong> and <strong>Figure
            95</strong>.
    </p>
    <p>
        <em><strong>Listing 385.</strong> Display Fields.</em>
    </p>
    <p>
        Sub DisplayFields
    </p>
    <p>
        oEnum = ThisComponent.getTextFields().createEnumeration() Do While oEnum.hasMoreElements()
    </p>
    <p>
        oField = oEnum.nextElement()
    </p>
    <p>
        s = s &amp; oField.getPresentation(True) &amp; " = " 'Field type
    </p>
    <p>
        If oField.supportsService("com.sun.star.text.TextField.Annotation") Then REM More cryptic, I could use If
        oField.getPresentation(True) = "Note"... REM A "Note" has no displayed content so calling getPresentation(False)
        REM returns an empty string. Instead, obtain the author and the content. s = s &amp; oField.Author &amp; " says
        " &amp; oField.Content
    </p>
    <p>
        Else
    </p>
    <p>
        s = s &amp; oField.getPresentation(False) 'String content End If
    </p>
    <p>
        s = s &amp; CHR$(13) Loop
    </p>
    <p>
        MsgBox s, 0, "Text Fields" End Sub
    </p>
</blockquote>
<p>
    <img src="media/image2.jpeg" style="width:2.4294in;height:1.31104in" />
</p>
<blockquote>
    <p>
        <em><strong>Figure 95.</strong> Text fields in the current document.</em>
    </p>
    <p>
        The source document used to create Figure 95 contains a DateTime field, PageNumber fields, Annotation field, and
        a User field. The code in Listing 385 provides special treatment for note fields to display both the author and
        the note. The field is checked to see if it supports the Annotation service by using the supportsServiceObject()
        method.
    </p>
    <p>
        The primary method of finding a specific text field is by enumerating the text fields as shown in Listing 385.
        If the document is large and contains many text fields, it may take a long time to find a specific text field.
        If you know where the text field is located in the document, Listing 354 demonstrates how to find a text field
        by enumerating text content in a paragraph.
    </p>
    <p>
        <strong>TIP</strong> Text fields implement the object method update(). The update() method causes a text field
        to update itself with the most current information if it is applicable. For example, date/time, file name, and
        the document information text fields all update to the most current information.
    </p>
</blockquote>
<h1 id="text-master-fields">
    Text master fields
</h1>
<blockquote>
    <p>
        Some text fields contain their own content, and others rely on an external source to obtain the displayed
        information. The external source is called a master field. Table 150 lists the text field types that require a
        master field. Besides the properties shown in Table 150, every text field master also supports the properties
        shown in Table 151.
    </p>
    <p>
        <strong>TIP</strong> The object method getTextFieldMaster() returns a text field’s master field. Unfortunately,
        every field, even fields that do not have master fields, implements this method and returns a non-null master
        field. OOo may crash if you obtain and manipulate a master field from a field that does not contain one.
    </p>
    <p>
        Although text fields are accessible only by enumeration, master fields are accessible by name and enumeration
        (see Table 137). The name used for a master field is obtained by appending the field name to the field master
        type. For example, the User field “AndyField”, as shown in Figure 95, has a master field named
        com.sun.star.text.FieldMaster.User.AndyField. Database master fields are named differently than all of the other
        master fields; they append the DatabaseName, DatatableName, and DataColumnName to the service name. Listing 386
        demonstrates how to obtain the text field masters in a document. Figure 96 shows the results.
    </p>
    <p>
        <em><strong>Table 150.</strong> Text field services starting with com.sun.star.text.FieldMaster.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 16%" />
        <col style="width: 83%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Field Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                Bibliography
            </td>
            <td>
                <blockquote>
                    <p>
                        Field master to a Bibliography text field. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            IsNumberEntries – If True, the fields are numbered; otherwise, the short entry name is used.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsSortByPosition – If True, the bibliography index is sorted by the document position (see
                            SortKeys).
                        </p>
                    </li>
                    <li>
                        <p>
                            BracketBefore – The opening bracket displayed in the Bibliography text field.
                        </p>
                    </li>
                    <li>
                        <p>
                            BracketAfter – The closing bracket displayed in the Bibliography text field.
                        </p>
                    </li>
                    <li>
                        <p>
                            SortKeys – This array of PropertyValues is used if IsSortByPosition is False. The properties
                            are a sequence of the property SortKey (com.sun.star.text.BibliographyDataField constant
                            identifying the field to sort) and IsSortAscending (Boolean).
                        </p>
                    </li>
                    <li>
                        <p>
                            Locale – com.sun.star.lang.Locale of the field master.
                        </p>
                    </li>
                    <li>
                        <p>
                            SortAlgorithm – String containing the name of the sort algorithm used to sort the text
                            fields.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                DDE
            </td>
            <td>
                <blockquote>
                    <p>
                        Field master to a DDE text field. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DDECommandElement – DDE command as a string.
                        </p>
                    </li>
                    <li>
                        <p>
                            DDECommandFile – File string of the DDE command.
                        </p>
                    </li>
                    <li>
                        <p>
                            DDECommandType – DDE command type as a string.
                        </p>
                    </li>
                    <li>
                        <p>
                            IsAutomaticUpdate – If True, the DDE link is automatically updated.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 16%" />
        <col style="width: 83%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Field Type</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                Database
            </td>
            <td>
                <blockquote>
                    <p>
                        Field master to a Database text field. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            DataBaseName – String name of the data source.
                        </p>
                    </li>
                    <li>
                        <p>
                            CommandType – Long Integer CommandType (0 = table, 1 = query, 2 = statement).
                        </p>
                    </li>
                    <li>
                        <p>
                            DataTableName – Command string type is determined by the CommandType property.
                        </p>
                    </li>
                    <li>
                        <p>
                            DataColumnName – Database column name as a String.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="even">
            <td>
                SetExpression
            </td>
            <td>
                <blockquote>
                    <p>
                        Field master to a “set expression” text field. Contains these properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            ChapterNumberingLevel – Chapter number as a byte, if this is a number sequence.
                        </p>
                    </li>
                    <li>
                        <p>
                            NumberingSeparator – Numbering separator string, used if this is a number sequence.
                        </p>
                    </li>
                    <li>
                        <p>
                            SubType – Variable type from the com.sun.star.text.SetVariableType constants with the
                            following values: VAR, SEQUENCE, FORMULA, and STRING.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
        <tr class="odd">
            <td>
                User
            </td>
            <td>
                <blockquote>
                    <p>
                        Field master to a user text field. Contains the properties:
                    </p>
                </blockquote>
                <ul>
                    <li>
                        <p>
                            IsExpression – If True, the field contains an expression.
                        </p>
                    </li>
                    <li>
                        <p>
                            Value – Double value.
                        </p>
                    </li>
                    <li>
                        <p>
                            Content – Field content as a string.
                        </p>
                    </li>
                </ul>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <em><strong>Table 151.</strong> Properties defined by the service com.sun.star.text.FieldMaster.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 22%" />
        <col style="width: 77%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                Name
            </td>
            <td>
                Optional string with the field name; this must be set before the field is added to the document.
            </td>
        </tr>
        <tr class="even">
            <td>
                DependentTextFields
            </td>
            <td>
                Array of text fields that use this master field.
            </td>
        </tr>
        <tr class="odd">
            <td>
                InstanceName
            </td>
            <td>
                String instance name as it is used in the XTextFieldsSupplier.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <em><strong>Listing 386.</strong> Show text field masters.</em>
    </p>
    <p>
        Sub ShowFieldMasters
    </p>
    <p>
        Dim oMasters 'All of the text field masters
    </p>
    <p>
        Dim oMasterNames 'Array of the text field master names Dim i%, j% 'Index variables
    </p>
    <p>
        Dim sMasterName$ 'Full name of the master field Dim s$ 'Utility string
    </p>
    <p>
        Dim oMaster 'Master field
    </p>
    <p>
        REM Obtain the text field masters object. oMasters = ThisComponent.getTextFieldMasters()
    </p>
    <p>
        REM Obtain ALL of the text master field names. REM This is an array of strings.
    </p>
    <p>
        oMasterNames = oMasters.getElementNames()
    </p>
    <p>
        For i = LBound(oMasterNames) to UBound(oMasterNames)
    </p>
    <p>
        REM For a given name, obtain the master field,
    </p>
    <p>
        REM then look at the DependentTextFields property, REM which is an array of text fields that depend REM on this
        master field.
    </p>
    <p>
        sMasterName = oMasterNames(i)
    </p>
    <p>
        oMaster = oMasters.getByName(sMasterName)
    </p>
    <p>
        s = s &amp; "***" &amp; sMasterName &amp; "***" &amp; CHR$(10) s = s &amp; oMaster.Name &amp; " Contains "
        &amp;_
    </p>
    <p>
        CStr(UBound(oMaster.DependentTextFields) + 1) &amp;_ " dependent fields" &amp; CHR$(10)
    </p>
    <p>
        s = s &amp; CHR$(13) Next I
    </p>
    <p>
        REM Directly obtain a master field based on the name.
    </p>
    <p>
        REM This is a user field that I added to the source code file.
    </p>
    <p>
        If oMasters.hasByName("com.sun.star.text.FieldMaster.User.AndyField") Then
        oMaster=oMasters.getByName("com.sun.star.text.FieldMaster.User.AndyField") s = s &amp; "Directly obtained the
        field master " &amp; oMaster.Name &amp; CHR$(10) &amp;_
    </p>
    <p>
        "The field contains the text " &amp; oMaster.Content End If
    </p>
    <p>
        MsgBox s, 0, "Text Field Masters" End Sub
    </p>
</blockquote>
<p>
    <img src="media/image3.jpeg" style="width:3.40547in;height:2.77385in" />
</p>
<blockquote>
    <p>
        <em><strong>Figure 96.</strong> Text master fields in the current document.</em>
    </p>
</blockquote>
<h1 id="creating-and-adding-text-fields">
    Creating and adding text fields
</h1>
<blockquote>
    <p>
        Text fields must be created by the document that will contain them. It is also the document that will destroy
        them if you choose to remove them from the document. Listing 387 demonstrates the creation, configuration, and
        insertion of both a DateTime text field and an Annotation text field. The text fields are appended to the end of
        the document. The DateTime text field is formatted in an unusual manner, so a new number format style is created
        if it does not yet exist.
    </p>
    <p>
        <strong>TIP</strong> The very popular routine FindCreateNumberFormatStyle (see Listing 391) is used by Listing
        387.
    </p>
    <p>
        What is required to properly insert an annotation field has changed over time and may differ between AOO and LO.
        When OOo, inserting an annotation set the insertion date to the current time. My latest testing with LO 4.0.1.2
        does not set a date. In LO, there is a Date property, which seems to be ignored. To set the date, ou must set
        the DateTimeValue property instead. The insertion date/time must be set before the text field is inserted, the
        date/time cannot be changed after. I have not tested this particular macro with AOO.
    </p>
    <p>
        <em><strong>Listing 387.</strong> Insert text fields.</em>
    </p>
    <p>
        Sub InsertFields
    </p>
    <p>
        Dim oText 'Text object for the current document Dim oField 'Field to insert
    </p>
    <p>
        Dim oDoc 'oDoc is fewer characters than ThisComponent
    </p>
    <p>
        oDoc = ThisComponent oText = oDoc.Text
    </p>
    <p>
        REM Start by inserting a date time text field at the end of the REM document. Format the date time as "DD. MMM
        YYYY"
    </p>
    <p>
        REM Insert some explanatory text before the newly inserted field. oText.insertString(oText.getEnd(), "Today is
        ", FALSE)
    </p>
    <p>
        REM Create a date time field.
    </p>
    <p>
        oField = oDoc.createInstance("com.sun.star.text.TextField.DateTime") oField.IsFixed = TRUE
    </p>
    <p>
        oField.NumberFormat = FindCreateNumberFormatStyle("DD. MMMM YYYY", oDoc) oText.insertTextContent(oText.getEnd(),
        oField, False)
    </p>
    <p>
        REM Now, insert an Annotation after the inserted text field.
    </p>
    <p>
        REM Lie about the date and say that I did it a little while ago! Dim oDate As New com.sun.star.util.Date
    </p>
    <p>
        Dim oRightNow oRightNow = Now With oDate
    </p>
    <p>
        .Day = Day(oRightNow - 10)
    </p>
    <p>
        .Month = Month(oRightNow - 10)
    </p>
    <p>
        .Year = Year(oRightNow - 10) End With
    </p>
    <p>
        Dim oDT As New com.sun.star.util.DateTime With oDT
    </p>
    <p>
        .Day = Day(oRightNow - 10)
    </p>
    <p>
        .Month = Month(oRightNow - 10)
    </p>
    <p>
        .Year = Year(oRightNow - 10)
    </p>
    <p>
        .Hours = 4
    </p>
    <p>
        .Minutes = 5
    </p>
    <p>
        .Seconds = 6
    </p>
    <p>
        .HundredthSeconds = 0 End With
    </p>
    <p>
        REM Like most text content, the field must be created by the document REM that will contain it.
    </p>
    <p>
        REM In LO, setting the Date field does nothing.
    </p>
    <p>
        oField = oDoc.createInstance("com.sun.star.text.TextField.Annotation") With oField
    </p>
    <p>
        .Author = "AP"
    </p>
    <p>
        .Content = "This note is next to a date field that I just added"
    </p>
    <p>
        .Date = oDate
    </p>
    <p>
        .DateTimeValue = oDT End With
    </p>
    <p>
        oText.insertTextContent(oText.getEnd(), oField, False)
    </p>
    <p>
        MsgBox "Two fields inserted at the end of the document" End Sub
    </p>
    <p>
        Inserting a field that requires a text field master is slightly more difficult than inserting a regular text
        field. Both the master field and the dependent text field must be created by the document using the object
        method createInstance(). The master field must be named before it is used; after inserting a field into a
        document, you cannot change the name. The dependent field is attached to the master field, which provides the
        content to the dependent field. The dependent field, not the master field, is inserted as text content into the
        document. The dependent field can be removed from the document by using the removeTextContent() object method.
        To remove the master field, use the dispose() method of the master field.
    </p>
    <p>
        Listing 388 demonstrates the use of master fields by performing various operations on a master field named
        “TestField”. Three specific states are checked and appropriate behavior is taken as follows:
    </p>
    <p>
        If the master field does not exist, the master field and a dependent field are created and inserted into the
        document. The field is now visible by opening the Field dialog using Insert | Fields | Other and choosing the
        Variables tab.
    </p>
    <p>
        If the master field exists with a corresponding dependent field, the dependent field is removed from the
        document. The master field still exists, but no dependent field is inserted in the document. You can view the
        master field by using the Field dialog.
    </p>
    <p>
        If the master field exists and has no corresponding dependent field, the master field is removed by using the
        dispose() object method. The Field dialog no longer shows the master field.
    </p>
    <p>
        <em><strong>Listing 388.</strong> Insert field master.</em>
    </p>
    <p>
        Sub InsertFieldMaster
    </p>
    <p>
        Dim oMasters 'All of the text field masters
    </p>
    <p>
        Dim oText 'Text object for the current document Dim oUField 'User field to insert
    </p>
    <p>
        Dim oMField 'The master field for the user field
    </p>
    <p>
        Dim oDoc 'oDoc is fewer characters than ThisComponent Dim sLead$ 'Leading field name
    </p>
    <p>
        Dim sName$ 'Name of the field to remove or insert Dim sTotName$ 'The entire name
    </p>
    <p>
        REM Set the names. sName = "TestField"
    </p>
    <p>
        sLead = "com.sun.star.text.FieldMaster.User" sTotName = sLead &amp; "." &amp; sName
    </p>
    <p>
        REM Initialize some values. oDoc = ThisComponent
    </p>
    <p>
        oText = oDoc.Text
    </p>
    <p>
        oMasters = ThisComponent.getTextFieldMasters()
    </p>
    <p>
        REM If the master field already exists, then perform special handling. REM Special handling is for illustrative
        purposes only, not that it REM solves any particularly fun and exciting problem.
    </p>
    <p>
        If oMasters.hasByName(sTotName) Then
    </p>
    <p>
        REM Obtain the master field and the fields dependent on this field. oMField = oMasters.getByName(sTotName)
    </p>
    <p>
        REM If there are fields dependent on this field then REM the array of dependent fields has values!
    </p>
    <p>
        If UBound(oMField.DependentTextFields) &gt;= 0 Then
    </p>
    <p>
        REM Remove the text content and it disappears from the REM document. The master field still exists, however!
        oUField = oMField.DependentTextFields(0) oText.removeTextContent(oUField)
    </p>
    <p>
        MsgBox "Removed one instance from the document" Else
    </p>
    <p>
        REM I arbitrarily decided that I would destroy the master field REM but I could just as easily create a new user
        field and
    </p>
    <p>
        REM attach it to the existing master field and then insert REM the new field into the document.
    </p>
    <p>
        MsgBox "No instances in the document, disposing master field" oMField.content=""
    </p>
    <p>
        oMField.dispose() End If
    </p>
    <p>
        Else
    </p>
    <p>
        REM Create a User text field that requires a master field. oUField =
        oDoc.createInstance("com.sun.star.text.TextField.User")
    </p>
    <p>
        REM Now create the master field.
    </p>
    <p>
        Dim oMasterField
    </p>
    <p>
        oMasterField = oDoc.createInstance(sLead)
    </p>
    <p>
        REM You CANNOT change the name of a master field AFTER it is inserted REM into a document so you must set it
        now.
    </p>
    <p>
        oMasterField.Name = sName
    </p>
    <p>
        REM This is the data that will be displayed. Remember that the REM user field displays what the master tells it
        to display. oMasterField.Content = "Hello"
    </p>
    <p>
        REM A user field must be attached to a master field. REM The user field is now a "DependentTextField".
        oUField.attachTextFieldMaster(oMasterField)
    </p>
    <p>
        REM Insert the user field into the document. oText.insertTextContent(oText.getEnd(), oUField, False) MsgBox "One
        field inserted at the end of the document"
    </p>
    <p>
        End If End Sub
    </p>
</blockquote>
<h2 id="bookmarks">
    <em>Bookmarks</em>
</h2>
<blockquote>
    <p>
        A bookmark is text content that is accessible based on its name. A bookmark may encompass a text range or a
        single point. Listing 371 inserts text content at the point where a bookmark is anchored. Use the getString()
        object method to obtain the string contained in the bookmark. Use setString() to set the string contained in the
        bookmark. If the bookmark is merely a point, the text is merely inserted before the bookmark. When a created
        bookmark is inserted into the text, the insertion point determines the bookmark’s anchor position.
    </p>
    <p>
        <em><strong>Listing 389.</strong> Demonstrate how to add a bookmark.</em>
    </p>
    <p>
        Sub AddBookmark
    </p>
    <p>
        Dim oBookmark 'Created bookmark to add Dim oCurs 'Text cursor
    </p>
    <p>
        REM Create a text cursor that contains the last four characters REM in the document.
    </p>
    <p>
        oCurs = ThisComponent.Text.createTextCursor() oCurs.gotoEnd(False)
    </p>
    <p>
        oCurs.goLeft(4, True)
    </p>
    <p>
        REM Create the bookmark.
    </p>
    <p>
        oBookmark = ThisComponent.createInstance("com.sun.star.text.Bookmark")
    </p>
    <p>
        REM If the bookmark is not given a name, OOo will create a name. REM If the name already exists, a number is
        appended to the name. oBookmark.setName("Bobert")
    </p>
    <p>
        REM Because True is used, the bookmark contains the last four characters REM in the document. If False is used
        instead, then the bookmark
    </p>
    <p>
        REM contains no characters and it is positioned before the fourth character REM from the end of the document.
    </p>
    <p>
        ThisComponent.Text.insertTextContent(oCurs, oBookmark, False) End Sub
    </p>
</blockquote>
<h2 id="sequence-fields-references-and-formatting">
    <em>Sequence fields, references, and formatting</em>
</h2>
<blockquote>
    <p>
        Consider the caption for Listing 389. Ignoring formatting, enter the caption as follows:
    </p>
</blockquote>
<ol type="1">
    <li>
        <p>
            Enter the text “Listing ”.
        </p>
    </li>
    <li>
        <p>
            Use <strong>Insert &gt; Fields &gt; Other</strong> to open the Fields dialog.
        </p>
    </li>
    <li>
        <p>
            Select the Variables tab.
        </p>
    </li>
    <li>
        <p>
            Select the Number Range type .
        </p>
    </li>
    <li>
        <p>
            Enter <em>Listing</em> for name and Listing + 1 for the value.
        </p>
    </li>
    <li>
        <p>
            Click Insert.
        </p>
    </li>
    <li>
        <p>
            Enter the rest of the caption.
        </p>
    </li>
</ol>
<blockquote>
    <p>
        Sequence fields (number ranges) work well because they automatically renumber as captions are added and removed.
        A reference to a sequence field renumbers if the field itself changes value because a field is added or removed.
    </p>
    <p>
        I had a collection of documents containing hundreds of captions and references. Unfortunately, all captions and
        references were text as opposed to fields. I needed a macro to convert the text captions and references to use
        sequence fields and linked cross references.
    </p>
</blockquote>
<h1 id="formatting-numbers-and-dates">
    Formatting numbers and dates
</h1>
<blockquote>
    <p>
        Sequence fields can be formatted in many ways. Ultimately, the formatting is associated to a defined format
        string. OOo is configured to know many common number and date formats, and you can create new formats
    </p>
    <p>
        as you desire. Each number format is assigned a numeric ID. Things that format numbers and dates – such as
        fields and table cells – contain the numeric key for the formatting string used to display the contained value.
    </p>
</blockquote>
<h3 class="unnumbered" id="list-formats-known-to-the-current-document">
    <em>List formats known to the current document</em>
</h3>
<blockquote>
    <p>
        When you create a new number format, the format is stored in the current document. The supported numeric formats
        and the ID for a specific format will differ from document to document.
    </p>
    <p>
        <em><strong>Listing 390.</strong> List the formats in the current document.</em>
    </p>
    <p>
        Sub ListFormatsInCurrentDocument()
    </p>
    <p>
        Dim oDoc ' Document created to hold the format strings. Dim oFormats ' Formats in the current document.
    </p>
    <p>
        Dim oFormat ' Current format object.
    </p>
    <p>
        Dim oData ' Keys queried from the formats. Dim i% ' General index variable.
    </p>
    <p>
        Dim sFormat$ ' Current format string. Dim sPrevFormat$ ' Previous format string. Dim aLocale as new
        com.sun.star.lang.Locale
    </p>
    <p>
        oFormats = ThisComponent.getNumberFormats()
    </p>
    <p>
        ' Create an output document.
    </p>
    <p>
        oDoc = StarDesktop.loadComponentFromURL( "private:factory/swriter", "_blank", 0, Array() ) oData =
        oFormats.queryKeys(com.sun.star.util.NumberFormat.ALL, aLocale, False)
    </p>
    <p>
        For i = LBound(oData) To UBound(oData) oFormat=oFormats.getbykey(oData(i)) sFormat=oFormat.FormatString
    </p>
    <p>
        If sFormat&lt;&gt;sPrevFormat Then sPrevFormat=sFormat
    </p>
    <p>
        oDoc.getText().insertString(oDoc.getText().End, _
    </p>
    <p>
        CStr(oData(i)) &amp; CHR$(9) &amp; sFormat &amp; CHR$(10), False)
    </p>
    <p>
        End If Next
    </p>
    <p>
        End Sub
    </p>
</blockquote>
<h3 class="unnumbered" id="find-or-create-a-numeric-format.">
    <em>Find or create a numeric format.</em>
</h3>
<blockquote>
    <p>
        When a number format is added, it may be modified and stored in a slightly different format. QueryKey searches
        the internal modified query strings without first modifying the input string. The end result is that after
        storing a key queryKey will claim that the format string is not present. If you then dutifully, add the format
        string, an exception will be thrown because it already exists.
    </p>
</blockquote>
<ol type="1">
    <li>
        <p>
            Adding "#,##0.00_);[Red](#,##0.000)" stores "#,##0.00_);[RED](#,##0.000)"; red is converted to upper case
            (see <u>https://issues.apache.org/ooo/show_bug.cgi?id=72380</u>).
        </p>
    </li>
    <li>
        <p>
            While storing, "##0,0#\h" is changed to "##,00#\h".
        </p>
    </li>
</ol>
<blockquote>
    <p>
        The usual advice is to use a number format that does not change.
    </p>
    <p>
        Listing 391 returns the ID that identifies the specified format. The returned ID can be used to format a value.
        If you add a format and then the format is not available, make note of the format ID and use Listing 390 to
        display the formats in the modified form.
    </p>
    <p>
        <em><strong>Listing 391.</strong> Find or create a numeric format.</em>
    </p>
    <p>
        'sFormat – Format to find / create.
    </p>
    <p>
        'oDoc - Document to use. If omitted, the current document is used. 'locale - Locale to use. If omitted, the
        default locale is used.
    </p>
    <p>
        Function FindCreateNumberFormatStyle (sFormat$, Optional oDoc, Optional locale) Dim oDocument As Object
    </p>
    <p>
        Dim aLocale as new com.sun.star.lang.Locale Dim oFormats As Object
    </p>
    <p>
        Dim formatNum As Long
    </p>
    <p>
        oDocument = IIf(IsMissing(oDoc), ThisComponent, oDoc) oFormats = oDocument.getNumberFormats()
    </p>
    <p>
        'I could set the locale from values stored at <a
            href="http://www.ics.uci.edu/pub/ietf/http/related/iso639.txt">'http://www.ics.uci.edu/pub/ietf/http/related/iso639.txt</a>
        <a
            href="http://www.chemie.fu-berlin.de/diverse/doc/ISO_3166.html">'http://www.chemie.fu-berlin.de/diverse/doc/ISO_3166.html</a>
        'I use a NULL locale and let it use what ever it likes. 'First, see if the number format exists
    </p>
    <p>
        If ( Not IsMissing(locale)) Then aLocale = locale
    </p>
    <p>
        End If
    </p>
    <p>
        formatNum = oFormats.queryKey (sFormat, aLocale, TRUE) 'MsgBox "Current Format number is" &amp; formatNum
    </p>
    <p>
        'If the number format does not exist then add it If (formatNum = -1) Then
    </p>
    <p>
        formatNum = oFormats.addNew(sFormat, aLocale) If (formatNum = -1) Then formatNum = 0 'MsgBox "new Format number
        is " &amp; formatNum
    </p>
    <p>
        End If
    </p>
    <p>
        FindCreateNumberFormatStyle = formatNum End Function
    </p>
</blockquote>
<h3 class="unnumbered" id="default-formats">
    <em>Default formats</em>
</h3>
<blockquote>
    <p>
        It is possible to get formats of a specific type without manually specifying the format using the
        getStandardFormat method on the Formats object. Specify the desired format using the NumberFormat constant
        group. Consider this snippet to set cells in Calc to the local currency format:
    </p>
    <p>
        oFormats = oDoc.NumberFormats
    </p>
    <p>
        Dim aLocale As New com.sun.star.lang.Locale oRange = oSheet.getCellRangeByName("D2:F19") oRange.NumberFormat =
        oFormats.getStandardFormat(_
    </p>
    <p>
        com.sun.star.util.NumberFormat.CURRENCY, aLocale)
    </p>
    <p>
        <em><strong>Table 152.</strong> Constants for the com.sun.star.util.NumberFormat constant group.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 15%" />
        <col style="width: 35%" />
        <col style="width: 49%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Value</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Name</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                0
            </td>
            <td>
                ALL
            </td>
            <td>
                selects all number formats.
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                DEFINED
            </td>
            <td>
                selects only user-defined number formats.
            </td>
        </tr>
        <tr class="odd">
            <td>
                2
            </td>
            <td>
                DATE
            </td>
            <td>
                selects date formats.
            </td>
        </tr>
        <tr class="even">
            <td>
                4
            </td>
            <td>
                TIME
            </td>
            <td>
                selects time formats.
            </td>
        </tr>
        <tr class="odd">
            <td>
                8
            </td>
            <td>
                CURRENCY
            </td>
            <td>
                selects currency formats.
            </td>
        </tr>
        <tr class="even">
            <td>
                16
            </td>
            <td>
                NUMBER
            </td>
            <td>
                selects decimal number formats.
            </td>
        </tr>
        <tr class="odd">
            <td>
                32
            </td>
            <td>
                SCIENTIFIC
            </td>
            <td>
                selects scientific number formats.
            </td>
        </tr>
        <tr class="even">
            <td>
                64
            </td>
            <td>
                FRACTION
            </td>
            <td>
                selects number formats for fractions.
            </td>
        </tr>
    </tbody>
</table>
<table border="1">
    <colgroup>
        <col style="width: 15%" />
        <col style="width: 35%" />
        <col style="width: 49%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                128
            </th>
            <th>
                PERCENT
            </th>
            <th>
                selects percentage number formats.
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                256
            </td>
            <td>
                TEXT
            </td>
            <td>
                selects text number formats.
            </td>
        </tr>
        <tr class="even">
            <td>
                6
            </td>
            <td>
                DATETIME
            </td>
            <td>
                selects number formats which contain date and time.
            </td>
        </tr>
        <tr class="odd">
            <td>
                1024
            </td>
            <td>
                LOGICAL
            </td>
            <td>
                selects boolean number formats.
            </td>
        </tr>
        <tr class="even">
            <td>
                2048
            </td>
            <td>
                UNDEFINED
            </td>
            <td>
                is used as a return value if no format exists.
            </td>
        </tr>
    </tbody>
</table>
<h1 id="create-a-field-master">
    Create a field master
</h1>
<blockquote>
    <p>
        A <em>Listing</em> sequence field is associated to the com.sun.star.text.FieldMaster.SetExpression.Listing
        master field, which must exist before the sequence field can be used. Listing 392 Demonstrates how to create a
        master field if it does not exist, and how to get the master field if it does.
    </p>
    <p>
        <em><strong>Listing 392.</strong> Creating a master field.</em>
    </p>
    <p>
        oMasters = oDoc.getTextFieldMasters
    </p>
    <p>
        If NOT oMasters.hasByName("com.sun.star.text.FieldMaster.SetExpression.Listing") Then oMasterField =
        oDoc.createInstance("com.sun.star.text.FieldMaster.SetExpression") oMasterField.Name = "Listing"
    </p>
    <p>
        oMasterField.SubType = com.sun.star.text.SetVariableType.SEQUENCE Else
    </p>
    <p>
        oMasterField = oMasters.getByName("com.sun.star.text.FieldMaster.SetExpression.Listing") End If
    </p>
    <p>
        The master field sub-type determines the field type (see Table 153).
    </p>
    <p>
        <em><strong>Table 153.</strong> Constants for com.sun.star.text.SetVariableType.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 12%" />
        <col style="width: 54%" />
        <col style="width: 33%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Value</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Constant</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                0
            </td>
            <td>
                <blockquote>
                    <p>
                        com.sun.star.text.SetVariableType.VAR
                    </p>
                </blockquote>
            </td>
            <td>
                Simple variable.
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        com.sun.star.text.SetVariableType.SEQUENCE
                    </p>
                </blockquote>
            </td>
            <td>
                Number sequence field.
            </td>
        </tr>
        <tr class="odd">
            <td>
                2
            </td>
            <td>
                <blockquote>
                    <p>
                        com.sun.star.text.SetVariableType.FORMULA
                    </p>
                </blockquote>
            </td>
            <td>
                Formula field.
            </td>
        </tr>
        <tr class="even">
            <td>
                3
            </td>
            <td>
                <blockquote>
                    <p>
                        com.sun.star.text.SetVariableType.STRING
                    </p>
                </blockquote>
            </td>
            <td>
                String field.
            </td>
        </tr>
    </tbody>
</table>
<h1 id="insert-a-sequence-field">
    Insert a sequence field
</h1>
<blockquote>
    <p>
        The sequence field is created by the document, then the numbering type is set to arabic. The number format is
        set, the master field is associated to the field (the master field is a sequence field), and then the field
        content is set to increment the value (Listing + 1). Note that when the field is inserted, the field may not be
        immediately updated. Either wait for the field to update, or force an update using <strong>Tools &gt; Update
            &gt; Fields</strong>.
    </p>
    <p>
        <em><strong>Listing 393.</strong> Creating a set expression sequence field.</em>
    </p>
    <p>
        oField = oDoc.createInstance("com.sun.star.text.TextField.SetExpression") oField.NumberingType =
        com.sun.star.style.NumberingType.ARABIC oField.NumberFormat = FindCreateNumberFormatStyle("###0", oDoc)
        oField.attachTextFieldMaster(oMasterField)
    </p>
    <p>
        oField.Content = name &amp; " + 1"
    </p>
    <p>
        Constants used to set the numbering type are set as shown in the Table 149.
    </p>
</blockquote>
<h1 id="replace-text-with-a-sequence-field">
    Replace text with a sequence field
</h1>
<blockquote>
    <p>
        Finally, the main working macro to find the text and replace it with a sequence field. The location to insert
        the sequence field is found by searching for a regular expression. The regular expression "^Listing [:digit:]
    </p>
    <p>
        +\.[:space:]+" searches for a line that begins with the text “Listing”, followed by a space, one or more numeric
        digits, a period, and one or more spaces; for example, “Listing 12. ”.
    </p>
    <p>
        <em><strong>Listing 394.</strong> Replace text with sequence fields.</em>
    </p>
    <p>
        Function FindReplaceTextFields(oDoc, name$) As Integer
    </p>
    <p>
        Dim oDescriptor ' Search descriptor used to find the captions. Dim oFound ' Text matching the search descriptor.
    </p>
    <p>
        Dim oMasters ' Master fields in this document. Dim oMasterField ' The associated master field.
    </p>
    <p>
        Dim oFrame ' Documents main frame, used for dispatches. Dim oDispatcher ' Dispatcher object.
    </p>
    <p>
        Dim oCurs ' Text cursor used to insert text content. Dim oField ' Sequence field to insert.
    </p>
    <p>
        Dim formatNum&amp; ' ID (Key) for the format for the field. Dim i As Integer ' General index variable.
    </p>
    <p>
        'Assume that no text fields are inserted.
    </p>
    <p>
        FindReplaceTextFields = 0
    </p>
    <p>
        'What number format to use for the field.
    </p>
    <p>
        formatNum = FindCreateNumberFormatStyle("###0", oDoc)
    </p>
    <p>
        ' Create the master field if needed. oMasters = oDoc.getTextFieldMasters
    </p>
    <p>
        If NOT oMasters.hasByName("com.sun.star.text.FieldMaster.SetExpression." &amp; name) Then oMasterField =
        oDoc.createInstance("com.sun.star.text.FieldMaster.SetExpression") oMasterField.Name = name
    </p>
    <p>
        oMasterField.SubType = com.sun.star.text.SetVariableType.SEQUENCE Else
    </p>
    <p>
        oMasterField = oMasters.getByName("com.sun.star.text.FieldMaster.SetExpression." &amp; name)
    </p>
    <p>
        End If
    </p>
    <p>
        'Search for a line beginning with the name, a space, a number, a period, and a space. oDescriptor =
        oDoc.createSearchDescriptor()
    </p>
    <p>
        With oDescriptor
    </p>
    <p>
        .SearchString = "^" &amp; name &amp; " [:digit:]+\.[:space:]+"
    </p>
    <p>
        .SearchRegularExpression = True End With
    </p>
    <p>
        'Prepare to issue a dispatch to clear formatting. oFrame = oDoc.CurrentController.Frame
    </p>
    <p>
        oDispatcher = createUnoService("com.sun.star.frame.DispatchHelper")
    </p>
    <p>
        'Begin the find process.
    </p>
    <p>
        oFound = oDoc.findFirst(oDescriptor) Do While Not IsNull(oFound)
    </p>
    <p>
        ' Use the strong emphasis character style for "Listing 7." oFound.CharStyleName = "OOoStrongEmphasis"
    </p>
    <p>
        ' Create and configure the sequence field.
    </p>
    <p>
        oField = oDoc.createInstance("com.sun.star.text.TextField.SetExpression") oField.NumberingType =
        com.sun.star.style.NumberingType.ARABIC oField.NumberFormat = formatNum
        oField.attachTextFieldMaster(oMasterField)
    </p>
    <p>
        oField.Content = name &amp; " + 1"
    </p>
    <p>
        ' Create a text cursor with the found text.
    </p>
    <p>
        oCurs = oFound.getText().createTextCursorByRange(oFound)
    </p>
    <p>
        ' Insert the text such as "Listing &lt;sequence variable&gt;. " ' This inserted text replaces the found text.
        oFound.getText().insertString(oCurs, name &amp; " ", True) oCurs.collapseToEnd()
        oFound.getText().insertTextContent(oCurs, oField, True) oCurs.collapseToEnd()
        oFound.getText().insertString(oCurs, ".", True) oCurs.collapseToEnd() oFound.getText().insertString(oCurs, " ",
        True) oCurs.collapseToEnd()
    </p>
    <p>
        ' The inserted text uses strong emphasis.
    </p>
    <p>
        ' Move the cursor back one so that it is before the space.
    </p>
    <p>
        ' Jump to the end of the paragraph and reset the attributes. oCurs.goLeft(1, False)
    </p>
    <p>
        oCurs.gotoEndofParagraph(True) oDoc.CurrentController.Select(oCurs)
    </p>
    <p>
        oDispatcher.executeDispatch(oFrame, ".uno:ResetAttributes", "", 0, Array())
    </p>
    <p>
        ' Find the next occurrence.
    </p>
    <p>
        oFound = oDoc.findNext(oFound.End, oDescriptor) i = i + 1
    </p>
    <p>
        Loop FindReplaceTextFields = i
    </p>
    <p>
        End Function
    </p>
    <p>
        The above method contains extra code that clears formatting after the main sequence variables.
    </p>
</blockquote>
<h1 id="create-a-getreference-field">
    Create a GetReference field
</h1>
<blockquote>
    <p>
        An inserted sequence field is directly associated to a field master, which may be referenced by many different
        fields; every listing in this book references a single field master. A GetReference field, however, does not
        reference a field as easily. When a field is inserted, OOo automatically assigns a sequence value. The
        GetReference field has a SequenceNumber attribute that takes the numeric SequenceValue from the referenced field
        (see Listing 395).
    </p>
    <p>
        The reference field source indicates the type of field that is referenced. The supported types are shown in
        Table 155. Much of this is poorly documented, and I speculate that the sequence value may be unique relative to
        field source.
    </p>
    <p>
        The ReferenceFieldPart indicates how the reference is displayed. Valid values are shown in Table 154. The
        example in Listing 395 uses the category and the number. In a caption, all text before the number is the
        category.
    </p>
    <p>
        <em><strong>Listing 395.</strong> Inserting a GetReference field.</em>
    </p>
    <p>
        oField = oDoc.createInstance("com.sun.star.text.textfield.GetReference") oField.ReferenceFieldPart =
        com.sun.star.text.ReferenceFieldPart.CATEGORY_AND_NUMBER oField.ReferenceFieldSource =
        com.sun.star.text.ReferenceFieldSource.SEQUENCE_FIELD oField.SequenceNumber = oReferencedField.SequenceValue
    </p>
    <p>
        oField.SourceName = sSeqName oText.insertTextContent(oCurs, oField, True)
    </p>
    <p>
        <em><strong>Table 154.</strong> Constants for com.sun.star.text.ReferenceFieldPart.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 11%" />
        <col style="width: 30%" />
        <col style="width: 57%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Value</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Constant</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                0
            </td>
            <td>
                <blockquote>
                    <p>
                        PAGE
                    </p>
                </blockquote>
            </td>
            <td>
                The page number is displayed using Arabic numbers.
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        CHAPTER
                    </p>
                </blockquote>
            </td>
            <td>
                The chapter number is displayed.
            </td>
        </tr>
        <tr class="odd">
            <td>
                2
            </td>
            <td>
                <blockquote>
                    <p>
                        TEXT
                    </p>
                </blockquote>
            </td>
            <td>
                The reference text is displayed.
            </td>
        </tr>
        <tr class="even">
            <td>
                3
            </td>
            <td>
                <blockquote>
                    <p>
                        UP_DOWN
                    </p>
                </blockquote>
            </td>
            <td>
                Use localized words for "above" or "below".
            </td>
        </tr>
        <tr class="odd">
            <td>
                4
            </td>
            <td>
                <blockquote>
                    <p>
                        PAGE_DESC
                    </p>
                </blockquote>
            </td>
            <td>
                The page number is displayed using the numbering type defined in the page style of the reference
                position.
            </td>
        </tr>
        <tr class="even">
            <td>
                5
            </td>
            <td>
                <blockquote>
                    <p>
                        CATEGORY_AND_NUMBER
                    </p>
                </blockquote>
            </td>
            <td>
                The category and the number of a caption is displayed; for example, Listing 7.
            </td>
        </tr>
        <tr class="odd">
            <td>
                6
            </td>
            <td>
                <blockquote>
                    <p>
                        ONLY_CAPTION
                    </p>
                </blockquote>
            </td>
            <td>
                The caption text of a caption is displayed.
            </td>
        </tr>
        <tr class="even">
            <td>
                7
            </td>
            <td>
                <blockquote>
                    <p>
                        ONLY_SEQUENCE_NUMBER
                    </p>
                </blockquote>
            </td>
            <td>
                The number of a sequence field is displayed.
            </td>
        </tr>
        <tr class="odd">
            <td>
                8
            </td>
            <td>
                <blockquote>
                    <p>
                        NUMBER
                    </p>
                </blockquote>
            </td>
            <td>
                The numbering label and depending of the reference field context numbering labels of superior list
                levels of the reference are displayed.
            </td>
        </tr>
        <tr class="even">
            <td>
                9
            </td>
            <td>
                <blockquote>
                    <p>
                        NUMBER_NO_CONTEXT
                    </p>
                </blockquote>
            </td>
            <td>
                The numbering label of the reference is displayed.
            </td>
        </tr>
        <tr class="odd">
            <td>
                10
            </td>
            <td>
                <blockquote>
                    <p>
                        NUMBER_FULL_CONTEXT
                    </p>
                </blockquote>
            </td>
            <td>
                The numbering label and numbering labels of superior list levels of the reference are displayed.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        <em><strong>Table 155.</strong> Constants for com.sun.star.text.ReferenceFieldSource.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 15%" />
        <col style="width: 33%" />
        <col style="width: 51%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Value</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Constant</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                0
            </td>
            <td>
                REFERENCE_MARK
            </td>
            <td>
                The source is a reference mark.
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                SEQUENCE_FIELD
            </td>
            <td>
                The source is a number sequence field.
            </td>
        </tr>
        <tr class="odd">
            <td>
                2
            </td>
            <td>
                BOOKMARK
            </td>
            <td>
                The source is a bookmark.
            </td>
        </tr>
        <tr class="even">
            <td>
                3
            </td>
            <td>
                FOOTNOTE
            </td>
            <td>
                The source is a footnote.
            </td>
        </tr>
        <tr class="odd">
            <td>
                4
            </td>
            <td>
                ENDNOTE
            </td>
            <td>
                The source is an endnote.
            </td>
        </tr>
    </tbody>
</table>
<h1 id="replace-text-with-a-getreference-field">
    Replace text with a GetReference field
</h1>
<blockquote>
    <p>
        Listing 396 accepts an array of strings and a string to find in the array. The function returns the index of the
        string in the array. The need for this macro is explained below.
    </p>
    <p>
        <em><strong>Listing 396.</strong> Find a string in an array.</em>
    </p>
    <p>
        Function FindStringInArray(oData, s) As Integer Dim i As Integer
    </p>
    <p>
        FindStringInArray = -1
    </p>
    <p>
        For i = LBound(oData) To UBound(oData) If oData(i) = s Then
    </p>
    <p>
        FindStringInArray = i Exit Function
    </p>
    <p>
        End If Next
    </p>
    <p>
        End Function
    </p>
    <p>
        The inner workings of the main macro are described in the comments of the macro itself (see Listing 397).
    </p>
    <p>
        <em><strong>Listing 397.</strong> Replace text with a GetReference field.</em>
    </p>
    <p>
        Function referenceSequenceVariables(oDoc, sSeqName) As Integer Dim oEnum ' Enumeration of text sections.
    </p>
    <p>
        Dim oField ' Enumerated text field.
    </p>
    <p>
        Dim s$ ' Generic string variable.
    </p>
    <p>
        Dim oFrame ' Documents main frame, used for dispatches. Dim oDispatcher ' Dispatcher object.
    </p>
    <p>
        Dim oFields() ' Set expressions that may be referenced.
    </p>
    <p>
        Dim sPresentations() ' Text of what is displayed; for example, "Listing 7"
    </p>
    <p>
        Dim i As Integer ' Location of a reference (such as "Listing 7") in sPresentations. Dim n As Integer ' Count the
        fields.
    </p>
    <p>
        Dim oCurs ' Cursor used to clear formatting. Dim oDescriptor ' The search descriptor.
    </p>
    <p>
        Dim oFound ' The found range.
    </p>
    <p>
        ' Default to no references created. referenceSequenceVariables = 0
    </p>
    <p>
        ' Setup to perform a dispatch. oFrame = oDoc.CurrentController.Frame
    </p>
    <p>
        oDispatcher = createUnoService("com.sun.star.frame.DispatchHelper")
    </p>
    <p>
        ' Enumerate the text fields and identify the appropriate set field expressions. ' The field presentation is the
        number as it is displayed.
    </p>
    <p>
        ' When this section is finished:
    </p>
    <p>
        ' oFields() - All the set expression fields for the specified name.
    </p>
    <p>
        ' sPresentations() - Contains the full reference such as "Listing 7" for the listing ' sequence with the value
        7.
    </p>
    <p>
        oEnum = oDoc.getTextFields().createEnumeration() If Not IsNull(oEnum) Then
    </p>
    <p>
        Do While oEnum.hasMoreElements() oField = oEnum.nextElement()
    </p>
    <p>
        If oField.supportsService("com.sun.star.text.TextField.SetExpression") Then If oField.VariableName = sSeqName
        Then
    </p>
    <p>
        ReDim Preserve oFields(0 To n)
    </p>
    <p>
        ReDim Preserve sPresentations(0 To n) oFields(n) = oField
    </p>
    <p>
        sPresentations(n) = sSeqName &amp; " " &amp; oField.CurrentPresentation n = n + 1
    </p>
    <p>
        End If End If
    </p>
    <p>
        Loop End If
    </p>
    <p>
        ' Create the search descriptor to find all instances of things such as "Listing 23". ' Values in fields are not
        found, because search does NOT search fields.
    </p>
    <p>
        oDescriptor = oDoc.createSearchDescriptor() With oDescriptor
    </p>
    <p>
        .SearchString = sSeqName &amp; " [:digit:]+"
    </p>
    <p>
        .SearchRegularExpression = True End With
    </p>
    <p>
        n = 0
    </p>
    <p>
        oFound = oDoc.findFirst(oDescriptor) Do While Not IsNull(oFound)
    </p>
    <p>
        ' Look for a field with the text such as "Listing 7"
    </p>
    <p>
        i = FindStringInArray(sPresentations, oFound.getString())
    </p>
    <p>
        If i &gt;= 0 Then
    </p>
    <p>
        ' Create and configure the GetReference field
    </p>
    <p>
        oField = oDoc.createInstance("com.sun.star.text.textfield.GetReference") oField.ReferenceFieldPart =
        com.sun.star.text.ReferenceFieldPart.CATEGORY_AND_NUMBER oField.ReferenceFieldSource =
        com.sun.star.text.ReferenceFieldSource.SEQUENCE_FIELD oField.SequenceNumber = oFields(i).SequenceValue
    </p>
    <p>
        oField.SourceName = sSeqName
    </p>
    <p>
        ' Create a text cursor where the text was found.
    </p>
    <p>
        ' Clear the text, then insert the GetReference field at that location. oCurs =
        oFound.getText().createTextCursorByRange(oFound) oCurs.setString("")
    </p>
    <p>
        oFound.getText().insertTextContent(oCurs, oField, True)
    </p>
    <p>
        ' Sometimes, special formatting was used for the reference text.
    </p>
    <p>
        ' A cursor cannot move into a field, so collapsing the cursor then selecting ' one character to the left will
        select the GetReference field. oCurs.collapseToEnd()
    </p>
    <p>
        oCurs.goLeft(1, True)
    </p>
    <p>
        ' Select the GetReference field on the display, then use a ' dispatch to clear all attributes.
        oDoc.CurrentController.select(oCurs)
    </p>
    <p>
        oDispatcher.executeDispatch(oFrame, ".uno:ResetAttributes", "", 0, Array()) n = n + 1
    </p>
    <p>
        Else
    </p>
    <p>
        s = s &amp; "Failed to find (" &amp; oFound.getString() &amp; ")" &amp; CHR$(10)
    </p>
    <p>
        End If
    </p>
    <p>
        oFound = oDoc.findNext(oFound.End, oDescriptor)
    </p>
    <p>
        Loop referenceSequenceVariables = n If s &lt;&gt; "" Then
    </p>
    <p>
        Msgbox s End If
    </p>
    <p>
        End Function
    </p>
</blockquote>
<h1 id="the-worker-that-ties-it-all-together">
    The worker that ties it all together
</h1>
<blockquote>
    <p>
        The main worker macro starts by replacing captions for Figure, Listing, and Table with sequence variables. It is
        assumed, but never verified, that the captions are sequentially numbered as they appear in the document
    </p>
    <p>
        with no gaps in numbering. In other words, the routines are a bit fragile, but they worked great for the
        documents that I desired to use.
    </p>
    <p>
        My first test set about 100 captions. All cross-references failed because the fields had not yet updated. After
        creating all sequence fields, a dispatch causes the fields to update so that the next phase can begin. Note that
        if this is not done, then the CurrentPresentation attribute on the sequence fields will be incorrect.
    </p>
    <p>
        <em><strong>Listing 398.</strong> Set captions and references for a document.</em>
    </p>
    <p>
        sub replaceCaptions()
    </p>
    <p>
        Dim oDoc ' Document on which to operate.
    </p>
    <p>
        Dim oFrame ' Documents main frame, used for dispatches. Dim oDispatcher ' Dispatcher object.
    </p>
    <p>
        Dim i As Integer ' General index variable. Dim n As Integer ' Number of fields created. Dim s$ ' Summary of work
        performed.
    </p>
    <p>
        Dim fields() ' Field names on which to operate.
    </p>
    <p>
        fields = Array("Listing", "Table", "Figure") oDoc = ThisComponent
    </p>
    <p>
        oFrame = oDoc.CurrentController.Frame
    </p>
    <p>
        oDispatcher = createUnoService("com.sun.star.frame.DispatchHelper")
    </p>
    <p>
        For i = LBound(fields()) To UBound(fields())
    </p>
    <p>
        n = FindReplaceTextFields(ThisComponent, fields(i))
    </p>
    <p>
        s = s &amp; "Fixed " &amp; n &amp; " captions for " &amp; fields(i) &amp; CHR$(10)
    </p>
    <p>
        Next
    </p>
    <p>
        ' This next part will NOT work until after all of the fields have updated. ' So, force an update.
    </p>
    <p>
        oDispatcher.executeDispatch(oFrame, ".uno:UpdateFields", "", 0, Array())
    </p>
    <p>
        For i = LBound(fields()) To UBound(fields())
    </p>
    <p>
        n = referenceSequenceVariables(ThisComponent, fields(i))
    </p>
    <p>
        s = s &amp; "set " &amp; n &amp; " references to " &amp; fields(i) &amp; CHR$(10) Next
    </p>
    <p>
        MsgBox s End Sub
    </p>
</blockquote>
<h2 id="table-of-contents">
    <em>Table of contents</em>
</h2>
<blockquote>
    <p>
        Finding and inserting a table of contents (TOC) is easy unless you want to change the defaults. The following
        macro checks ThisComponent to see if the document contains a content index.
    </p>
    <p>
        REM Find TOC if it exists.
    </p>
    <p>
        oIndexes = ThisComponent.getDocumentIndexes() bIndexFound = False
    </p>
    <p>
        For i = 0 To oIndexes.getCount() - 1 oIndex = oIndexes.getByIndex(i)
    </p>
    <p>
        If oIndex.supportsService("com.sun.star.text.ContentIndex") Then bIndexFound = True
    </p>
    <p>
        Exit For End If
    </p>
    <p>
        Next
    </p>
    <p>
        Use dispose to remove an existing index from the document.
    </p>
    <p>
        When I create a TOC, I usually set CreateFromOutline to true to create the index based on the document outline
        styles (see Listing 399).
    </p>
    <p>
        <em><strong>Listing 399.</strong> Insert a standard TOC into a document.</em>
    </p>
    <p>
        Sub InsertATOC
    </p>
    <p>
        REM Author: Andrew Pitonyak
    </p>
    <p>
        Dim oCurs 'Used to insert the text content. Dim oIndexes 'All of the existing indexes
    </p>
    <p>
        Dim oIndex 'TOC if it exists and a new one if not Dim i% 'Find an existing TOC
    </p>
    <p>
        Dim bIndexFound As Boolean 'Flag to track if the TOC was found
    </p>
    <p>
        REM Find TOC if it exists.
    </p>
    <p>
        oIndexes = ThisComponent.getDocumentIndexes() bIndexFound = False
    </p>
    <p>
        For i = 0 To oIndexes.getCount() - 1 oIndex = oIndexes.getByIndex(i)
    </p>
    <p>
        If oIndex.supportsService("com.sun.star.text.ContentIndex") Then bIndexFound = True
    </p>
    <p>
        Exit For End If
    </p>
    <p>
        Next
    </p>
    <p>
        If Not bIndexFound Then
    </p>
    <p>
        Print "I did not find an existing content index" REM Create and insert a new TOC.
    </p>
    <p>
        REM The new TOC must be created by the document that will contain the TOC. oIndex =
        ThisComponent.createInstance("com.sun.star.text.ContentIndex")
    </p>
    <p>
        oIndex.CreateFromOutline = True
    </p>
    <p>
        oCurs = ThisComponent.getText().createTextCursor() oCurs.gotoStart(False)
        ThisComponent.getText().insertTextContent(oCurs, oIndex, False)
    </p>
    <p>
        End If
    </p>
    <p>
        REM Even the newly inserted index is not updated until right HERE! oIndex.update()
    </p>
    <p>
        End Sub
    </p>
    <p>
        The same code can be used to create a DocumentIndex, ContentIndex, UserDefinedIndex, IllustrationIndex,
        TableIndex, or ObjectIndex. Properties common to all index types are shown in Table 156.
    </p>
    <p>
        <em><strong>Table 156.</strong> Common index properties.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 29%" />
        <col style="width: 70%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                BackColor
            </td>
            <td>
                Background color. Set to -1 for none.
            </td>
        </tr>
        <tr class="even">
            <td>
                BackGraphicFilter
            </td>
            <td>
                Filter for the graphic displayed as background graphic.
            </td>
        </tr>
        <tr class="odd">
            <td>
                BackGraphicLocation
            </td>
            <td>
                Location of the back graphic. Set using the com.sun.star.style.GraphicLocation constants. This includes
                NONE, LEFT_TOP, MIDDLE_TOP, RIGHT_TOP, LEFT_MIDDLE, MIDDLE_MIDDLE, RIGHT_MIDDLE, LEFT_BOTTOM,
                MIDDLE_BOTTOM, RIGHT_BOTTOM, AREA, and TILED
            </td>
        </tr>
        <tr class="even">
            <td>
                BackGraphicURL
            </td>
            <td>
                URL to the graphic displayed as a background graphic. I did not experiment with this, it may require an
                internal URL??
            </td>
        </tr>
        <tr class="odd">
            <td>
                CreateFromChapter
            </td>
            <td>
                Set to True to create an index based on the current chapter rather than the entire document.
            </td>
        </tr>
        <tr class="even">
            <td>
                IsProtected
            </td>
            <td>
                If true, the index is protected and cannot be edited as part of the text.
            </td>
        </tr>
        <tr class="odd">
            <td>
                ParaStyleHeading
            </td>
            <td>
                Paragraph style name used for the heading.
            </td>
        </tr>
        <tr class="even">
            <td>
                ParaStyleLevel1
            </td>
            <td>
                Paragraph style named used for level 1. Note that there is an attribute for levels 1 through 10.
            </td>
        </tr>
        <tr class="odd">
            <td>
                Title
            </td>
            <td>
                Index title that is inserted as part of the TOC. I usually leave this blank and place the title before
                the TOC using the “Heading 1” paragraph style so that it is included as part of the TOC; silly, I know.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        A TOC contains columns of data; for example, section numbering, section title, and page number. Each column is
        represented by an array of named properties. The supported properties are shown Table 157.
    </p>
    <p>
        <em><strong>Table 157.</strong> Supported column tokens.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 24%" />
        <col style="width: 75%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Token</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Description</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                TokenType
            </td>
            <td>
                Identifies the contents of the column. Every column has a token type as the first property. TokenType
                property values are strings shown in Table 158.
            </td>
        </tr>
        <tr class="even">
            <td>
                CharacterStyleName
            </td>
            <td>
                Name of the character style applied to the element. Do not include for tab stops. An empty value causes
                the Default style to be used.
            </td>
        </tr>
        <tr class="odd">
            <td>
                TabStopRightAligned
            </td>
            <td>
                Tab stop is right aligned. Only valid for tab stops.
            </td>
        </tr>
        <tr class="even">
            <td>
                TabStopPosition
            </td>
            <td>
                Position of the tab stop. Only valid for tab stops.
            </td>
        </tr>
        <tr class="odd">
            <td>
                TabStopFillCharacter
            </td>
            <td>
                Fill character in tab stops. Only valid for tab stops.
            </td>
        </tr>
        <tr class="even">
            <td>
                WithTab
            </td>
            <td>
                If true insert tab character.
            </td>
        </tr>
        <tr class="odd">
            <td>
                Text
            </td>
            <td>
                Only valid in user defined text.
            </td>
        </tr>
        <tr class="even">
            <td>
                ChapterFormat
            </td>
            <td>
                <p>
                    Valid in chapter info and entry number only. The chapter format is also mentioned in Table
                </p>
                <p>
                    148. For chapter info NUMBER and NAME_NUMBER are allowed and for an entry NUMBER and DIGIT are
                    allowed.
                </p>
            </td>
        </tr>
        <tr class="odd">
            <td>
                ChapterLevel
            </td>
            <td>
                Valid in chapter info and entry number only. Denotes the level up to which the chapter information is
                given. Values permitted 1 to 10 inclusive.
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        Some token types are not supported by all index types. The Value is the string name used to identify the token
        type. The Entry column contains the text used in the GUI while specifying the columns. If an entry is empty, it
        is because I did not verify every type to see what values are used and I do not know the value.
    </p>
    <p>
        <em><strong>Table 158.</strong> Supported TokenType values.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 29%" />
        <col style="width: 12%" />
        <col style="width: 25%" />
        <col style="width: 32%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Value</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Entry</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Comment</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Supported Index Types</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                TokenEntryNumber
            </td>
            <td>
                E#
            </td>
            <td>
                Chapter number
            </td>
            <td>
                Content
            </td>
        </tr>
        <tr class="even">
            <td>
                TokenEntryText
            </td>
            <td>
                E
            </td>
            <td>
                Entry text
            </td>
            <td>
                All
            </td>
        </tr>
        <tr class="odd">
            <td>
                TokenTabStop
            </td>
            <td>
                T
            </td>
            <td>
                Tab stop
            </td>
            <td>
                All
            </td>
        </tr>
        <tr class="even">
            <td>
                TokenText
            </td>
            <td>
            </td>
            <td>
                User defined text
            </td>
            <td>
            </td>
        </tr>
        <tr class="odd">
            <td>
                TokenPageNumber
            </td>
            <td>
                #
            </td>
            <td>
                page number
            </td>
            <td>
                All
            </td>
        </tr>
        <tr class="even">
            <td>
                TokenChapterInfo
            </td>
            <td>
            </td>
            <td>
                Chapter information
            </td>
            <td>
                Illustration, Table, User, Table of Objects, and Alphabetical
            </td>
        </tr>
        <tr class="odd">
            <td>
                TokenHyperlinkStart
            </td>
            <td>
                LS
            </td>
            <td>
                Begin a hyperlink
            </td>
            <td>
            </td>
        </tr>
        <tr class="even">
            <td>
                TokenHyperlinkEnd
            </td>
            <td>
                LE
            </td>
            <td>
                End a hyperlink
            </td>
            <td>
            </td>
        </tr>
        <tr class="odd">
            <td>
                TokenBibliographyDataField
            </td>
            <td>
            </td>
            <td>
                Bibliographic data field
            </td>
            <td>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        The macro in Listing 400 inspects the level formatting for the TOC in the current document and then inserts text
        at the end of the current document.
    </p>
    <p>
        <em><strong>Listing 400.</strong> Inspect the TOC in the current document.</em>
    </p>
    <p>
        Sub InspectCurrentTOCColumns 'Inspect ThisComponent
    </p>
    <p>
        Dim oCurs 'Used to insert the text content. Dim oIndexes 'All of the existing indexes
    </p>
    <p>
        Dim oIndex 'TOC if it exists and a new one if not Dim i% 'Find an existing TOC
    </p>
    <p>
        Dim bIndexFound As Boolean 'Flag to track if the TOC was found
    </p>
    <p>
        Dim iLevel% ' Iterate over the levels in the LevelFormat property. Dim iCol% ' Iterate over the columns in each
        level.
    </p>
    <p>
        Dim iProp% ' Iterate over the properties for a single column. Dim oLevel ' Level object.
    </p>
    <p>
        Dim oCol ' Column object. Dim s$
    </p>
    <p>
        REM Find TOC if it exists.
    </p>
    <p>
        oIndexes = ThisComponent.getDocumentIndexes() bIndexFound = False
    </p>
    <p>
        For i = 0 To oIndexes.getCount() - 1 oIndex = oIndexes.getByIndex(i)
    </p>
    <p>
        If oIndex.supportsService("com.sun.star.text.ContentIndex") Then bIndexFound = True
    </p>
    <p>
        Exit For End If
    </p>
    <p>
        Next
    </p>
    <p>
        If Not bIndexFound Then Exit Sub
    </p>
    <p>
        End If
    </p>
    <p>
        s = "Level" &amp; CHR$(9) &amp; "Column" &amp; CHR$(9) &amp; "Property" &amp; CHR$(9) &amp; "Name" &amp; _
        CHR$(9) &amp; "Value" &amp; CHR$(13)
    </p>
    <p>
        For iLevel = 0 To oIndex.LevelFormat.getCount() - 1 oLevel = oIndex.LevelFormat.getByIndex(iLevel)
    </p>
    <p>
        For iCol = LBound(oLevel) To UBound(oLevel) oCol = oLevel(iCol)
    </p>
    <p>
        For iProp = LBound(oCol) To UBound(oCol)
    </p>
    <p>
        s = s &amp; iLevel &amp; CHR$(9) &amp; iCol &amp; CHR$(9) &amp; iProp &amp; CHR$(9) &amp; _ oCol(iProp).Name
        &amp; CHR$(9) &amp; oCol(iProp).Value &amp; CHR$(13)
    </p>
    <p>
        Next Next
    </p>
    <p>
        Next
    </p>
    <p>
        ThisComponent.getText().insertString(ThisComponent.getText().End, s, False) End Sub
    </p>
    <p>
        I ran the macro in Listing 400 with OOo version 3.3.0 and noticed that level 0 contains no entries, and levels 1
        – 10 are identical. The output for level 1 is shown in Table 159.
    </p>
</blockquote>
<ul>
    <li>
        <p>
            Column 0 is the TokenEntryNumber formatted with the Default character style. In the TOC, this is the chapter
            numbering.
        </p>
    </li>
    <li>
        <p>
            A hyperlink begins in column 1, and it is formatted using the “Internet Link” character style.
        </p>
    </li>
    <li>
        <p>
            Column 2 contains the heading text. No character style is provided, but it is formatted using the “Internet
            Link” style because it is included in the hyperlink.
        </p>
    </li>
    <li>
        <p>
            Column 3 specifies the end of the hyperlink, so the hyperlink includes only the heading text.
        </p>
    </li>
    <li>
        <p>
            Column 4 specifies a right aligned tab stop that fills the empty space between the heading text and the page
            number with periods.
        </p>
    </li>
    <li>
        <p>
            Column 5 contains the page number.
        </p>
    </li>
</ul>
<blockquote>
    <p>
        <em><strong>Table 159.</strong> Level format for level 1.</em>
    </p>
</blockquote>
<table border="1">
    <colgroup>
        <col style="width: 12%" />
        <col style="width: 15%" />
        <col style="width: 15%" />
        <col style="width: 24%" />
        <col style="width: 31%" />
    </colgroup>
    <thead>
        <tr class="header">
            <th>
                <blockquote>
                    <p>
                        <em><strong>Level</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Column</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Property</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Name</strong></em>
                    </p>
                </blockquote>
            </th>
            <th>
                <blockquote>
                    <p>
                        <em><strong>Value</strong></em>
                    </p>
                </blockquote>
            </th>
        </tr>
    </thead>
    <tbody>
        <tr class="odd">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        0
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        0
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenType
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenEntryNumber
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        0
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        1
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        CharacterStyleName
                    </p>
                </blockquote>
            </td>
            <td>
            </td>
        </tr>
        <tr class="odd">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        1
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        0
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenType
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenHyperlinkStart
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        1
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        1
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        CharacterStyleName
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        Internet link
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        2
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        0
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenType
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenEntryText
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        2
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        1
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        CharacterStyleName
                    </p>
                </blockquote>
            </td>
            <td>
            </td>
        </tr>
        <tr class="odd">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        3
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        0
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenType
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenHyperlinkEnd
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        4
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        0
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenType
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenTabStop
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        4
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        1
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TabStopRightAligned
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TRUE
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        4
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        2
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TabStopFillCharacter
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        .
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        4
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        3
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        CharacterStyleName
                    </p>
                </blockquote>
            </td>
            <td>
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        4
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        4
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        WithTab
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TRUE
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="odd">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        5
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        0
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenType
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        TokenPageNumber
                    </p>
                </blockquote>
            </td>
        </tr>
        <tr class="even">
            <td>
                1
            </td>
            <td>
                <blockquote>
                    <p>
                        5
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        1
                    </p>
                </blockquote>
            </td>
            <td>
                <blockquote>
                    <p>
                        CharacterStyleName
                    </p>
                </blockquote>
            </td>
            <td>
            </td>
        </tr>
    </tbody>
</table>
<blockquote>
    <p>
        While creating a TOC manually, the columns are edited to include things such as chapter numbers, chapter text,
        hyperlink start, hyperlink end, page number, and other things. These values are stored in the LevelFormat
        property.
    </p>
    <p>
        <em><strong>Listing 401.</strong> Insert a TOC with hyperlinks.</em>
    </p>
    <p>
        Sub InsertATOCWithHyperlinks REM Author: Andrew Pitonyak
    </p>
    <p>
        Dim oCurs 'Used to insert the text content. Dim oIndexes 'All of the existing indexes.
    </p>
    <p>
        Dim oIndex 'TOC if it exists and a new one if not. Dim i% 'Find an existing TOC.
    </p>
    <p>
        Dim bIndexFound As Boolean 'Flag to track if the TOC was found. Dim iLevel
    </p>
    <p>
        REM Find TOC if it exists.
    </p>
    <p>
        oIndexes = ThisComponent.getDocumentIndexes() bIndexFound = False
    </p>
    <p>
        For i = 0 To oIndexes.getCount() - 1 oIndex = oIndexes.getByIndex(i)
    </p>
    <p>
        If oIndex.supportsService("com.sun.star.text.ContentIndex") Then bIndexFound = True
    </p>
    <p>
        Exit For End If
    </p>
    <p>
        Next
    </p>
    <p>
        If Not bIndexFound Then
    </p>
    <p>
        REM Create and insert a new TOC.
    </p>
    <p>
        REM The new TOC must be created by the document that will contain the TOC. oIndex =
        ThisComponent.createInstance("com.sun.star.text.ContentIndex")
    </p>
    <p>
        oIndex.CreateFromOutline = True
    </p>
    <p>
        ' Ignore level 0
    </p>
    <p>
        For iLevel = 1 To oIndex.LevelFormat.getCount() - 1 oIndex.LevelFormat.replaceByIndex(iLevel,
        CreateTOCColumnEntries())
    </p>
    <p>
        Next
    </p>
    <p>
        oCurs = ThisComponent.getText().createTextCursor() oCurs.gotoRange(ThisComponent.CurrentController.ViewCursor,
        False) ThisComponent.getText().insertTextContent(oCurs, oIndex, False)
    </p>
    <p>
        End If
    </p>
    <p>
        REM Even the newly inserted index is not updated until right HERE! oIndex.update()
    </p>
    <p>
        End Sub
    </p>
    <p>
        Function CreateTOCColumnEntries()
    </p>
    <p>
        Dim o
    </p>
    <p>
        o = Array( Array(MakeProperty("TokenType", "TokenEntryNumber"), _ MakeProperty("CharacterStyleName", "")), _
    </p>
    <p>
        Array(MakeProperty("TokenType", "TokenHyperlinkStart"), _ MakeProperty("CharacterStyleName", "Internet link")),
        _
    </p>
    <p>
        Array(MakeProperty("TokenType", "TokenEntryText"), _ MakeProperty("CharacterStyleName", "")), _
    </p>
    <p>
        Array(MakeProperty("TokenType", "TokenHyperlinkEnd")), _
    </p>
    <p>
        Array(MakeProperty("TokenType", "TokenTabStop"), _ MakeProperty("TabStopRightAligned", TRUE), _
        MakeProperty("TabStopFillCharacter", "."), _ MakeProperty("CharacterStyleName", ""), _ MakeProperty("WithTab",
        TRUE)), _
    </p>
    <p>
        Array(MakeProperty("TokenType", "TokenPageNumber"), _ MakeProperty("CharacterStyleName", "")))
    </p>
    <p>
        CreateTOCColumnEntries() = o End Function
    </p>
    <p>
        Function MakeProperty(sName$, value)
    </p>
    <p>
        Dim oProp
    </p>
    <p>
        oProp = CreateObject("com.sun.star.beans.PropertyValue") oProp.Name = sName
    </p>
    <p>
        oProp.Value = value MakeProperty = oProp
    </p>
    <p>
        End Function
    </p>
</blockquote>
<h2 id="conclusion">
    <em>Conclusion</em>
</h2>
<blockquote>
    <p>
        Although this chapter didn’t cover every object and capability supported by Writer, it did discuss the
        capabilities most frequently questioned on the mailing lists. Many of the techniques demonstrated in this
        chapter are representative of the techniques that are required for objects not discussed. For example, all
        objects supporting named access are retrieved in the same manner. Use the material covered here as a starting
        point in your exploration of Writer documents in OpenOffice.org.
    </p>
</blockquote>